(function(){const u=document.createElement("link").relList;if(u&&u.supports&&u.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))f(d);new MutationObserver(d=>{for(const p of d)if(p.type==="childList")for(const m of p.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&f(m)}).observe(document,{childList:!0,subtree:!0});function i(d){const p={};return d.integrity&&(p.integrity=d.integrity),d.referrerPolicy&&(p.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?p.credentials="include":d.crossOrigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function f(d){if(d.ep)return;d.ep=!0;const p=i(d);fetch(d.href,p)}})();function qf(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var zi={exports:{}},pl={},Ii={exports:{}},Ce={};var Pc;function Zf(){if(Pc)return Ce;Pc=1;var a=Symbol.for("react.element"),u=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),f=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),p=Symbol.for("react.provider"),m=Symbol.for("react.context"),y=Symbol.for("react.forward_ref"),v=Symbol.for("react.suspense"),S=Symbol.for("react.memo"),k=Symbol.for("react.lazy"),P=Symbol.iterator;function R(h){return h===null||typeof h!="object"?null:(h=P&&h[P]||h["@@iterator"],typeof h=="function"?h:null)}var $={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},B=Object.assign,z={};function U(h,E,Y){this.props=h,this.context=E,this.refs=z,this.updater=Y||$}U.prototype.isReactComponent={},U.prototype.setState=function(h,E){if(typeof h!="object"&&typeof h!="function"&&h!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,h,E,"setState")},U.prototype.forceUpdate=function(h){this.updater.enqueueForceUpdate(this,h,"forceUpdate")};function V(){}V.prototype=U.prototype;function W(h,E,Y){this.props=h,this.context=E,this.refs=z,this.updater=Y||$}var le=W.prototype=new V;le.constructor=W,B(le,U.prototype),le.isPureReactComponent=!0;var O=Array.isArray,w=Object.prototype.hasOwnProperty,J={current:null},D={key:!0,ref:!0,__self:!0,__source:!0};function ee(h,E,Y){var te,ie={},me=null,ge=null;if(E!=null)for(te in E.ref!==void 0&&(ge=E.ref),E.key!==void 0&&(me=""+E.key),E)w.call(E,te)&&!D.hasOwnProperty(te)&&(ie[te]=E[te]);var ve=arguments.length-2;if(ve===1)ie.children=Y;else if(1<ve){for(var q=Array(ve),pe=0;pe<ve;pe++)q[pe]=arguments[pe+2];ie.children=q}if(h&&h.defaultProps)for(te in ve=h.defaultProps,ve)ie[te]===void 0&&(ie[te]=ve[te]);return{$$typeof:a,type:h,key:me,ref:ge,props:ie,_owner:J.current}}function Q(h,E){return{$$typeof:a,type:h.type,key:E,ref:h.ref,props:h.props,_owner:h._owner}}function M(h){return typeof h=="object"&&h!==null&&h.$$typeof===a}function oe(h){var E={"=":"=0",":":"=2"};return"$"+h.replace(/[=:]/g,function(Y){return E[Y]})}var L=/\/+/g;function ae(h,E){return typeof h=="object"&&h!==null&&h.key!=null?oe(""+h.key):E.toString(36)}function I(h,E,Y,te,ie){var me=typeof h;(me==="undefined"||me==="boolean")&&(h=null);var ge=!1;if(h===null)ge=!0;else switch(me){case"string":case"number":ge=!0;break;case"object":switch(h.$$typeof){case a:case u:ge=!0}}if(ge)return ge=h,ie=ie(ge),h=te===""?"."+ae(ge,0):te,O(ie)?(Y="",h!=null&&(Y=h.replace(L,"$&/")+"/"),I(ie,E,Y,"",function(pe){return pe})):ie!=null&&(M(ie)&&(ie=Q(ie,Y+(!ie.key||ge&&ge.key===ie.key?"":(""+ie.key).replace(L,"$&/")+"/")+h)),E.push(ie)),1;if(ge=0,te=te===""?".":te+":",O(h))for(var ve=0;ve<h.length;ve++){me=h[ve];var q=te+ae(me,ve);ge+=I(me,E,Y,q,ie)}else if(q=R(h),typeof q=="function")for(h=q.call(h),ve=0;!(me=h.next()).done;)me=me.value,q=te+ae(me,ve++),ge+=I(me,E,Y,q,ie);else if(me==="object")throw E=String(h),Error("Objects are not valid as a React child (found: "+(E==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":E)+"). If you meant to render a collection of children, use an array instead.");return ge}function X(h,E,Y){if(h==null)return h;var te=[],ie=0;return I(h,te,"","",function(me){return E.call(Y,me,ie++)}),te}function re(h){if(h._status===-1){var E=h._result;E=E(),E.then(function(Y){(h._status===0||h._status===-1)&&(h._status=1,h._result=Y)},function(Y){(h._status===0||h._status===-1)&&(h._status=2,h._result=Y)}),h._status===-1&&(h._status=0,h._result=E)}if(h._status===1)return h._result.default;throw h._result}var H={current:null},C={transition:null},A={ReactCurrentDispatcher:H,ReactCurrentBatchConfig:C,ReactCurrentOwner:J};function j(){throw Error("act(...) is not supported in production builds of React.")}return Ce.Children={map:X,forEach:function(h,E,Y){X(h,function(){E.apply(this,arguments)},Y)},count:function(h){var E=0;return X(h,function(){E++}),E},toArray:function(h){return X(h,function(E){return E})||[]},only:function(h){if(!M(h))throw Error("React.Children.only expected to receive a single React element child.");return h}},Ce.Component=U,Ce.Fragment=i,Ce.Profiler=d,Ce.PureComponent=W,Ce.StrictMode=f,Ce.Suspense=v,Ce.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=A,Ce.act=j,Ce.cloneElement=function(h,E,Y){if(h==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+h+".");var te=B({},h.props),ie=h.key,me=h.ref,ge=h._owner;if(E!=null){if(E.ref!==void 0&&(me=E.ref,ge=J.current),E.key!==void 0&&(ie=""+E.key),h.type&&h.type.defaultProps)var ve=h.type.defaultProps;for(q in E)w.call(E,q)&&!D.hasOwnProperty(q)&&(te[q]=E[q]===void 0&&ve!==void 0?ve[q]:E[q])}var q=arguments.length-2;if(q===1)te.children=Y;else if(1<q){ve=Array(q);for(var pe=0;pe<q;pe++)ve[pe]=arguments[pe+2];te.children=ve}return{$$typeof:a,type:h.type,key:ie,ref:me,props:te,_owner:ge}},Ce.createContext=function(h){return h={$$typeof:m,_currentValue:h,_currentValue2:h,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},h.Provider={$$typeof:p,_context:h},h.Consumer=h},Ce.createElement=ee,Ce.createFactory=function(h){var E=ee.bind(null,h);return E.type=h,E},Ce.createRef=function(){return{current:null}},Ce.forwardRef=function(h){return{$$typeof:y,render:h}},Ce.isValidElement=M,Ce.lazy=function(h){return{$$typeof:k,_payload:{_status:-1,_result:h},_init:re}},Ce.memo=function(h,E){return{$$typeof:S,type:h,compare:E===void 0?null:E}},Ce.startTransition=function(h){var E=C.transition;C.transition={};try{h()}finally{C.transition=E}},Ce.unstable_act=j,Ce.useCallback=function(h,E){return H.current.useCallback(h,E)},Ce.useContext=function(h){return H.current.useContext(h)},Ce.useDebugValue=function(){},Ce.useDeferredValue=function(h){return H.current.useDeferredValue(h)},Ce.useEffect=function(h,E){return H.current.useEffect(h,E)},Ce.useId=function(){return H.current.useId()},Ce.useImperativeHandle=function(h,E,Y){return H.current.useImperativeHandle(h,E,Y)},Ce.useInsertionEffect=function(h,E){return H.current.useInsertionEffect(h,E)},Ce.useLayoutEffect=function(h,E){return H.current.useLayoutEffect(h,E)},Ce.useMemo=function(h,E){return H.current.useMemo(h,E)},Ce.useReducer=function(h,E,Y){return H.current.useReducer(h,E,Y)},Ce.useRef=function(h){return H.current.useRef(h)},Ce.useState=function(h){return H.current.useState(h)},Ce.useSyncExternalStore=function(h,E,Y){return H.current.useSyncExternalStore(h,E,Y)},Ce.useTransition=function(){return H.current.useTransition()},Ce.version="18.3.1",Ce}var _c;function Zi(){return _c||(_c=1,Ii.exports=Zf()),Ii.exports}var Dc;function ep(){if(Dc)return pl;Dc=1;var a=Zi(),u=Symbol.for("react.element"),i=Symbol.for("react.fragment"),f=Object.prototype.hasOwnProperty,d=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};function m(y,v,S){var k,P={},R=null,$=null;S!==void 0&&(R=""+S),v.key!==void 0&&(R=""+v.key),v.ref!==void 0&&($=v.ref);for(k in v)f.call(v,k)&&!p.hasOwnProperty(k)&&(P[k]=v[k]);if(y&&y.defaultProps)for(k in v=y.defaultProps,v)P[k]===void 0&&(P[k]=v[k]);return{$$typeof:u,type:y,key:R,ref:$,props:P,_owner:d.current}}return pl.Fragment=i,pl.jsx=m,pl.jsxs=m,pl}var Oc;function tp(){return Oc||(Oc=1,zi.exports=ep()),zi.exports}var o=tp(),b=Zi();const zs=qf(b);var Ts={},Mi={exports:{}},ht={},Fi={exports:{}},$i={};var Rc;function np(){return Rc||(Rc=1,(function(a){function u(C,A){var j=C.length;C.push(A);e:for(;0<j;){var h=j-1>>>1,E=C[h];if(0<d(E,A))C[h]=A,C[j]=E,j=h;else break e}}function i(C){return C.length===0?null:C[0]}function f(C){if(C.length===0)return null;var A=C[0],j=C.pop();if(j!==A){C[0]=j;e:for(var h=0,E=C.length,Y=E>>>1;h<Y;){var te=2*(h+1)-1,ie=C[te],me=te+1,ge=C[me];if(0>d(ie,j))me<E&&0>d(ge,ie)?(C[h]=ge,C[me]=j,h=me):(C[h]=ie,C[te]=j,h=te);else if(me<E&&0>d(ge,j))C[h]=ge,C[me]=j,h=me;else break e}}return A}function d(C,A){var j=C.sortIndex-A.sortIndex;return j!==0?j:C.id-A.id}if(typeof performance=="object"&&typeof performance.now=="function"){var p=performance;a.unstable_now=function(){return p.now()}}else{var m=Date,y=m.now();a.unstable_now=function(){return m.now()-y}}var v=[],S=[],k=1,P=null,R=3,$=!1,B=!1,z=!1,U=typeof setTimeout=="function"?setTimeout:null,V=typeof clearTimeout=="function"?clearTimeout:null,W=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function le(C){for(var A=i(S);A!==null;){if(A.callback===null)f(S);else if(A.startTime<=C)f(S),A.sortIndex=A.expirationTime,u(v,A);else break;A=i(S)}}function O(C){if(z=!1,le(C),!B)if(i(v)!==null)B=!0,re(w);else{var A=i(S);A!==null&&H(O,A.startTime-C)}}function w(C,A){B=!1,z&&(z=!1,V(ee),ee=-1),$=!0;var j=R;try{for(le(A),P=i(v);P!==null&&(!(P.expirationTime>A)||C&&!oe());){var h=P.callback;if(typeof h=="function"){P.callback=null,R=P.priorityLevel;var E=h(P.expirationTime<=A);A=a.unstable_now(),typeof E=="function"?P.callback=E:P===i(v)&&f(v),le(A)}else f(v);P=i(v)}if(P!==null)var Y=!0;else{var te=i(S);te!==null&&H(O,te.startTime-A),Y=!1}return Y}finally{P=null,R=j,$=!1}}var J=!1,D=null,ee=-1,Q=5,M=-1;function oe(){return!(a.unstable_now()-M<Q)}function L(){if(D!==null){var C=a.unstable_now();M=C;var A=!0;try{A=D(!0,C)}finally{A?ae():(J=!1,D=null)}}else J=!1}var ae;if(typeof W=="function")ae=function(){W(L)};else if(typeof MessageChannel<"u"){var I=new MessageChannel,X=I.port2;I.port1.onmessage=L,ae=function(){X.postMessage(null)}}else ae=function(){U(L,0)};function re(C){D=C,J||(J=!0,ae())}function H(C,A){ee=U(function(){C(a.unstable_now())},A)}a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function(C){C.callback=null},a.unstable_continueExecution=function(){B||$||(B=!0,re(w))},a.unstable_forceFrameRate=function(C){0>C||125<C?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Q=0<C?Math.floor(1e3/C):5},a.unstable_getCurrentPriorityLevel=function(){return R},a.unstable_getFirstCallbackNode=function(){return i(v)},a.unstable_next=function(C){switch(R){case 1:case 2:case 3:var A=3;break;default:A=R}var j=R;R=A;try{return C()}finally{R=j}},a.unstable_pauseExecution=function(){},a.unstable_requestPaint=function(){},a.unstable_runWithPriority=function(C,A){switch(C){case 1:case 2:case 3:case 4:case 5:break;default:C=3}var j=R;R=C;try{return A()}finally{R=j}},a.unstable_scheduleCallback=function(C,A,j){var h=a.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?h+j:h):j=h,C){case 1:var E=-1;break;case 2:E=250;break;case 5:E=1073741823;break;case 4:E=1e4;break;default:E=5e3}return E=j+E,C={id:k++,callback:A,priorityLevel:C,startTime:j,expirationTime:E,sortIndex:-1},j>h?(C.sortIndex=j,u(S,C),i(v)===null&&C===i(S)&&(z?(V(ee),ee=-1):z=!0,H(O,j-h))):(C.sortIndex=E,u(v,C),B||$||(B=!0,re(w))),C},a.unstable_shouldYield=oe,a.unstable_wrapCallback=function(C){var A=R;return function(){var j=R;R=A;try{return C.apply(this,arguments)}finally{R=j}}}})($i)),$i}var Tc;function rp(){return Tc||(Tc=1,Fi.exports=np()),Fi.exports}var Lc;function lp(){if(Lc)return ht;Lc=1;var a=Zi(),u=rp();function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var f=new Set,d={};function p(e,t){m(e,t),m(e+"Capture",t)}function m(e,t){for(d[e]=t,e=0;e<t.length;e++)f.add(t[e])}var y=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),v=Object.prototype.hasOwnProperty,S=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,k={},P={};function R(e){return v.call(P,e)?!0:v.call(k,e)?!1:S.test(e)?P[e]=!0:(k[e]=!0,!1)}function $(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function B(e,t,n,r){if(t===null||typeof t>"u"||$(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function z(e,t,n,r,l,s,c){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=l,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=c}var U={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){U[e]=new z(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];U[t]=new z(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){U[e]=new z(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){U[e]=new z(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){U[e]=new z(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){U[e]=new z(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){U[e]=new z(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){U[e]=new z(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){U[e]=new z(e,5,!1,e.toLowerCase(),null,!1,!1)});var V=/[\-:]([a-z])/g;function W(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(V,W);U[t]=new z(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(V,W);U[t]=new z(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(V,W);U[t]=new z(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){U[e]=new z(e,1,!1,e.toLowerCase(),null,!1,!1)}),U.xlinkHref=new z("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){U[e]=new z(e,1,!1,e.toLowerCase(),null,!0,!0)});function le(e,t,n,r){var l=U.hasOwnProperty(t)?U[t]:null;(l!==null?l.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(B(t,n,l,r)&&(n=null),r||l===null?R(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):l.mustUseProperty?e[l.propertyName]=n===null?l.type===3?!1:"":n:(t=l.attributeName,r=l.attributeNamespace,n===null?e.removeAttribute(t):(l=l.type,n=l===3||l===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var O=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),J=Symbol.for("react.portal"),D=Symbol.for("react.fragment"),ee=Symbol.for("react.strict_mode"),Q=Symbol.for("react.profiler"),M=Symbol.for("react.provider"),oe=Symbol.for("react.context"),L=Symbol.for("react.forward_ref"),ae=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),X=Symbol.for("react.memo"),re=Symbol.for("react.lazy"),H=Symbol.for("react.offscreen"),C=Symbol.iterator;function A(e){return e===null||typeof e!="object"?null:(e=C&&e[C]||e["@@iterator"],typeof e=="function"?e:null)}var j=Object.assign,h;function E(e){if(h===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);h=t&&t[1]||""}return`
`+h+e}var Y=!1;function te(e,t){if(!e||Y)return"";Y=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(F){var r=F}Reflect.construct(e,[],t)}else{try{t.call()}catch(F){r=F}e.call(t.prototype)}else{try{throw Error()}catch(F){r=F}e()}}catch(F){if(F&&r&&typeof F.stack=="string"){for(var l=F.stack.split(`
`),s=r.stack.split(`
`),c=l.length-1,g=s.length-1;1<=c&&0<=g&&l[c]!==s[g];)g--;for(;1<=c&&0<=g;c--,g--)if(l[c]!==s[g]){if(c!==1||g!==1)do if(c--,g--,0>g||l[c]!==s[g]){var x=`
`+l[c].replace(" at new "," at ");return e.displayName&&x.includes("<anonymous>")&&(x=x.replace("<anonymous>",e.displayName)),x}while(1<=c&&0<=g);break}}}finally{Y=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?E(e):""}function ie(e){switch(e.tag){case 5:return E(e.type);case 16:return E("Lazy");case 13:return E("Suspense");case 19:return E("SuspenseList");case 0:case 2:case 15:return e=te(e.type,!1),e;case 11:return e=te(e.type.render,!1),e;case 1:return e=te(e.type,!0),e;default:return""}}function me(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case D:return"Fragment";case J:return"Portal";case Q:return"Profiler";case ee:return"StrictMode";case ae:return"Suspense";case I:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case oe:return(e.displayName||"Context")+".Consumer";case M:return(e._context.displayName||"Context")+".Provider";case L:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case X:return t=e.displayName||null,t!==null?t:me(e.type)||"Memo";case re:t=e._payload,e=e._init;try{return me(e(t))}catch{}}return null}function ge(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return me(t);case 8:return t===ee?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ve(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function q(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function pe(e){var t=q(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var l=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return l.call(this)},set:function(c){r=""+c,s.call(this,c)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(c){r=""+c},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ne(e){e._valueTracker||(e._valueTracker=pe(e))}function se(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=q(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function ke(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ee(e,t){var n=t.checked;return j({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function De(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=ve(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function je(e,t){t=t.checked,t!=null&&le(e,"checked",t,!1)}function be(e,t){je(e,t);var n=ve(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Ye(e,t.type,n):t.hasOwnProperty("defaultValue")&&Ye(e,t.type,ve(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Oe(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Ye(e,t,n){(t!=="number"||ke(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var yt=Array.isArray;function ot(e,t,n,r){if(e=e.options,t){t={};for(var l=0;l<n.length;l++)t["$"+n[l]]=!0;for(n=0;n<e.length;n++)l=t.hasOwnProperty("$"+e[n].value),e[n].selected!==l&&(e[n].selected=l),l&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ve(n),t=null,l=0;l<e.length;l++){if(e[l].value===n){e[l].selected=!0,r&&(e[l].defaultSelected=!0);return}t!==null||e[l].disabled||(t=e[l])}t!==null&&(t.selected=!0)}}function We(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(i(91));return j({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function $e(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(i(92));if(yt(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:ve(n)}}function yl(e,t){var n=ve(t.value),r=ve(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function vl(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Sr(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function jr(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Sr(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Qn,xl=(function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,l){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,l)})}:e})(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Qn=Qn||document.createElement("div"),Qn.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Qn.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Pn(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var _n={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Gs=["Webkit","ms","Moz","O"];Object.keys(_n).forEach(function(e){Gs.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),_n[t]=_n[e]})});function wl(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||_n.hasOwnProperty(e)&&_n[e]?(""+t).trim():t+"px"}function kl(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,l=wl(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,l):e[n]=l}}var Nl=j({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Dn(e,t){if(t){if(Nl[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(i(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(i(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(t.style!=null&&typeof t.style!="object")throw Error(i(62))}}function Cr(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Er=null;function br(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Pr=null,$t=null,St=null;function Sl(e){if(e=qr(e)){if(typeof Pr!="function")throw Error(i(280));var t=e.stateNode;t&&(t=Yl(t),Pr(e.stateNode,e.type,t))}}function ln(e){$t?St?St.push(e):St=[e]:$t=e}function Yn(){if($t){var e=$t,t=St;if(St=$t=null,Sl(e),t)for(e=0;e<t.length;e++)Sl(t[e])}}function _r(e,t){return e(t)}function jl(){}var Dr=!1;function Cl(e,t,n){if(Dr)return e(t,n);Dr=!0;try{return _r(e,t,n)}finally{Dr=!1,($t!==null||St!==null)&&(jl(),Yn())}}function On(e,t){var n=e.stateNode;if(n===null)return null;var r=Yl(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(i(231,t,typeof n));return n}var Or=!1;if(y)try{var Rn={};Object.defineProperty(Rn,"passive",{get:function(){Or=!0}}),window.addEventListener("test",Rn,Rn),window.removeEventListener("test",Rn,Rn)}catch{Or=!1}function Qt(e,t,n,r,l,s,c,g,x){var F=Array.prototype.slice.call(arguments,3);try{t.apply(n,F)}catch(G){this.onError(G)}}var Yt=!1,Gn=null,Jn=!1,Rr=null,Js={onError:function(e){Yt=!0,Gn=e}};function Xs(e,t,n,r,l,s,c,g,x){Yt=!1,Gn=null,Qt.apply(Js,arguments)}function qs(e,t,n,r,l,s,c,g,x){if(Xs.apply(this,arguments),Yt){if(Yt){var F=Gn;Yt=!1,Gn=null}else throw Error(i(198));Jn||(Jn=!0,Rr=F)}}function At(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function El(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Xn(e){if(At(e)!==e)throw Error(i(188))}function Zs(e){var t=e.alternate;if(!t){if(t=At(e),t===null)throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var l=n.return;if(l===null)break;var s=l.alternate;if(s===null){if(r=l.return,r!==null){n=r;continue}break}if(l.child===s.child){for(s=l.child;s;){if(s===n)return Xn(l),e;if(s===r)return Xn(l),t;s=s.sibling}throw Error(i(188))}if(n.return!==r.return)n=l,r=s;else{for(var c=!1,g=l.child;g;){if(g===n){c=!0,n=l,r=s;break}if(g===r){c=!0,r=l,n=s;break}g=g.sibling}if(!c){for(g=s.child;g;){if(g===n){c=!0,n=s,r=l;break}if(g===r){c=!0,r=s,n=l;break}g=g.sibling}if(!c)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(n.tag!==3)throw Error(i(188));return n.stateNode.current===n?e:t}function Tr(e){return e=Zs(e),e!==null?bl(e):null}function bl(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=bl(e);if(t!==null)return t;e=e.sibling}return null}var ye=u.unstable_scheduleCallback,Re=u.unstable_cancelCallback,Ke=u.unstable_shouldYield,jt=u.unstable_requestPaint,Ae=u.unstable_now,cd=u.unstable_getCurrentPriorityLevel,eo=u.unstable_ImmediatePriority,ra=u.unstable_UserBlockingPriority,Pl=u.unstable_NormalPriority,dd=u.unstable_LowPriority,la=u.unstable_IdlePriority,_l=null,Ut=null;function fd(e){if(Ut&&typeof Ut.onCommitFiberRoot=="function")try{Ut.onCommitFiberRoot(_l,e,void 0,(e.current.flags&128)===128)}catch{}}var Ot=Math.clz32?Math.clz32:md,pd=Math.log,hd=Math.LN2;function md(e){return e>>>=0,e===0?32:31-(pd(e)/hd|0)|0}var Dl=64,Ol=4194304;function Lr(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Rl(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,l=e.suspendedLanes,s=e.pingedLanes,c=n&268435455;if(c!==0){var g=c&~l;g!==0?r=Lr(g):(s&=c,s!==0&&(r=Lr(s)))}else c=n&~l,c!==0?r=Lr(c):s!==0&&(r=Lr(s));if(r===0)return 0;if(t!==0&&t!==r&&(t&l)===0&&(l=r&-r,s=t&-t,l>=s||l===16&&(s&4194240)!==0))return t;if((r&4)!==0&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Ot(t),l=1<<n,r|=e[n],t&=~l;return r}function gd(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function yd(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,l=e.expirationTimes,s=e.pendingLanes;0<s;){var c=31-Ot(s),g=1<<c,x=l[c];x===-1?((g&n)===0||(g&r)!==0)&&(l[c]=gd(g,t)):x<=t&&(e.expiredLanes|=g),s&=~g}}function to(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function sa(){var e=Dl;return Dl<<=1,(Dl&4194240)===0&&(Dl=64),e}function no(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function zr(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ot(t),e[t]=n}function vd(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var l=31-Ot(n),s=1<<l;t[l]=0,r[l]=-1,e[l]=-1,n&=~s}}function ro(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Ot(n),l=1<<r;l&t|e[r]&t&&(e[r]|=t),n&=~l}}var Te=0;function oa(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var ia,lo,aa,ua,ca,so=!1,Tl=[],sn=null,on=null,an=null,Ir=new Map,Mr=new Map,un=[],xd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function da(e,t){switch(e){case"focusin":case"focusout":sn=null;break;case"dragenter":case"dragleave":on=null;break;case"mouseover":case"mouseout":an=null;break;case"pointerover":case"pointerout":Ir.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Mr.delete(t.pointerId)}}function Fr(e,t,n,r,l,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[l]},t!==null&&(t=qr(t),t!==null&&lo(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,l!==null&&t.indexOf(l)===-1&&t.push(l),e)}function wd(e,t,n,r,l){switch(t){case"focusin":return sn=Fr(sn,e,t,n,r,l),!0;case"dragenter":return on=Fr(on,e,t,n,r,l),!0;case"mouseover":return an=Fr(an,e,t,n,r,l),!0;case"pointerover":var s=l.pointerId;return Ir.set(s,Fr(Ir.get(s)||null,e,t,n,r,l)),!0;case"gotpointercapture":return s=l.pointerId,Mr.set(s,Fr(Mr.get(s)||null,e,t,n,r,l)),!0}return!1}function fa(e){var t=Tn(e.target);if(t!==null){var n=At(t);if(n!==null){if(t=n.tag,t===13){if(t=El(n),t!==null){e.blockedOn=t,ca(e.priority,function(){aa(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ll(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=io(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Er=r,n.target.dispatchEvent(r),Er=null}else return t=qr(n),t!==null&&lo(t),e.blockedOn=n,!1;t.shift()}return!0}function pa(e,t,n){Ll(e)&&n.delete(t)}function kd(){so=!1,sn!==null&&Ll(sn)&&(sn=null),on!==null&&Ll(on)&&(on=null),an!==null&&Ll(an)&&(an=null),Ir.forEach(pa),Mr.forEach(pa)}function $r(e,t){e.blockedOn===t&&(e.blockedOn=null,so||(so=!0,u.unstable_scheduleCallback(u.unstable_NormalPriority,kd)))}function Ar(e){function t(l){return $r(l,e)}if(0<Tl.length){$r(Tl[0],e);for(var n=1;n<Tl.length;n++){var r=Tl[n];r.blockedOn===e&&(r.blockedOn=null)}}for(sn!==null&&$r(sn,e),on!==null&&$r(on,e),an!==null&&$r(an,e),Ir.forEach(t),Mr.forEach(t),n=0;n<un.length;n++)r=un[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<un.length&&(n=un[0],n.blockedOn===null);)fa(n),n.blockedOn===null&&un.shift()}var qn=O.ReactCurrentBatchConfig,zl=!0;function Nd(e,t,n,r){var l=Te,s=qn.transition;qn.transition=null;try{Te=1,oo(e,t,n,r)}finally{Te=l,qn.transition=s}}function Sd(e,t,n,r){var l=Te,s=qn.transition;qn.transition=null;try{Te=4,oo(e,t,n,r)}finally{Te=l,qn.transition=s}}function oo(e,t,n,r){if(zl){var l=io(e,t,n,r);if(l===null)Co(e,t,r,Il,n),da(e,r);else if(wd(l,e,t,n,r))r.stopPropagation();else if(da(e,r),t&4&&-1<xd.indexOf(e)){for(;l!==null;){var s=qr(l);if(s!==null&&ia(s),s=io(e,t,n,r),s===null&&Co(e,t,r,Il,n),s===l)break;l=s}l!==null&&r.stopPropagation()}else Co(e,t,r,null,n)}}var Il=null;function io(e,t,n,r){if(Il=null,e=br(r),e=Tn(e),e!==null)if(t=At(e),t===null)e=null;else if(n=t.tag,n===13){if(e=El(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Il=e,null}function ha(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(cd()){case eo:return 1;case ra:return 4;case Pl:case dd:return 16;case la:return 536870912;default:return 16}default:return 16}}var cn=null,ao=null,Ml=null;function ma(){if(Ml)return Ml;var e,t=ao,n=t.length,r,l="value"in cn?cn.value:cn.textContent,s=l.length;for(e=0;e<n&&t[e]===l[e];e++);var c=n-e;for(r=1;r<=c&&t[n-r]===l[s-r];r++);return Ml=l.slice(e,1<r?1-r:void 0)}function Fl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function $l(){return!0}function ga(){return!1}function vt(e){function t(n,r,l,s,c){this._reactName=n,this._targetInst=l,this.type=r,this.nativeEvent=s,this.target=c,this.currentTarget=null;for(var g in e)e.hasOwnProperty(g)&&(n=e[g],this[g]=n?n(s):s[g]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?$l:ga,this.isPropagationStopped=ga,this}return j(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=$l)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=$l)},persist:function(){},isPersistent:$l}),t}var Zn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},uo=vt(Zn),Ur=j({},Zn,{view:0,detail:0}),jd=vt(Ur),co,fo,Br,Al=j({},Ur,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ho,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Br&&(Br&&e.type==="mousemove"?(co=e.screenX-Br.screenX,fo=e.screenY-Br.screenY):fo=co=0,Br=e),co)},movementY:function(e){return"movementY"in e?e.movementY:fo}}),ya=vt(Al),Cd=j({},Al,{dataTransfer:0}),Ed=vt(Cd),bd=j({},Ur,{relatedTarget:0}),po=vt(bd),Pd=j({},Zn,{animationName:0,elapsedTime:0,pseudoElement:0}),_d=vt(Pd),Dd=j({},Zn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Od=vt(Dd),Rd=j({},Zn,{data:0}),va=vt(Rd),Td={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ld={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Id(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=zd[e])?!!t[e]:!1}function ho(){return Id}var Md=j({},Ur,{key:function(e){if(e.key){var t=Td[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Fl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Ld[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ho,charCode:function(e){return e.type==="keypress"?Fl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Fl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Fd=vt(Md),$d=j({},Al,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),xa=vt($d),Ad=j({},Ur,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ho}),Ud=vt(Ad),Bd=j({},Zn,{propertyName:0,elapsedTime:0,pseudoElement:0}),Hd=vt(Bd),Vd=j({},Al,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Wd=vt(Vd),Kd=[9,13,27,32],mo=y&&"CompositionEvent"in window,Hr=null;y&&"documentMode"in document&&(Hr=document.documentMode);var Qd=y&&"TextEvent"in window&&!Hr,wa=y&&(!mo||Hr&&8<Hr&&11>=Hr),ka=" ",Na=!1;function Sa(e,t){switch(e){case"keyup":return Kd.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ja(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var er=!1;function Yd(e,t){switch(e){case"compositionend":return ja(t);case"keypress":return t.which!==32?null:(Na=!0,ka);case"textInput":return e=t.data,e===ka&&Na?null:e;default:return null}}function Gd(e,t){if(er)return e==="compositionend"||!mo&&Sa(e,t)?(e=ma(),Ml=ao=cn=null,er=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return wa&&t.locale!=="ko"?null:t.data;default:return null}}var Jd={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ca(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Jd[e.type]:t==="textarea"}function Ea(e,t,n,r){ln(r),t=Wl(t,"onChange"),0<t.length&&(n=new uo("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Vr=null,Wr=null;function Xd(e){Va(e,0)}function Ul(e){var t=sr(e);if(se(t))return e}function qd(e,t){if(e==="change")return t}var ba=!1;if(y){var go;if(y){var yo="oninput"in document;if(!yo){var Pa=document.createElement("div");Pa.setAttribute("oninput","return;"),yo=typeof Pa.oninput=="function"}go=yo}else go=!1;ba=go&&(!document.documentMode||9<document.documentMode)}function _a(){Vr&&(Vr.detachEvent("onpropertychange",Da),Wr=Vr=null)}function Da(e){if(e.propertyName==="value"&&Ul(Wr)){var t=[];Ea(t,Wr,e,br(e)),Cl(Xd,t)}}function Zd(e,t,n){e==="focusin"?(_a(),Vr=t,Wr=n,Vr.attachEvent("onpropertychange",Da)):e==="focusout"&&_a()}function ef(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ul(Wr)}function tf(e,t){if(e==="click")return Ul(t)}function nf(e,t){if(e==="input"||e==="change")return Ul(t)}function rf(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Rt=typeof Object.is=="function"?Object.is:rf;function Kr(e,t){if(Rt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var l=n[r];if(!v.call(t,l)||!Rt(e[l],t[l]))return!1}return!0}function Oa(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ra(e,t){var n=Oa(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Oa(n)}}function Ta(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Ta(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function La(){for(var e=window,t=ke();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=ke(e.document)}return t}function vo(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function lf(e){var t=La(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Ta(n.ownerDocument.documentElement,n)){if(r!==null&&vo(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var l=n.textContent.length,s=Math.min(r.start,l);r=r.end===void 0?s:Math.min(r.end,l),!e.extend&&s>r&&(l=r,r=s,s=l),l=Ra(n,s);var c=Ra(n,r);l&&c&&(e.rangeCount!==1||e.anchorNode!==l.node||e.anchorOffset!==l.offset||e.focusNode!==c.node||e.focusOffset!==c.offset)&&(t=t.createRange(),t.setStart(l.node,l.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(c.node,c.offset)):(t.setEnd(c.node,c.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var sf=y&&"documentMode"in document&&11>=document.documentMode,tr=null,xo=null,Qr=null,wo=!1;function za(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;wo||tr==null||tr!==ke(r)||(r=tr,"selectionStart"in r&&vo(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Qr&&Kr(Qr,r)||(Qr=r,r=Wl(xo,"onSelect"),0<r.length&&(t=new uo("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=tr)))}function Bl(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var nr={animationend:Bl("Animation","AnimationEnd"),animationiteration:Bl("Animation","AnimationIteration"),animationstart:Bl("Animation","AnimationStart"),transitionend:Bl("Transition","TransitionEnd")},ko={},Ia={};y&&(Ia=document.createElement("div").style,"AnimationEvent"in window||(delete nr.animationend.animation,delete nr.animationiteration.animation,delete nr.animationstart.animation),"TransitionEvent"in window||delete nr.transitionend.transition);function Hl(e){if(ko[e])return ko[e];if(!nr[e])return e;var t=nr[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Ia)return ko[e]=t[n];return e}var Ma=Hl("animationend"),Fa=Hl("animationiteration"),$a=Hl("animationstart"),Aa=Hl("transitionend"),Ua=new Map,Ba="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function dn(e,t){Ua.set(e,t),p(t,[e])}for(var No=0;No<Ba.length;No++){var So=Ba[No],of=So.toLowerCase(),af=So[0].toUpperCase()+So.slice(1);dn(of,"on"+af)}dn(Ma,"onAnimationEnd"),dn(Fa,"onAnimationIteration"),dn($a,"onAnimationStart"),dn("dblclick","onDoubleClick"),dn("focusin","onFocus"),dn("focusout","onBlur"),dn(Aa,"onTransitionEnd"),m("onMouseEnter",["mouseout","mouseover"]),m("onMouseLeave",["mouseout","mouseover"]),m("onPointerEnter",["pointerout","pointerover"]),m("onPointerLeave",["pointerout","pointerover"]),p("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),p("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),p("onBeforeInput",["compositionend","keypress","textInput","paste"]),p("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),p("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),p("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),uf=new Set("cancel close invalid load scroll toggle".split(" ").concat(Yr));function Ha(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,qs(r,t,void 0,e),e.currentTarget=null}function Va(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],l=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var c=r.length-1;0<=c;c--){var g=r[c],x=g.instance,F=g.currentTarget;if(g=g.listener,x!==s&&l.isPropagationStopped())break e;Ha(l,g,F),s=x}else for(c=0;c<r.length;c++){if(g=r[c],x=g.instance,F=g.currentTarget,g=g.listener,x!==s&&l.isPropagationStopped())break e;Ha(l,g,F),s=x}}}if(Jn)throw e=Rr,Jn=!1,Rr=null,e}function Ie(e,t){var n=t[Oo];n===void 0&&(n=t[Oo]=new Set);var r=e+"__bubble";n.has(r)||(Wa(t,e,2,!1),n.add(r))}function jo(e,t,n){var r=0;t&&(r|=4),Wa(n,e,r,t)}var Vl="_reactListening"+Math.random().toString(36).slice(2);function Gr(e){if(!e[Vl]){e[Vl]=!0,f.forEach(function(n){n!=="selectionchange"&&(uf.has(n)||jo(n,!1,e),jo(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Vl]||(t[Vl]=!0,jo("selectionchange",!1,t))}}function Wa(e,t,n,r){switch(ha(t)){case 1:var l=Nd;break;case 4:l=Sd;break;default:l=oo}n=l.bind(null,t,n,e),l=void 0,!Or||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(l=!0),r?l!==void 0?e.addEventListener(t,n,{capture:!0,passive:l}):e.addEventListener(t,n,!0):l!==void 0?e.addEventListener(t,n,{passive:l}):e.addEventListener(t,n,!1)}function Co(e,t,n,r,l){var s=r;if((t&1)===0&&(t&2)===0&&r!==null)e:for(;;){if(r===null)return;var c=r.tag;if(c===3||c===4){var g=r.stateNode.containerInfo;if(g===l||g.nodeType===8&&g.parentNode===l)break;if(c===4)for(c=r.return;c!==null;){var x=c.tag;if((x===3||x===4)&&(x=c.stateNode.containerInfo,x===l||x.nodeType===8&&x.parentNode===l))return;c=c.return}for(;g!==null;){if(c=Tn(g),c===null)return;if(x=c.tag,x===5||x===6){r=s=c;continue e}g=g.parentNode}}r=r.return}Cl(function(){var F=s,G=br(n),Z=[];e:{var K=Ua.get(e);if(K!==void 0){var ue=uo,de=e;switch(e){case"keypress":if(Fl(n)===0)break e;case"keydown":case"keyup":ue=Fd;break;case"focusin":de="focus",ue=po;break;case"focusout":de="blur",ue=po;break;case"beforeblur":case"afterblur":ue=po;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ue=ya;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ue=Ed;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ue=Ud;break;case Ma:case Fa:case $a:ue=_d;break;case Aa:ue=Hd;break;case"scroll":ue=jd;break;case"wheel":ue=Wd;break;case"copy":case"cut":case"paste":ue=Od;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ue=xa}var fe=(t&4)!==0,Ve=!fe&&e==="scroll",_=fe?K!==null?K+"Capture":null:K;fe=[];for(var N=F,T;N!==null;){T=N;var ne=T.stateNode;if(T.tag===5&&ne!==null&&(T=ne,_!==null&&(ne=On(N,_),ne!=null&&fe.push(Jr(N,ne,T)))),Ve)break;N=N.return}0<fe.length&&(K=new ue(K,de,null,n,G),Z.push({event:K,listeners:fe}))}}if((t&7)===0){e:{if(K=e==="mouseover"||e==="pointerover",ue=e==="mouseout"||e==="pointerout",K&&n!==Er&&(de=n.relatedTarget||n.fromElement)&&(Tn(de)||de[Gt]))break e;if((ue||K)&&(K=G.window===G?G:(K=G.ownerDocument)?K.defaultView||K.parentWindow:window,ue?(de=n.relatedTarget||n.toElement,ue=F,de=de?Tn(de):null,de!==null&&(Ve=At(de),de!==Ve||de.tag!==5&&de.tag!==6)&&(de=null)):(ue=null,de=F),ue!==de)){if(fe=ya,ne="onMouseLeave",_="onMouseEnter",N="mouse",(e==="pointerout"||e==="pointerover")&&(fe=xa,ne="onPointerLeave",_="onPointerEnter",N="pointer"),Ve=ue==null?K:sr(ue),T=de==null?K:sr(de),K=new fe(ne,N+"leave",ue,n,G),K.target=Ve,K.relatedTarget=T,ne=null,Tn(G)===F&&(fe=new fe(_,N+"enter",de,n,G),fe.target=T,fe.relatedTarget=Ve,ne=fe),Ve=ne,ue&&de)t:{for(fe=ue,_=de,N=0,T=fe;T;T=rr(T))N++;for(T=0,ne=_;ne;ne=rr(ne))T++;for(;0<N-T;)fe=rr(fe),N--;for(;0<T-N;)_=rr(_),T--;for(;N--;){if(fe===_||_!==null&&fe===_.alternate)break t;fe=rr(fe),_=rr(_)}fe=null}else fe=null;ue!==null&&Ka(Z,K,ue,fe,!1),de!==null&&Ve!==null&&Ka(Z,Ve,de,fe,!0)}}e:{if(K=F?sr(F):window,ue=K.nodeName&&K.nodeName.toLowerCase(),ue==="select"||ue==="input"&&K.type==="file")var he=qd;else if(Ca(K))if(ba)he=nf;else{he=ef;var xe=Zd}else(ue=K.nodeName)&&ue.toLowerCase()==="input"&&(K.type==="checkbox"||K.type==="radio")&&(he=tf);if(he&&(he=he(e,F))){Ea(Z,he,n,G);break e}xe&&xe(e,K,F),e==="focusout"&&(xe=K._wrapperState)&&xe.controlled&&K.type==="number"&&Ye(K,"number",K.value)}switch(xe=F?sr(F):window,e){case"focusin":(Ca(xe)||xe.contentEditable==="true")&&(tr=xe,xo=F,Qr=null);break;case"focusout":Qr=xo=tr=null;break;case"mousedown":wo=!0;break;case"contextmenu":case"mouseup":case"dragend":wo=!1,za(Z,n,G);break;case"selectionchange":if(sf)break;case"keydown":case"keyup":za(Z,n,G)}var we;if(mo)e:{switch(e){case"compositionstart":var Se="onCompositionStart";break e;case"compositionend":Se="onCompositionEnd";break e;case"compositionupdate":Se="onCompositionUpdate";break e}Se=void 0}else er?Sa(e,n)&&(Se="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(Se="onCompositionStart");Se&&(wa&&n.locale!=="ko"&&(er||Se!=="onCompositionStart"?Se==="onCompositionEnd"&&er&&(we=ma()):(cn=G,ao="value"in cn?cn.value:cn.textContent,er=!0)),xe=Wl(F,Se),0<xe.length&&(Se=new va(Se,e,null,n,G),Z.push({event:Se,listeners:xe}),we?Se.data=we:(we=ja(n),we!==null&&(Se.data=we)))),(we=Qd?Yd(e,n):Gd(e,n))&&(F=Wl(F,"onBeforeInput"),0<F.length&&(G=new va("onBeforeInput","beforeinput",null,n,G),Z.push({event:G,listeners:F}),G.data=we))}Va(Z,t)})}function Jr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Wl(e,t){for(var n=t+"Capture",r=[];e!==null;){var l=e,s=l.stateNode;l.tag===5&&s!==null&&(l=s,s=On(e,n),s!=null&&r.unshift(Jr(e,s,l)),s=On(e,t),s!=null&&r.push(Jr(e,s,l))),e=e.return}return r}function rr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Ka(e,t,n,r,l){for(var s=t._reactName,c=[];n!==null&&n!==r;){var g=n,x=g.alternate,F=g.stateNode;if(x!==null&&x===r)break;g.tag===5&&F!==null&&(g=F,l?(x=On(n,s),x!=null&&c.unshift(Jr(n,x,g))):l||(x=On(n,s),x!=null&&c.push(Jr(n,x,g)))),n=n.return}c.length!==0&&e.push({event:t,listeners:c})}var cf=/\r\n?/g,df=/\u0000|\uFFFD/g;function Qa(e){return(typeof e=="string"?e:""+e).replace(cf,`
`).replace(df,"")}function Kl(e,t,n){if(t=Qa(t),Qa(e)!==t&&n)throw Error(i(425))}function Ql(){}var Eo=null,bo=null;function Po(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var _o=typeof setTimeout=="function"?setTimeout:void 0,ff=typeof clearTimeout=="function"?clearTimeout:void 0,Ya=typeof Promise=="function"?Promise:void 0,pf=typeof queueMicrotask=="function"?queueMicrotask:typeof Ya<"u"?function(e){return Ya.resolve(null).then(e).catch(hf)}:_o;function hf(e){setTimeout(function(){throw e})}function Do(e,t){var n=t,r=0;do{var l=n.nextSibling;if(e.removeChild(n),l&&l.nodeType===8)if(n=l.data,n==="/$"){if(r===0){e.removeChild(l),Ar(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=l}while(n);Ar(t)}function fn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Ga(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var lr=Math.random().toString(36).slice(2),Bt="__reactFiber$"+lr,Xr="__reactProps$"+lr,Gt="__reactContainer$"+lr,Oo="__reactEvents$"+lr,mf="__reactListeners$"+lr,gf="__reactHandles$"+lr;function Tn(e){var t=e[Bt];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Gt]||n[Bt]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Ga(e);e!==null;){if(n=e[Bt])return n;e=Ga(e)}return t}e=n,n=e.parentNode}return null}function qr(e){return e=e[Bt]||e[Gt],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function sr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(i(33))}function Yl(e){return e[Xr]||null}var Ro=[],or=-1;function pn(e){return{current:e}}function Me(e){0>or||(e.current=Ro[or],Ro[or]=null,or--)}function Le(e,t){or++,Ro[or]=e.current,e.current=t}var hn={},nt=pn(hn),ut=pn(!1),Ln=hn;function ir(e,t){var n=e.type.contextTypes;if(!n)return hn;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var l={},s;for(s in n)l[s]=t[s];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=l),l}function ct(e){return e=e.childContextTypes,e!=null}function Gl(){Me(ut),Me(nt)}function Ja(e,t,n){if(nt.current!==hn)throw Error(i(168));Le(nt,t),Le(ut,n)}function Xa(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var l in r)if(!(l in t))throw Error(i(108,ge(e)||"Unknown",l));return j({},n,r)}function Jl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||hn,Ln=nt.current,Le(nt,e),Le(ut,ut.current),!0}function qa(e,t,n){var r=e.stateNode;if(!r)throw Error(i(169));n?(e=Xa(e,t,Ln),r.__reactInternalMemoizedMergedChildContext=e,Me(ut),Me(nt),Le(nt,e)):Me(ut),Le(ut,n)}var Jt=null,Xl=!1,To=!1;function Za(e){Jt===null?Jt=[e]:Jt.push(e)}function yf(e){Xl=!0,Za(e)}function mn(){if(!To&&Jt!==null){To=!0;var e=0,t=Te;try{var n=Jt;for(Te=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Jt=null,Xl=!1}catch(l){throw Jt!==null&&(Jt=Jt.slice(e+1)),ye(eo,mn),l}finally{Te=t,To=!1}}return null}var ar=[],ur=0,ql=null,Zl=0,Ct=[],Et=0,zn=null,Xt=1,qt="";function In(e,t){ar[ur++]=Zl,ar[ur++]=ql,ql=e,Zl=t}function eu(e,t,n){Ct[Et++]=Xt,Ct[Et++]=qt,Ct[Et++]=zn,zn=e;var r=Xt;e=qt;var l=32-Ot(r)-1;r&=~(1<<l),n+=1;var s=32-Ot(t)+l;if(30<s){var c=l-l%5;s=(r&(1<<c)-1).toString(32),r>>=c,l-=c,Xt=1<<32-Ot(t)+l|n<<l|r,qt=s+e}else Xt=1<<s|n<<l|r,qt=e}function Lo(e){e.return!==null&&(In(e,1),eu(e,1,0))}function zo(e){for(;e===ql;)ql=ar[--ur],ar[ur]=null,Zl=ar[--ur],ar[ur]=null;for(;e===zn;)zn=Ct[--Et],Ct[Et]=null,qt=Ct[--Et],Ct[Et]=null,Xt=Ct[--Et],Ct[Et]=null}var xt=null,wt=null,Fe=!1,Tt=null;function tu(e,t){var n=Dt(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function nu(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,xt=e,wt=fn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,xt=e,wt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=zn!==null?{id:Xt,overflow:qt}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Dt(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,xt=e,wt=null,!0):!1;default:return!1}}function Io(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Mo(e){if(Fe){var t=wt;if(t){var n=t;if(!nu(e,t)){if(Io(e))throw Error(i(418));t=fn(n.nextSibling);var r=xt;t&&nu(e,t)?tu(r,n):(e.flags=e.flags&-4097|2,Fe=!1,xt=e)}}else{if(Io(e))throw Error(i(418));e.flags=e.flags&-4097|2,Fe=!1,xt=e}}}function ru(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;xt=e}function es(e){if(e!==xt)return!1;if(!Fe)return ru(e),Fe=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Po(e.type,e.memoizedProps)),t&&(t=wt)){if(Io(e))throw lu(),Error(i(418));for(;t;)tu(e,t),t=fn(t.nextSibling)}if(ru(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){wt=fn(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}wt=null}}else wt=xt?fn(e.stateNode.nextSibling):null;return!0}function lu(){for(var e=wt;e;)e=fn(e.nextSibling)}function cr(){wt=xt=null,Fe=!1}function Fo(e){Tt===null?Tt=[e]:Tt.push(e)}var vf=O.ReactCurrentBatchConfig;function Zr(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,e));var l=r,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(c){var g=l.refs;c===null?delete g[s]:g[s]=c},t._stringRef=s,t)}if(typeof e!="string")throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function ts(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function su(e){var t=e._init;return t(e._payload)}function ou(e){function t(_,N){if(e){var T=_.deletions;T===null?(_.deletions=[N],_.flags|=16):T.push(N)}}function n(_,N){if(!e)return null;for(;N!==null;)t(_,N),N=N.sibling;return null}function r(_,N){for(_=new Map;N!==null;)N.key!==null?_.set(N.key,N):_.set(N.index,N),N=N.sibling;return _}function l(_,N){return _=Sn(_,N),_.index=0,_.sibling=null,_}function s(_,N,T){return _.index=T,e?(T=_.alternate,T!==null?(T=T.index,T<N?(_.flags|=2,N):T):(_.flags|=2,N)):(_.flags|=1048576,N)}function c(_){return e&&_.alternate===null&&(_.flags|=2),_}function g(_,N,T,ne){return N===null||N.tag!==6?(N=_i(T,_.mode,ne),N.return=_,N):(N=l(N,T),N.return=_,N)}function x(_,N,T,ne){var he=T.type;return he===D?G(_,N,T.props.children,ne,T.key):N!==null&&(N.elementType===he||typeof he=="object"&&he!==null&&he.$$typeof===re&&su(he)===N.type)?(ne=l(N,T.props),ne.ref=Zr(_,N,T),ne.return=_,ne):(ne=Cs(T.type,T.key,T.props,null,_.mode,ne),ne.ref=Zr(_,N,T),ne.return=_,ne)}function F(_,N,T,ne){return N===null||N.tag!==4||N.stateNode.containerInfo!==T.containerInfo||N.stateNode.implementation!==T.implementation?(N=Di(T,_.mode,ne),N.return=_,N):(N=l(N,T.children||[]),N.return=_,N)}function G(_,N,T,ne,he){return N===null||N.tag!==7?(N=Vn(T,_.mode,ne,he),N.return=_,N):(N=l(N,T),N.return=_,N)}function Z(_,N,T){if(typeof N=="string"&&N!==""||typeof N=="number")return N=_i(""+N,_.mode,T),N.return=_,N;if(typeof N=="object"&&N!==null){switch(N.$$typeof){case w:return T=Cs(N.type,N.key,N.props,null,_.mode,T),T.ref=Zr(_,null,N),T.return=_,T;case J:return N=Di(N,_.mode,T),N.return=_,N;case re:var ne=N._init;return Z(_,ne(N._payload),T)}if(yt(N)||A(N))return N=Vn(N,_.mode,T,null),N.return=_,N;ts(_,N)}return null}function K(_,N,T,ne){var he=N!==null?N.key:null;if(typeof T=="string"&&T!==""||typeof T=="number")return he!==null?null:g(_,N,""+T,ne);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case w:return T.key===he?x(_,N,T,ne):null;case J:return T.key===he?F(_,N,T,ne):null;case re:return he=T._init,K(_,N,he(T._payload),ne)}if(yt(T)||A(T))return he!==null?null:G(_,N,T,ne,null);ts(_,T)}return null}function ue(_,N,T,ne,he){if(typeof ne=="string"&&ne!==""||typeof ne=="number")return _=_.get(T)||null,g(N,_,""+ne,he);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case w:return _=_.get(ne.key===null?T:ne.key)||null,x(N,_,ne,he);case J:return _=_.get(ne.key===null?T:ne.key)||null,F(N,_,ne,he);case re:var xe=ne._init;return ue(_,N,T,xe(ne._payload),he)}if(yt(ne)||A(ne))return _=_.get(T)||null,G(N,_,ne,he,null);ts(N,ne)}return null}function de(_,N,T,ne){for(var he=null,xe=null,we=N,Se=N=0,Ze=null;we!==null&&Se<T.length;Se++){we.index>Se?(Ze=we,we=null):Ze=we.sibling;var _e=K(_,we,T[Se],ne);if(_e===null){we===null&&(we=Ze);break}e&&we&&_e.alternate===null&&t(_,we),N=s(_e,N,Se),xe===null?he=_e:xe.sibling=_e,xe=_e,we=Ze}if(Se===T.length)return n(_,we),Fe&&In(_,Se),he;if(we===null){for(;Se<T.length;Se++)we=Z(_,T[Se],ne),we!==null&&(N=s(we,N,Se),xe===null?he=we:xe.sibling=we,xe=we);return Fe&&In(_,Se),he}for(we=r(_,we);Se<T.length;Se++)Ze=ue(we,_,Se,T[Se],ne),Ze!==null&&(e&&Ze.alternate!==null&&we.delete(Ze.key===null?Se:Ze.key),N=s(Ze,N,Se),xe===null?he=Ze:xe.sibling=Ze,xe=Ze);return e&&we.forEach(function(jn){return t(_,jn)}),Fe&&In(_,Se),he}function fe(_,N,T,ne){var he=A(T);if(typeof he!="function")throw Error(i(150));if(T=he.call(T),T==null)throw Error(i(151));for(var xe=he=null,we=N,Se=N=0,Ze=null,_e=T.next();we!==null&&!_e.done;Se++,_e=T.next()){we.index>Se?(Ze=we,we=null):Ze=we.sibling;var jn=K(_,we,_e.value,ne);if(jn===null){we===null&&(we=Ze);break}e&&we&&jn.alternate===null&&t(_,we),N=s(jn,N,Se),xe===null?he=jn:xe.sibling=jn,xe=jn,we=Ze}if(_e.done)return n(_,we),Fe&&In(_,Se),he;if(we===null){for(;!_e.done;Se++,_e=T.next())_e=Z(_,_e.value,ne),_e!==null&&(N=s(_e,N,Se),xe===null?he=_e:xe.sibling=_e,xe=_e);return Fe&&In(_,Se),he}for(we=r(_,we);!_e.done;Se++,_e=T.next())_e=ue(we,_,Se,_e.value,ne),_e!==null&&(e&&_e.alternate!==null&&we.delete(_e.key===null?Se:_e.key),N=s(_e,N,Se),xe===null?he=_e:xe.sibling=_e,xe=_e);return e&&we.forEach(function(Xf){return t(_,Xf)}),Fe&&In(_,Se),he}function Ve(_,N,T,ne){if(typeof T=="object"&&T!==null&&T.type===D&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case w:e:{for(var he=T.key,xe=N;xe!==null;){if(xe.key===he){if(he=T.type,he===D){if(xe.tag===7){n(_,xe.sibling),N=l(xe,T.props.children),N.return=_,_=N;break e}}else if(xe.elementType===he||typeof he=="object"&&he!==null&&he.$$typeof===re&&su(he)===xe.type){n(_,xe.sibling),N=l(xe,T.props),N.ref=Zr(_,xe,T),N.return=_,_=N;break e}n(_,xe);break}else t(_,xe);xe=xe.sibling}T.type===D?(N=Vn(T.props.children,_.mode,ne,T.key),N.return=_,_=N):(ne=Cs(T.type,T.key,T.props,null,_.mode,ne),ne.ref=Zr(_,N,T),ne.return=_,_=ne)}return c(_);case J:e:{for(xe=T.key;N!==null;){if(N.key===xe)if(N.tag===4&&N.stateNode.containerInfo===T.containerInfo&&N.stateNode.implementation===T.implementation){n(_,N.sibling),N=l(N,T.children||[]),N.return=_,_=N;break e}else{n(_,N);break}else t(_,N);N=N.sibling}N=Di(T,_.mode,ne),N.return=_,_=N}return c(_);case re:return xe=T._init,Ve(_,N,xe(T._payload),ne)}if(yt(T))return de(_,N,T,ne);if(A(T))return fe(_,N,T,ne);ts(_,T)}return typeof T=="string"&&T!==""||typeof T=="number"?(T=""+T,N!==null&&N.tag===6?(n(_,N.sibling),N=l(N,T),N.return=_,_=N):(n(_,N),N=_i(T,_.mode,ne),N.return=_,_=N),c(_)):n(_,N)}return Ve}var dr=ou(!0),iu=ou(!1),ns=pn(null),rs=null,fr=null,$o=null;function Ao(){$o=fr=rs=null}function Uo(e){var t=ns.current;Me(ns),e._currentValue=t}function Bo(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function pr(e,t){rs=e,$o=fr=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&t)!==0&&(dt=!0),e.firstContext=null)}function bt(e){var t=e._currentValue;if($o!==e)if(e={context:e,memoizedValue:t,next:null},fr===null){if(rs===null)throw Error(i(308));fr=e,rs.dependencies={lanes:0,firstContext:e}}else fr=fr.next=e;return t}var Mn=null;function Ho(e){Mn===null?Mn=[e]:Mn.push(e)}function au(e,t,n,r){var l=t.interleaved;return l===null?(n.next=n,Ho(t)):(n.next=l.next,l.next=n),t.interleaved=n,Zt(e,r)}function Zt(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var gn=!1;function Vo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function uu(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function en(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function yn(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,(Pe&2)!==0){var l=r.pending;return l===null?t.next=t:(t.next=l.next,l.next=t),r.pending=t,Zt(e,n)}return l=r.interleaved,l===null?(t.next=t,Ho(r)):(t.next=l.next,l.next=t),r.interleaved=t,Zt(e,n)}function ls(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,ro(e,n)}}function cu(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var l=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var c={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?l=s=c:s=s.next=c,n=n.next}while(n!==null);s===null?l=s=t:s=s.next=t}else l=s=t;n={baseState:r.baseState,firstBaseUpdate:l,lastBaseUpdate:s,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function ss(e,t,n,r){var l=e.updateQueue;gn=!1;var s=l.firstBaseUpdate,c=l.lastBaseUpdate,g=l.shared.pending;if(g!==null){l.shared.pending=null;var x=g,F=x.next;x.next=null,c===null?s=F:c.next=F,c=x;var G=e.alternate;G!==null&&(G=G.updateQueue,g=G.lastBaseUpdate,g!==c&&(g===null?G.firstBaseUpdate=F:g.next=F,G.lastBaseUpdate=x))}if(s!==null){var Z=l.baseState;c=0,G=F=x=null,g=s;do{var K=g.lane,ue=g.eventTime;if((r&K)===K){G!==null&&(G=G.next={eventTime:ue,lane:0,tag:g.tag,payload:g.payload,callback:g.callback,next:null});e:{var de=e,fe=g;switch(K=t,ue=n,fe.tag){case 1:if(de=fe.payload,typeof de=="function"){Z=de.call(ue,Z,K);break e}Z=de;break e;case 3:de.flags=de.flags&-65537|128;case 0:if(de=fe.payload,K=typeof de=="function"?de.call(ue,Z,K):de,K==null)break e;Z=j({},Z,K);break e;case 2:gn=!0}}g.callback!==null&&g.lane!==0&&(e.flags|=64,K=l.effects,K===null?l.effects=[g]:K.push(g))}else ue={eventTime:ue,lane:K,tag:g.tag,payload:g.payload,callback:g.callback,next:null},G===null?(F=G=ue,x=Z):G=G.next=ue,c|=K;if(g=g.next,g===null){if(g=l.shared.pending,g===null)break;K=g,g=K.next,K.next=null,l.lastBaseUpdate=K,l.shared.pending=null}}while(!0);if(G===null&&(x=Z),l.baseState=x,l.firstBaseUpdate=F,l.lastBaseUpdate=G,t=l.shared.interleaved,t!==null){l=t;do c|=l.lane,l=l.next;while(l!==t)}else s===null&&(l.shared.lanes=0);An|=c,e.lanes=c,e.memoizedState=Z}}function du(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],l=r.callback;if(l!==null){if(r.callback=null,r=n,typeof l!="function")throw Error(i(191,l));l.call(r)}}}var el={},Ht=pn(el),tl=pn(el),nl=pn(el);function Fn(e){if(e===el)throw Error(i(174));return e}function Wo(e,t){switch(Le(nl,t),Le(tl,e),Le(Ht,el),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:jr(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=jr(t,e)}Me(Ht),Le(Ht,t)}function hr(){Me(Ht),Me(tl),Me(nl)}function fu(e){Fn(nl.current);var t=Fn(Ht.current),n=jr(t,e.type);t!==n&&(Le(tl,e),Le(Ht,n))}function Ko(e){tl.current===e&&(Me(Ht),Me(tl))}var Ue=pn(0);function os(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Qo=[];function Yo(){for(var e=0;e<Qo.length;e++)Qo[e]._workInProgressVersionPrimary=null;Qo.length=0}var is=O.ReactCurrentDispatcher,Go=O.ReactCurrentBatchConfig,$n=0,Be=null,Ge=null,Xe=null,as=!1,rl=!1,ll=0,xf=0;function rt(){throw Error(i(321))}function Jo(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Rt(e[n],t[n]))return!1;return!0}function Xo(e,t,n,r,l,s){if($n=s,Be=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,is.current=e===null||e.memoizedState===null?Sf:jf,e=n(r,l),rl){s=0;do{if(rl=!1,ll=0,25<=s)throw Error(i(301));s+=1,Xe=Ge=null,t.updateQueue=null,is.current=Cf,e=n(r,l)}while(rl)}if(is.current=ds,t=Ge!==null&&Ge.next!==null,$n=0,Xe=Ge=Be=null,as=!1,t)throw Error(i(300));return e}function qo(){var e=ll!==0;return ll=0,e}function Vt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xe===null?Be.memoizedState=Xe=e:Xe=Xe.next=e,Xe}function Pt(){if(Ge===null){var e=Be.alternate;e=e!==null?e.memoizedState:null}else e=Ge.next;var t=Xe===null?Be.memoizedState:Xe.next;if(t!==null)Xe=t,Ge=e;else{if(e===null)throw Error(i(310));Ge=e,e={memoizedState:Ge.memoizedState,baseState:Ge.baseState,baseQueue:Ge.baseQueue,queue:Ge.queue,next:null},Xe===null?Be.memoizedState=Xe=e:Xe=Xe.next=e}return Xe}function sl(e,t){return typeof t=="function"?t(e):t}function Zo(e){var t=Pt(),n=t.queue;if(n===null)throw Error(i(311));n.lastRenderedReducer=e;var r=Ge,l=r.baseQueue,s=n.pending;if(s!==null){if(l!==null){var c=l.next;l.next=s.next,s.next=c}r.baseQueue=l=s,n.pending=null}if(l!==null){s=l.next,r=r.baseState;var g=c=null,x=null,F=s;do{var G=F.lane;if(($n&G)===G)x!==null&&(x=x.next={lane:0,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null}),r=F.hasEagerState?F.eagerState:e(r,F.action);else{var Z={lane:G,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null};x===null?(g=x=Z,c=r):x=x.next=Z,Be.lanes|=G,An|=G}F=F.next}while(F!==null&&F!==s);x===null?c=r:x.next=g,Rt(r,t.memoizedState)||(dt=!0),t.memoizedState=r,t.baseState=c,t.baseQueue=x,n.lastRenderedState=r}if(e=n.interleaved,e!==null){l=e;do s=l.lane,Be.lanes|=s,An|=s,l=l.next;while(l!==e)}else l===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function ei(e){var t=Pt(),n=t.queue;if(n===null)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,l=n.pending,s=t.memoizedState;if(l!==null){n.pending=null;var c=l=l.next;do s=e(s,c.action),c=c.next;while(c!==l);Rt(s,t.memoizedState)||(dt=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function pu(){}function hu(e,t){var n=Be,r=Pt(),l=t(),s=!Rt(r.memoizedState,l);if(s&&(r.memoizedState=l,dt=!0),r=r.queue,ti(yu.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||Xe!==null&&Xe.memoizedState.tag&1){if(n.flags|=2048,ol(9,gu.bind(null,n,r,l,t),void 0,null),qe===null)throw Error(i(349));($n&30)!==0||mu(n,t,l)}return l}function mu(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Be.updateQueue,t===null?(t={lastEffect:null,stores:null},Be.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function gu(e,t,n,r){t.value=n,t.getSnapshot=r,vu(t)&&xu(e)}function yu(e,t,n){return n(function(){vu(t)&&xu(e)})}function vu(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Rt(e,n)}catch{return!0}}function xu(e){var t=Zt(e,1);t!==null&&Mt(t,e,1,-1)}function wu(e){var t=Vt();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:sl,lastRenderedState:e},t.queue=e,e=e.dispatch=Nf.bind(null,Be,e),[t.memoizedState,e]}function ol(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Be.updateQueue,t===null?(t={lastEffect:null,stores:null},Be.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function ku(){return Pt().memoizedState}function us(e,t,n,r){var l=Vt();Be.flags|=e,l.memoizedState=ol(1|t,n,void 0,r===void 0?null:r)}function cs(e,t,n,r){var l=Pt();r=r===void 0?null:r;var s=void 0;if(Ge!==null){var c=Ge.memoizedState;if(s=c.destroy,r!==null&&Jo(r,c.deps)){l.memoizedState=ol(t,n,s,r);return}}Be.flags|=e,l.memoizedState=ol(1|t,n,s,r)}function Nu(e,t){return us(8390656,8,e,t)}function ti(e,t){return cs(2048,8,e,t)}function Su(e,t){return cs(4,2,e,t)}function ju(e,t){return cs(4,4,e,t)}function Cu(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Eu(e,t,n){return n=n!=null?n.concat([e]):null,cs(4,4,Cu.bind(null,t,e),n)}function ni(){}function bu(e,t){var n=Pt();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Jo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Pu(e,t){var n=Pt();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Jo(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function _u(e,t,n){return($n&21)===0?(e.baseState&&(e.baseState=!1,dt=!0),e.memoizedState=n):(Rt(n,t)||(n=sa(),Be.lanes|=n,An|=n,e.baseState=!0),t)}function wf(e,t){var n=Te;Te=n!==0&&4>n?n:4,e(!0);var r=Go.transition;Go.transition={};try{e(!1),t()}finally{Te=n,Go.transition=r}}function Du(){return Pt().memoizedState}function kf(e,t,n){var r=kn(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Ou(e))Ru(t,n);else if(n=au(e,t,n,r),n!==null){var l=at();Mt(n,e,r,l),Tu(n,t,r)}}function Nf(e,t,n){var r=kn(e),l={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ou(e))Ru(t,l);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var c=t.lastRenderedState,g=s(c,n);if(l.hasEagerState=!0,l.eagerState=g,Rt(g,c)){var x=t.interleaved;x===null?(l.next=l,Ho(t)):(l.next=x.next,x.next=l),t.interleaved=l;return}}catch{}n=au(e,t,l,r),n!==null&&(l=at(),Mt(n,e,r,l),Tu(n,t,r))}}function Ou(e){var t=e.alternate;return e===Be||t!==null&&t===Be}function Ru(e,t){rl=as=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Tu(e,t,n){if((n&4194240)!==0){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,ro(e,n)}}var ds={readContext:bt,useCallback:rt,useContext:rt,useEffect:rt,useImperativeHandle:rt,useInsertionEffect:rt,useLayoutEffect:rt,useMemo:rt,useReducer:rt,useRef:rt,useState:rt,useDebugValue:rt,useDeferredValue:rt,useTransition:rt,useMutableSource:rt,useSyncExternalStore:rt,useId:rt,unstable_isNewReconciler:!1},Sf={readContext:bt,useCallback:function(e,t){return Vt().memoizedState=[e,t===void 0?null:t],e},useContext:bt,useEffect:Nu,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,us(4194308,4,Cu.bind(null,t,e),n)},useLayoutEffect:function(e,t){return us(4194308,4,e,t)},useInsertionEffect:function(e,t){return us(4,2,e,t)},useMemo:function(e,t){var n=Vt();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Vt();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=kf.bind(null,Be,e),[r.memoizedState,e]},useRef:function(e){var t=Vt();return e={current:e},t.memoizedState=e},useState:wu,useDebugValue:ni,useDeferredValue:function(e){return Vt().memoizedState=e},useTransition:function(){var e=wu(!1),t=e[0];return e=wf.bind(null,e[1]),Vt().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Be,l=Vt();if(Fe){if(n===void 0)throw Error(i(407));n=n()}else{if(n=t(),qe===null)throw Error(i(349));($n&30)!==0||mu(r,t,n)}l.memoizedState=n;var s={value:n,getSnapshot:t};return l.queue=s,Nu(yu.bind(null,r,s,e),[e]),r.flags|=2048,ol(9,gu.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=Vt(),t=qe.identifierPrefix;if(Fe){var n=qt,r=Xt;n=(r&~(1<<32-Ot(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=ll++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=xf++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},jf={readContext:bt,useCallback:bu,useContext:bt,useEffect:ti,useImperativeHandle:Eu,useInsertionEffect:Su,useLayoutEffect:ju,useMemo:Pu,useReducer:Zo,useRef:ku,useState:function(){return Zo(sl)},useDebugValue:ni,useDeferredValue:function(e){var t=Pt();return _u(t,Ge.memoizedState,e)},useTransition:function(){var e=Zo(sl)[0],t=Pt().memoizedState;return[e,t]},useMutableSource:pu,useSyncExternalStore:hu,useId:Du,unstable_isNewReconciler:!1},Cf={readContext:bt,useCallback:bu,useContext:bt,useEffect:ti,useImperativeHandle:Eu,useInsertionEffect:Su,useLayoutEffect:ju,useMemo:Pu,useReducer:ei,useRef:ku,useState:function(){return ei(sl)},useDebugValue:ni,useDeferredValue:function(e){var t=Pt();return Ge===null?t.memoizedState=e:_u(t,Ge.memoizedState,e)},useTransition:function(){var e=ei(sl)[0],t=Pt().memoizedState;return[e,t]},useMutableSource:pu,useSyncExternalStore:hu,useId:Du,unstable_isNewReconciler:!1};function Lt(e,t){if(e&&e.defaultProps){t=j({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function ri(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:j({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var fs={isMounted:function(e){return(e=e._reactInternals)?At(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=at(),l=kn(e),s=en(r,l);s.payload=t,n!=null&&(s.callback=n),t=yn(e,s,l),t!==null&&(Mt(t,e,l,r),ls(t,e,l))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=at(),l=kn(e),s=en(r,l);s.tag=1,s.payload=t,n!=null&&(s.callback=n),t=yn(e,s,l),t!==null&&(Mt(t,e,l,r),ls(t,e,l))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=at(),r=kn(e),l=en(n,r);l.tag=2,t!=null&&(l.callback=t),t=yn(e,l,r),t!==null&&(Mt(t,e,r,n),ls(t,e,r))}};function Lu(e,t,n,r,l,s,c){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,s,c):t.prototype&&t.prototype.isPureReactComponent?!Kr(n,r)||!Kr(l,s):!0}function zu(e,t,n){var r=!1,l=hn,s=t.contextType;return typeof s=="object"&&s!==null?s=bt(s):(l=ct(t)?Ln:nt.current,r=t.contextTypes,s=(r=r!=null)?ir(e,l):hn),t=new t(n,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=fs,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=l,e.__reactInternalMemoizedMaskedChildContext=s),t}function Iu(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&fs.enqueueReplaceState(t,t.state,null)}function li(e,t,n,r){var l=e.stateNode;l.props=n,l.state=e.memoizedState,l.refs={},Vo(e);var s=t.contextType;typeof s=="object"&&s!==null?l.context=bt(s):(s=ct(t)?Ln:nt.current,l.context=ir(e,s)),l.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(ri(e,t,s,n),l.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof l.getSnapshotBeforeUpdate=="function"||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(t=l.state,typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount(),t!==l.state&&fs.enqueueReplaceState(l,l.state,null),ss(e,n,l,r),l.state=e.memoizedState),typeof l.componentDidMount=="function"&&(e.flags|=4194308)}function mr(e,t){try{var n="",r=t;do n+=ie(r),r=r.return;while(r);var l=n}catch(s){l=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:l,digest:null}}function si(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function oi(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var Ef=typeof WeakMap=="function"?WeakMap:Map;function Mu(e,t,n){n=en(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){xs||(xs=!0,ki=r),oi(e,t)},n}function Fu(e,t,n){n=en(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var l=t.value;n.payload=function(){return r(l)},n.callback=function(){oi(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){oi(e,t),typeof r!="function"&&(xn===null?xn=new Set([this]):xn.add(this));var c=t.stack;this.componentDidCatch(t.value,{componentStack:c!==null?c:""})}),n}function $u(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new Ef;var l=new Set;r.set(t,l)}else l=r.get(t),l===void 0&&(l=new Set,r.set(t,l));l.has(n)||(l.add(n),e=Af.bind(null,e,t,n),t.then(e,e))}function Au(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Uu(e,t,n,r,l){return(e.mode&1)===0?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=en(-1,1),t.tag=2,yn(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=l,e)}var bf=O.ReactCurrentOwner,dt=!1;function it(e,t,n,r){t.child=e===null?iu(t,null,n,r):dr(t,e.child,n,r)}function Bu(e,t,n,r,l){n=n.render;var s=t.ref;return pr(t,l),r=Xo(e,t,n,r,s,l),n=qo(),e!==null&&!dt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~l,tn(e,t,l)):(Fe&&n&&Lo(t),t.flags|=1,it(e,t,r,l),t.child)}function Hu(e,t,n,r,l){if(e===null){var s=n.type;return typeof s=="function"&&!Pi(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=s,Vu(e,t,s,r,l)):(e=Cs(n.type,null,r,t,t.mode,l),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,(e.lanes&l)===0){var c=s.memoizedProps;if(n=n.compare,n=n!==null?n:Kr,n(c,r)&&e.ref===t.ref)return tn(e,t,l)}return t.flags|=1,e=Sn(s,r),e.ref=t.ref,e.return=t,t.child=e}function Vu(e,t,n,r,l){if(e!==null){var s=e.memoizedProps;if(Kr(s,r)&&e.ref===t.ref)if(dt=!1,t.pendingProps=r=s,(e.lanes&l)!==0)(e.flags&131072)!==0&&(dt=!0);else return t.lanes=e.lanes,tn(e,t,l)}return ii(e,t,n,r,l)}function Wu(e,t,n){var r=t.pendingProps,l=r.children,s=e!==null?e.memoizedState:null;if(r.mode==="hidden")if((t.mode&1)===0)t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Le(yr,kt),kt|=n;else{if((n&1073741824)===0)return e=s!==null?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Le(yr,kt),kt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Le(yr,kt),kt|=r}else s!==null?(r=s.baseLanes|n,t.memoizedState=null):r=n,Le(yr,kt),kt|=r;return it(e,t,l,n),t.child}function Ku(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function ii(e,t,n,r,l){var s=ct(n)?Ln:nt.current;return s=ir(t,s),pr(t,l),n=Xo(e,t,n,r,s,l),r=qo(),e!==null&&!dt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~l,tn(e,t,l)):(Fe&&r&&Lo(t),t.flags|=1,it(e,t,n,l),t.child)}function Qu(e,t,n,r,l){if(ct(n)){var s=!0;Jl(t)}else s=!1;if(pr(t,l),t.stateNode===null)hs(e,t),zu(t,n,r),li(t,n,r,l),r=!0;else if(e===null){var c=t.stateNode,g=t.memoizedProps;c.props=g;var x=c.context,F=n.contextType;typeof F=="object"&&F!==null?F=bt(F):(F=ct(n)?Ln:nt.current,F=ir(t,F));var G=n.getDerivedStateFromProps,Z=typeof G=="function"||typeof c.getSnapshotBeforeUpdate=="function";Z||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(g!==r||x!==F)&&Iu(t,c,r,F),gn=!1;var K=t.memoizedState;c.state=K,ss(t,r,c,l),x=t.memoizedState,g!==r||K!==x||ut.current||gn?(typeof G=="function"&&(ri(t,n,G,r),x=t.memoizedState),(g=gn||Lu(t,n,g,r,K,x,F))?(Z||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount()),typeof c.componentDidMount=="function"&&(t.flags|=4194308)):(typeof c.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=x),c.props=r,c.state=x,c.context=F,r=g):(typeof c.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{c=t.stateNode,uu(e,t),g=t.memoizedProps,F=t.type===t.elementType?g:Lt(t.type,g),c.props=F,Z=t.pendingProps,K=c.context,x=n.contextType,typeof x=="object"&&x!==null?x=bt(x):(x=ct(n)?Ln:nt.current,x=ir(t,x));var ue=n.getDerivedStateFromProps;(G=typeof ue=="function"||typeof c.getSnapshotBeforeUpdate=="function")||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(g!==Z||K!==x)&&Iu(t,c,r,x),gn=!1,K=t.memoizedState,c.state=K,ss(t,r,c,l);var de=t.memoizedState;g!==Z||K!==de||ut.current||gn?(typeof ue=="function"&&(ri(t,n,ue,r),de=t.memoizedState),(F=gn||Lu(t,n,F,r,K,de,x)||!1)?(G||typeof c.UNSAFE_componentWillUpdate!="function"&&typeof c.componentWillUpdate!="function"||(typeof c.componentWillUpdate=="function"&&c.componentWillUpdate(r,de,x),typeof c.UNSAFE_componentWillUpdate=="function"&&c.UNSAFE_componentWillUpdate(r,de,x)),typeof c.componentDidUpdate=="function"&&(t.flags|=4),typeof c.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof c.componentDidUpdate!="function"||g===e.memoizedProps&&K===e.memoizedState||(t.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||g===e.memoizedProps&&K===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=de),c.props=r,c.state=de,c.context=x,r=F):(typeof c.componentDidUpdate!="function"||g===e.memoizedProps&&K===e.memoizedState||(t.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||g===e.memoizedProps&&K===e.memoizedState||(t.flags|=1024),r=!1)}return ai(e,t,n,r,s,l)}function ai(e,t,n,r,l,s){Ku(e,t);var c=(t.flags&128)!==0;if(!r&&!c)return l&&qa(t,n,!1),tn(e,t,s);r=t.stateNode,bf.current=t;var g=c&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&c?(t.child=dr(t,e.child,null,s),t.child=dr(t,null,g,s)):it(e,t,g,s),t.memoizedState=r.state,l&&qa(t,n,!0),t.child}function Yu(e){var t=e.stateNode;t.pendingContext?Ja(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Ja(e,t.context,!1),Wo(e,t.containerInfo)}function Gu(e,t,n,r,l){return cr(),Fo(l),t.flags|=256,it(e,t,n,r),t.child}var ui={dehydrated:null,treeContext:null,retryLane:0};function ci(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ju(e,t,n){var r=t.pendingProps,l=Ue.current,s=!1,c=(t.flags&128)!==0,g;if((g=c)||(g=e!==null&&e.memoizedState===null?!1:(l&2)!==0),g?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(l|=1),Le(Ue,l&1),e===null)return Mo(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((t.mode&1)===0?t.lanes=1:e.data==="$!"?t.lanes=8:t.lanes=1073741824,null):(c=r.children,e=r.fallback,s?(r=t.mode,s=t.child,c={mode:"hidden",children:c},(r&1)===0&&s!==null?(s.childLanes=0,s.pendingProps=c):s=Es(c,r,0,null),e=Vn(e,r,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=ci(n),t.memoizedState=ui,e):di(t,c));if(l=e.memoizedState,l!==null&&(g=l.dehydrated,g!==null))return Pf(e,t,c,r,g,l,n);if(s){s=r.fallback,c=t.mode,l=e.child,g=l.sibling;var x={mode:"hidden",children:r.children};return(c&1)===0&&t.child!==l?(r=t.child,r.childLanes=0,r.pendingProps=x,t.deletions=null):(r=Sn(l,x),r.subtreeFlags=l.subtreeFlags&14680064),g!==null?s=Sn(g,s):(s=Vn(s,c,n,null),s.flags|=2),s.return=t,r.return=t,r.sibling=s,t.child=r,r=s,s=t.child,c=e.child.memoizedState,c=c===null?ci(n):{baseLanes:c.baseLanes|n,cachePool:null,transitions:c.transitions},s.memoizedState=c,s.childLanes=e.childLanes&~n,t.memoizedState=ui,r}return s=e.child,e=s.sibling,r=Sn(s,{mode:"visible",children:r.children}),(t.mode&1)===0&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function di(e,t){return t=Es({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function ps(e,t,n,r){return r!==null&&Fo(r),dr(t,e.child,null,n),e=di(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Pf(e,t,n,r,l,s,c){if(n)return t.flags&256?(t.flags&=-257,r=si(Error(i(422))),ps(e,t,c,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=r.fallback,l=t.mode,r=Es({mode:"visible",children:r.children},l,0,null),s=Vn(s,l,c,null),s.flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,(t.mode&1)!==0&&dr(t,e.child,null,c),t.child.memoizedState=ci(c),t.memoizedState=ui,s);if((t.mode&1)===0)return ps(e,t,c,null);if(l.data==="$!"){if(r=l.nextSibling&&l.nextSibling.dataset,r)var g=r.dgst;return r=g,s=Error(i(419)),r=si(s,r,void 0),ps(e,t,c,r)}if(g=(c&e.childLanes)!==0,dt||g){if(r=qe,r!==null){switch(c&-c){case 4:l=2;break;case 16:l=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:l=32;break;case 536870912:l=268435456;break;default:l=0}l=(l&(r.suspendedLanes|c))!==0?0:l,l!==0&&l!==s.retryLane&&(s.retryLane=l,Zt(e,l),Mt(r,e,l,-1))}return bi(),r=si(Error(i(421))),ps(e,t,c,r)}return l.data==="$?"?(t.flags|=128,t.child=e.child,t=Uf.bind(null,e),l._reactRetry=t,null):(e=s.treeContext,wt=fn(l.nextSibling),xt=t,Fe=!0,Tt=null,e!==null&&(Ct[Et++]=Xt,Ct[Et++]=qt,Ct[Et++]=zn,Xt=e.id,qt=e.overflow,zn=t),t=di(t,r.children),t.flags|=4096,t)}function Xu(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Bo(e.return,t,n)}function fi(e,t,n,r,l){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:l}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=l)}function qu(e,t,n){var r=t.pendingProps,l=r.revealOrder,s=r.tail;if(it(e,t,r.children,n),r=Ue.current,(r&2)!==0)r=r&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Xu(e,n,t);else if(e.tag===19)Xu(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Le(Ue,r),(t.mode&1)===0)t.memoizedState=null;else switch(l){case"forwards":for(n=t.child,l=null;n!==null;)e=n.alternate,e!==null&&os(e)===null&&(l=n),n=n.sibling;n=l,n===null?(l=t.child,t.child=null):(l=n.sibling,n.sibling=null),fi(t,!1,l,n,s);break;case"backwards":for(n=null,l=t.child,t.child=null;l!==null;){if(e=l.alternate,e!==null&&os(e)===null){t.child=l;break}e=l.sibling,l.sibling=n,n=l,l=e}fi(t,!0,n,null,s);break;case"together":fi(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function hs(e,t){(t.mode&1)===0&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function tn(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),An|=t.lanes,(n&t.childLanes)===0)return null;if(e!==null&&t.child!==e.child)throw Error(i(153));if(t.child!==null){for(e=t.child,n=Sn(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Sn(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function _f(e,t,n){switch(t.tag){case 3:Yu(t),cr();break;case 5:fu(t);break;case 1:ct(t.type)&&Jl(t);break;case 4:Wo(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,l=t.memoizedProps.value;Le(ns,r._currentValue),r._currentValue=l;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Le(Ue,Ue.current&1),t.flags|=128,null):(n&t.child.childLanes)!==0?Ju(e,t,n):(Le(Ue,Ue.current&1),e=tn(e,t,n),e!==null?e.sibling:null);Le(Ue,Ue.current&1);break;case 19:if(r=(n&t.childLanes)!==0,(e.flags&128)!==0){if(r)return qu(e,t,n);t.flags|=128}if(l=t.memoizedState,l!==null&&(l.rendering=null,l.tail=null,l.lastEffect=null),Le(Ue,Ue.current),r)break;return null;case 22:case 23:return t.lanes=0,Wu(e,t,n)}return tn(e,t,n)}var Zu,pi,ec,tc;Zu=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},pi=function(){},ec=function(e,t,n,r){var l=e.memoizedProps;if(l!==r){e=t.stateNode,Fn(Ht.current);var s=null;switch(n){case"input":l=Ee(e,l),r=Ee(e,r),s=[];break;case"select":l=j({},l,{value:void 0}),r=j({},r,{value:void 0}),s=[];break;case"textarea":l=We(e,l),r=We(e,r),s=[];break;default:typeof l.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Ql)}Dn(n,r);var c;n=null;for(F in l)if(!r.hasOwnProperty(F)&&l.hasOwnProperty(F)&&l[F]!=null)if(F==="style"){var g=l[F];for(c in g)g.hasOwnProperty(c)&&(n||(n={}),n[c]="")}else F!=="dangerouslySetInnerHTML"&&F!=="children"&&F!=="suppressContentEditableWarning"&&F!=="suppressHydrationWarning"&&F!=="autoFocus"&&(d.hasOwnProperty(F)?s||(s=[]):(s=s||[]).push(F,null));for(F in r){var x=r[F];if(g=l?.[F],r.hasOwnProperty(F)&&x!==g&&(x!=null||g!=null))if(F==="style")if(g){for(c in g)!g.hasOwnProperty(c)||x&&x.hasOwnProperty(c)||(n||(n={}),n[c]="");for(c in x)x.hasOwnProperty(c)&&g[c]!==x[c]&&(n||(n={}),n[c]=x[c])}else n||(s||(s=[]),s.push(F,n)),n=x;else F==="dangerouslySetInnerHTML"?(x=x?x.__html:void 0,g=g?g.__html:void 0,x!=null&&g!==x&&(s=s||[]).push(F,x)):F==="children"?typeof x!="string"&&typeof x!="number"||(s=s||[]).push(F,""+x):F!=="suppressContentEditableWarning"&&F!=="suppressHydrationWarning"&&(d.hasOwnProperty(F)?(x!=null&&F==="onScroll"&&Ie("scroll",e),s||g===x||(s=[])):(s=s||[]).push(F,x))}n&&(s=s||[]).push("style",n);var F=s;(t.updateQueue=F)&&(t.flags|=4)}},tc=function(e,t,n,r){n!==r&&(t.flags|=4)};function il(e,t){if(!Fe)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function lt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var l=e.child;l!==null;)n|=l.lanes|l.childLanes,r|=l.subtreeFlags&14680064,r|=l.flags&14680064,l.return=e,l=l.sibling;else for(l=e.child;l!==null;)n|=l.lanes|l.childLanes,r|=l.subtreeFlags,r|=l.flags,l.return=e,l=l.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Df(e,t,n){var r=t.pendingProps;switch(zo(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return lt(t),null;case 1:return ct(t.type)&&Gl(),lt(t),null;case 3:return r=t.stateNode,hr(),Me(ut),Me(nt),Yo(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(es(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Tt!==null&&(ji(Tt),Tt=null))),pi(e,t),lt(t),null;case 5:Ko(t);var l=Fn(nl.current);if(n=t.type,e!==null&&t.stateNode!=null)ec(e,t,n,r,l),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(i(166));return lt(t),null}if(e=Fn(Ht.current),es(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[Bt]=t,r[Xr]=s,e=(t.mode&1)!==0,n){case"dialog":Ie("cancel",r),Ie("close",r);break;case"iframe":case"object":case"embed":Ie("load",r);break;case"video":case"audio":for(l=0;l<Yr.length;l++)Ie(Yr[l],r);break;case"source":Ie("error",r);break;case"img":case"image":case"link":Ie("error",r),Ie("load",r);break;case"details":Ie("toggle",r);break;case"input":De(r,s),Ie("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Ie("invalid",r);break;case"textarea":$e(r,s),Ie("invalid",r)}Dn(n,s),l=null;for(var c in s)if(s.hasOwnProperty(c)){var g=s[c];c==="children"?typeof g=="string"?r.textContent!==g&&(s.suppressHydrationWarning!==!0&&Kl(r.textContent,g,e),l=["children",g]):typeof g=="number"&&r.textContent!==""+g&&(s.suppressHydrationWarning!==!0&&Kl(r.textContent,g,e),l=["children",""+g]):d.hasOwnProperty(c)&&g!=null&&c==="onScroll"&&Ie("scroll",r)}switch(n){case"input":Ne(r),Oe(r,s,!0);break;case"textarea":Ne(r),vl(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Ql)}r=l,t.updateQueue=r,r!==null&&(t.flags|=4)}else{c=l.nodeType===9?l:l.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Sr(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=c.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=c.createElement(n,{is:r.is}):(e=c.createElement(n),n==="select"&&(c=e,r.multiple?c.multiple=!0:r.size&&(c.size=r.size))):e=c.createElementNS(e,n),e[Bt]=t,e[Xr]=r,Zu(e,t,!1,!1),t.stateNode=e;e:{switch(c=Cr(n,r),n){case"dialog":Ie("cancel",e),Ie("close",e),l=r;break;case"iframe":case"object":case"embed":Ie("load",e),l=r;break;case"video":case"audio":for(l=0;l<Yr.length;l++)Ie(Yr[l],e);l=r;break;case"source":Ie("error",e),l=r;break;case"img":case"image":case"link":Ie("error",e),Ie("load",e),l=r;break;case"details":Ie("toggle",e),l=r;break;case"input":De(e,r),l=Ee(e,r),Ie("invalid",e);break;case"option":l=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},l=j({},r,{value:void 0}),Ie("invalid",e);break;case"textarea":$e(e,r),l=We(e,r),Ie("invalid",e);break;default:l=r}Dn(n,l),g=l;for(s in g)if(g.hasOwnProperty(s)){var x=g[s];s==="style"?kl(e,x):s==="dangerouslySetInnerHTML"?(x=x?x.__html:void 0,x!=null&&xl(e,x)):s==="children"?typeof x=="string"?(n!=="textarea"||x!=="")&&Pn(e,x):typeof x=="number"&&Pn(e,""+x):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(d.hasOwnProperty(s)?x!=null&&s==="onScroll"&&Ie("scroll",e):x!=null&&le(e,s,x,c))}switch(n){case"input":Ne(e),Oe(e,r,!1);break;case"textarea":Ne(e),vl(e);break;case"option":r.value!=null&&e.setAttribute("value",""+ve(r.value));break;case"select":e.multiple=!!r.multiple,s=r.value,s!=null?ot(e,!!r.multiple,s,!1):r.defaultValue!=null&&ot(e,!!r.multiple,r.defaultValue,!0);break;default:typeof l.onClick=="function"&&(e.onclick=Ql)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return lt(t),null;case 6:if(e&&t.stateNode!=null)tc(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(i(166));if(n=Fn(nl.current),Fn(Ht.current),es(t)){if(r=t.stateNode,n=t.memoizedProps,r[Bt]=t,(s=r.nodeValue!==n)&&(e=xt,e!==null))switch(e.tag){case 3:Kl(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Kl(r.nodeValue,n,(e.mode&1)!==0)}s&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Bt]=t,t.stateNode=r}return lt(t),null;case 13:if(Me(Ue),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Fe&&wt!==null&&(t.mode&1)!==0&&(t.flags&128)===0)lu(),cr(),t.flags|=98560,s=!1;else if(s=es(t),r!==null&&r.dehydrated!==null){if(e===null){if(!s)throw Error(i(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));s[Bt]=t}else cr(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;lt(t),s=!1}else Tt!==null&&(ji(Tt),Tt=null),s=!0;if(!s)return t.flags&65536?t:null}return(t.flags&128)!==0?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,(t.mode&1)!==0&&(e===null||(Ue.current&1)!==0?Je===0&&(Je=3):bi())),t.updateQueue!==null&&(t.flags|=4),lt(t),null);case 4:return hr(),pi(e,t),e===null&&Gr(t.stateNode.containerInfo),lt(t),null;case 10:return Uo(t.type._context),lt(t),null;case 17:return ct(t.type)&&Gl(),lt(t),null;case 19:if(Me(Ue),s=t.memoizedState,s===null)return lt(t),null;if(r=(t.flags&128)!==0,c=s.rendering,c===null)if(r)il(s,!1);else{if(Je!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(c=os(e),c!==null){for(t.flags|=128,il(s,!1),r=c.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)s=n,e=r,s.flags&=14680066,c=s.alternate,c===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=c.childLanes,s.lanes=c.lanes,s.child=c.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=c.memoizedProps,s.memoizedState=c.memoizedState,s.updateQueue=c.updateQueue,s.type=c.type,e=c.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Le(Ue,Ue.current&1|2),t.child}e=e.sibling}s.tail!==null&&Ae()>vr&&(t.flags|=128,r=!0,il(s,!1),t.lanes=4194304)}else{if(!r)if(e=os(c),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),il(s,!0),s.tail===null&&s.tailMode==="hidden"&&!c.alternate&&!Fe)return lt(t),null}else 2*Ae()-s.renderingStartTime>vr&&n!==1073741824&&(t.flags|=128,r=!0,il(s,!1),t.lanes=4194304);s.isBackwards?(c.sibling=t.child,t.child=c):(n=s.last,n!==null?n.sibling=c:t.child=c,s.last=c)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Ae(),t.sibling=null,n=Ue.current,Le(Ue,r?n&1|2:n&1),t):(lt(t),null);case 22:case 23:return Ei(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&(t.mode&1)!==0?(kt&1073741824)!==0&&(lt(t),t.subtreeFlags&6&&(t.flags|=8192)):lt(t),null;case 24:return null;case 25:return null}throw Error(i(156,t.tag))}function Of(e,t){switch(zo(t),t.tag){case 1:return ct(t.type)&&Gl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return hr(),Me(ut),Me(nt),Yo(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 5:return Ko(t),null;case 13:if(Me(Ue),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(i(340));cr()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Me(Ue),null;case 4:return hr(),null;case 10:return Uo(t.type._context),null;case 22:case 23:return Ei(),null;case 24:return null;default:return null}}var ms=!1,st=!1,Rf=typeof WeakSet=="function"?WeakSet:Set,ce=null;function gr(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){He(e,t,r)}else n.current=null}function hi(e,t,n){try{n()}catch(r){He(e,t,r)}}var nc=!1;function Tf(e,t){if(Eo=zl,e=La(),vo(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var l=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var c=0,g=-1,x=-1,F=0,G=0,Z=e,K=null;t:for(;;){for(var ue;Z!==n||l!==0&&Z.nodeType!==3||(g=c+l),Z!==s||r!==0&&Z.nodeType!==3||(x=c+r),Z.nodeType===3&&(c+=Z.nodeValue.length),(ue=Z.firstChild)!==null;)K=Z,Z=ue;for(;;){if(Z===e)break t;if(K===n&&++F===l&&(g=c),K===s&&++G===r&&(x=c),(ue=Z.nextSibling)!==null)break;Z=K,K=Z.parentNode}Z=ue}n=g===-1||x===-1?null:{start:g,end:x}}else n=null}n=n||{start:0,end:0}}else n=null;for(bo={focusedElem:e,selectionRange:n},zl=!1,ce=t;ce!==null;)if(t=ce,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ce=e;else for(;ce!==null;){t=ce;try{var de=t.alternate;if((t.flags&1024)!==0)switch(t.tag){case 0:case 11:case 15:break;case 1:if(de!==null){var fe=de.memoizedProps,Ve=de.memoizedState,_=t.stateNode,N=_.getSnapshotBeforeUpdate(t.elementType===t.type?fe:Lt(t.type,fe),Ve);_.__reactInternalSnapshotBeforeUpdate=N}break;case 3:var T=t.stateNode.containerInfo;T.nodeType===1?T.textContent="":T.nodeType===9&&T.documentElement&&T.removeChild(T.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(i(163))}}catch(ne){He(t,t.return,ne)}if(e=t.sibling,e!==null){e.return=t.return,ce=e;break}ce=t.return}return de=nc,nc=!1,de}function al(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var l=r=r.next;do{if((l.tag&e)===e){var s=l.destroy;l.destroy=void 0,s!==void 0&&hi(t,n,s)}l=l.next}while(l!==r)}}function gs(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function mi(e){var t=e.ref;if(t!==null){var n=e.stateNode;e.tag,e=n,typeof t=="function"?t(e):t.current=e}}function rc(e){var t=e.alternate;t!==null&&(e.alternate=null,rc(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Bt],delete t[Xr],delete t[Oo],delete t[mf],delete t[gf])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function lc(e){return e.tag===5||e.tag===3||e.tag===4}function sc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||lc(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function gi(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Ql));else if(r!==4&&(e=e.child,e!==null))for(gi(e,t,n),e=e.sibling;e!==null;)gi(e,t,n),e=e.sibling}function yi(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(yi(e,t,n),e=e.sibling;e!==null;)yi(e,t,n),e=e.sibling}var et=null,zt=!1;function vn(e,t,n){for(n=n.child;n!==null;)oc(e,t,n),n=n.sibling}function oc(e,t,n){if(Ut&&typeof Ut.onCommitFiberUnmount=="function")try{Ut.onCommitFiberUnmount(_l,n)}catch{}switch(n.tag){case 5:st||gr(n,t);case 6:var r=et,l=zt;et=null,vn(e,t,n),et=r,zt=l,et!==null&&(zt?(e=et,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):et.removeChild(n.stateNode));break;case 18:et!==null&&(zt?(e=et,n=n.stateNode,e.nodeType===8?Do(e.parentNode,n):e.nodeType===1&&Do(e,n),Ar(e)):Do(et,n.stateNode));break;case 4:r=et,l=zt,et=n.stateNode.containerInfo,zt=!0,vn(e,t,n),et=r,zt=l;break;case 0:case 11:case 14:case 15:if(!st&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){l=r=r.next;do{var s=l,c=s.destroy;s=s.tag,c!==void 0&&((s&2)!==0||(s&4)!==0)&&hi(n,t,c),l=l.next}while(l!==r)}vn(e,t,n);break;case 1:if(!st&&(gr(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(g){He(n,t,g)}vn(e,t,n);break;case 21:vn(e,t,n);break;case 22:n.mode&1?(st=(r=st)||n.memoizedState!==null,vn(e,t,n),st=r):vn(e,t,n);break;default:vn(e,t,n)}}function ic(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Rf),t.forEach(function(r){var l=Bf.bind(null,e,r);n.has(r)||(n.add(r),r.then(l,l))})}}function It(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var l=n[r];try{var s=e,c=t,g=c;e:for(;g!==null;){switch(g.tag){case 5:et=g.stateNode,zt=!1;break e;case 3:et=g.stateNode.containerInfo,zt=!0;break e;case 4:et=g.stateNode.containerInfo,zt=!0;break e}g=g.return}if(et===null)throw Error(i(160));oc(s,c,l),et=null,zt=!1;var x=l.alternate;x!==null&&(x.return=null),l.return=null}catch(F){He(l,t,F)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)ac(t,e),t=t.sibling}function ac(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(It(t,e),Wt(e),r&4){try{al(3,e,e.return),gs(3,e)}catch(fe){He(e,e.return,fe)}try{al(5,e,e.return)}catch(fe){He(e,e.return,fe)}}break;case 1:It(t,e),Wt(e),r&512&&n!==null&&gr(n,n.return);break;case 5:if(It(t,e),Wt(e),r&512&&n!==null&&gr(n,n.return),e.flags&32){var l=e.stateNode;try{Pn(l,"")}catch(fe){He(e,e.return,fe)}}if(r&4&&(l=e.stateNode,l!=null)){var s=e.memoizedProps,c=n!==null?n.memoizedProps:s,g=e.type,x=e.updateQueue;if(e.updateQueue=null,x!==null)try{g==="input"&&s.type==="radio"&&s.name!=null&&je(l,s),Cr(g,c);var F=Cr(g,s);for(c=0;c<x.length;c+=2){var G=x[c],Z=x[c+1];G==="style"?kl(l,Z):G==="dangerouslySetInnerHTML"?xl(l,Z):G==="children"?Pn(l,Z):le(l,G,Z,F)}switch(g){case"input":be(l,s);break;case"textarea":yl(l,s);break;case"select":var K=l._wrapperState.wasMultiple;l._wrapperState.wasMultiple=!!s.multiple;var ue=s.value;ue!=null?ot(l,!!s.multiple,ue,!1):K!==!!s.multiple&&(s.defaultValue!=null?ot(l,!!s.multiple,s.defaultValue,!0):ot(l,!!s.multiple,s.multiple?[]:"",!1))}l[Xr]=s}catch(fe){He(e,e.return,fe)}}break;case 6:if(It(t,e),Wt(e),r&4){if(e.stateNode===null)throw Error(i(162));l=e.stateNode,s=e.memoizedProps;try{l.nodeValue=s}catch(fe){He(e,e.return,fe)}}break;case 3:if(It(t,e),Wt(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ar(t.containerInfo)}catch(fe){He(e,e.return,fe)}break;case 4:It(t,e),Wt(e);break;case 13:It(t,e),Wt(e),l=e.child,l.flags&8192&&(s=l.memoizedState!==null,l.stateNode.isHidden=s,!s||l.alternate!==null&&l.alternate.memoizedState!==null||(wi=Ae())),r&4&&ic(e);break;case 22:if(G=n!==null&&n.memoizedState!==null,e.mode&1?(st=(F=st)||G,It(t,e),st=F):It(t,e),Wt(e),r&8192){if(F=e.memoizedState!==null,(e.stateNode.isHidden=F)&&!G&&(e.mode&1)!==0)for(ce=e,G=e.child;G!==null;){for(Z=ce=G;ce!==null;){switch(K=ce,ue=K.child,K.tag){case 0:case 11:case 14:case 15:al(4,K,K.return);break;case 1:gr(K,K.return);var de=K.stateNode;if(typeof de.componentWillUnmount=="function"){r=K,n=K.return;try{t=r,de.props=t.memoizedProps,de.state=t.memoizedState,de.componentWillUnmount()}catch(fe){He(r,n,fe)}}break;case 5:gr(K,K.return);break;case 22:if(K.memoizedState!==null){dc(Z);continue}}ue!==null?(ue.return=K,ce=ue):dc(Z)}G=G.sibling}e:for(G=null,Z=e;;){if(Z.tag===5){if(G===null){G=Z;try{l=Z.stateNode,F?(s=l.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(g=Z.stateNode,x=Z.memoizedProps.style,c=x!=null&&x.hasOwnProperty("display")?x.display:null,g.style.display=wl("display",c))}catch(fe){He(e,e.return,fe)}}}else if(Z.tag===6){if(G===null)try{Z.stateNode.nodeValue=F?"":Z.memoizedProps}catch(fe){He(e,e.return,fe)}}else if((Z.tag!==22&&Z.tag!==23||Z.memoizedState===null||Z===e)&&Z.child!==null){Z.child.return=Z,Z=Z.child;continue}if(Z===e)break e;for(;Z.sibling===null;){if(Z.return===null||Z.return===e)break e;G===Z&&(G=null),Z=Z.return}G===Z&&(G=null),Z.sibling.return=Z.return,Z=Z.sibling}}break;case 19:It(t,e),Wt(e),r&4&&ic(e);break;case 21:break;default:It(t,e),Wt(e)}}function Wt(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(lc(n)){var r=n;break e}n=n.return}throw Error(i(160))}switch(r.tag){case 5:var l=r.stateNode;r.flags&32&&(Pn(l,""),r.flags&=-33);var s=sc(e);yi(e,s,l);break;case 3:case 4:var c=r.stateNode.containerInfo,g=sc(e);gi(e,g,c);break;default:throw Error(i(161))}}catch(x){He(e,e.return,x)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Lf(e,t,n){ce=e,uc(e)}function uc(e,t,n){for(var r=(e.mode&1)!==0;ce!==null;){var l=ce,s=l.child;if(l.tag===22&&r){var c=l.memoizedState!==null||ms;if(!c){var g=l.alternate,x=g!==null&&g.memoizedState!==null||st;g=ms;var F=st;if(ms=c,(st=x)&&!F)for(ce=l;ce!==null;)c=ce,x=c.child,c.tag===22&&c.memoizedState!==null?fc(l):x!==null?(x.return=c,ce=x):fc(l);for(;s!==null;)ce=s,uc(s),s=s.sibling;ce=l,ms=g,st=F}cc(e)}else(l.subtreeFlags&8772)!==0&&s!==null?(s.return=l,ce=s):cc(e)}}function cc(e){for(;ce!==null;){var t=ce;if((t.flags&8772)!==0){var n=t.alternate;try{if((t.flags&8772)!==0)switch(t.tag){case 0:case 11:case 15:st||gs(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!st)if(n===null)r.componentDidMount();else{var l=t.elementType===t.type?n.memoizedProps:Lt(t.type,n.memoizedProps);r.componentDidUpdate(l,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&du(t,s,r);break;case 3:var c=t.updateQueue;if(c!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}du(t,c,n)}break;case 5:var g=t.stateNode;if(n===null&&t.flags&4){n=g;var x=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":x.autoFocus&&n.focus();break;case"img":x.src&&(n.src=x.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var F=t.alternate;if(F!==null){var G=F.memoizedState;if(G!==null){var Z=G.dehydrated;Z!==null&&Ar(Z)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(i(163))}st||t.flags&512&&mi(t)}catch(K){He(t,t.return,K)}}if(t===e){ce=null;break}if(n=t.sibling,n!==null){n.return=t.return,ce=n;break}ce=t.return}}function dc(e){for(;ce!==null;){var t=ce;if(t===e){ce=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ce=n;break}ce=t.return}}function fc(e){for(;ce!==null;){var t=ce;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{gs(4,t)}catch(x){He(t,n,x)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var l=t.return;try{r.componentDidMount()}catch(x){He(t,l,x)}}var s=t.return;try{mi(t)}catch(x){He(t,s,x)}break;case 5:var c=t.return;try{mi(t)}catch(x){He(t,c,x)}}}catch(x){He(t,t.return,x)}if(t===e){ce=null;break}var g=t.sibling;if(g!==null){g.return=t.return,ce=g;break}ce=t.return}}var zf=Math.ceil,ys=O.ReactCurrentDispatcher,vi=O.ReactCurrentOwner,_t=O.ReactCurrentBatchConfig,Pe=0,qe=null,Qe=null,tt=0,kt=0,yr=pn(0),Je=0,ul=null,An=0,vs=0,xi=0,cl=null,ft=null,wi=0,vr=1/0,nn=null,xs=!1,ki=null,xn=null,ws=!1,wn=null,ks=0,dl=0,Ni=null,Ns=-1,Ss=0;function at(){return(Pe&6)!==0?Ae():Ns!==-1?Ns:Ns=Ae()}function kn(e){return(e.mode&1)===0?1:(Pe&2)!==0&&tt!==0?tt&-tt:vf.transition!==null?(Ss===0&&(Ss=sa()),Ss):(e=Te,e!==0||(e=window.event,e=e===void 0?16:ha(e.type)),e)}function Mt(e,t,n,r){if(50<dl)throw dl=0,Ni=null,Error(i(185));zr(e,n,r),((Pe&2)===0||e!==qe)&&(e===qe&&((Pe&2)===0&&(vs|=n),Je===4&&Nn(e,tt)),pt(e,r),n===1&&Pe===0&&(t.mode&1)===0&&(vr=Ae()+500,Xl&&mn()))}function pt(e,t){var n=e.callbackNode;yd(e,t);var r=Rl(e,e===qe?tt:0);if(r===0)n!==null&&Re(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Re(n),t===1)e.tag===0?yf(hc.bind(null,e)):Za(hc.bind(null,e)),pf(function(){(Pe&6)===0&&mn()}),n=null;else{switch(oa(r)){case 1:n=eo;break;case 4:n=ra;break;case 16:n=Pl;break;case 536870912:n=la;break;default:n=Pl}n=Nc(n,pc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function pc(e,t){if(Ns=-1,Ss=0,(Pe&6)!==0)throw Error(i(327));var n=e.callbackNode;if(xr()&&e.callbackNode!==n)return null;var r=Rl(e,e===qe?tt:0);if(r===0)return null;if((r&30)!==0||(r&e.expiredLanes)!==0||t)t=js(e,r);else{t=r;var l=Pe;Pe|=2;var s=gc();(qe!==e||tt!==t)&&(nn=null,vr=Ae()+500,Bn(e,t));do try{Ff();break}catch(g){mc(e,g)}while(!0);Ao(),ys.current=s,Pe=l,Qe!==null?t=0:(qe=null,tt=0,t=Je)}if(t!==0){if(t===2&&(l=to(e),l!==0&&(r=l,t=Si(e,l))),t===1)throw n=ul,Bn(e,0),Nn(e,r),pt(e,Ae()),n;if(t===6)Nn(e,r);else{if(l=e.current.alternate,(r&30)===0&&!If(l)&&(t=js(e,r),t===2&&(s=to(e),s!==0&&(r=s,t=Si(e,s))),t===1))throw n=ul,Bn(e,0),Nn(e,r),pt(e,Ae()),n;switch(e.finishedWork=l,e.finishedLanes=r,t){case 0:case 1:throw Error(i(345));case 2:Hn(e,ft,nn);break;case 3:if(Nn(e,r),(r&130023424)===r&&(t=wi+500-Ae(),10<t)){if(Rl(e,0)!==0)break;if(l=e.suspendedLanes,(l&r)!==r){at(),e.pingedLanes|=e.suspendedLanes&l;break}e.timeoutHandle=_o(Hn.bind(null,e,ft,nn),t);break}Hn(e,ft,nn);break;case 4:if(Nn(e,r),(r&4194240)===r)break;for(t=e.eventTimes,l=-1;0<r;){var c=31-Ot(r);s=1<<c,c=t[c],c>l&&(l=c),r&=~s}if(r=l,r=Ae()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*zf(r/1960))-r,10<r){e.timeoutHandle=_o(Hn.bind(null,e,ft,nn),r);break}Hn(e,ft,nn);break;case 5:Hn(e,ft,nn);break;default:throw Error(i(329))}}}return pt(e,Ae()),e.callbackNode===n?pc.bind(null,e):null}function Si(e,t){var n=cl;return e.current.memoizedState.isDehydrated&&(Bn(e,t).flags|=256),e=js(e,t),e!==2&&(t=ft,ft=n,t!==null&&ji(t)),e}function ji(e){ft===null?ft=e:ft.push.apply(ft,e)}function If(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var l=n[r],s=l.getSnapshot;l=l.value;try{if(!Rt(s(),l))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Nn(e,t){for(t&=~xi,t&=~vs,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Ot(t),r=1<<n;e[n]=-1,t&=~r}}function hc(e){if((Pe&6)!==0)throw Error(i(327));xr();var t=Rl(e,0);if((t&1)===0)return pt(e,Ae()),null;var n=js(e,t);if(e.tag!==0&&n===2){var r=to(e);r!==0&&(t=r,n=Si(e,r))}if(n===1)throw n=ul,Bn(e,0),Nn(e,t),pt(e,Ae()),n;if(n===6)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Hn(e,ft,nn),pt(e,Ae()),null}function Ci(e,t){var n=Pe;Pe|=1;try{return e(t)}finally{Pe=n,Pe===0&&(vr=Ae()+500,Xl&&mn())}}function Un(e){wn!==null&&wn.tag===0&&(Pe&6)===0&&xr();var t=Pe;Pe|=1;var n=_t.transition,r=Te;try{if(_t.transition=null,Te=1,e)return e()}finally{Te=r,_t.transition=n,Pe=t,(Pe&6)===0&&mn()}}function Ei(){kt=yr.current,Me(yr)}function Bn(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,ff(n)),Qe!==null)for(n=Qe.return;n!==null;){var r=n;switch(zo(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Gl();break;case 3:hr(),Me(ut),Me(nt),Yo();break;case 5:Ko(r);break;case 4:hr();break;case 13:Me(Ue);break;case 19:Me(Ue);break;case 10:Uo(r.type._context);break;case 22:case 23:Ei()}n=n.return}if(qe=e,Qe=e=Sn(e.current,null),tt=kt=t,Je=0,ul=null,xi=vs=An=0,ft=cl=null,Mn!==null){for(t=0;t<Mn.length;t++)if(n=Mn[t],r=n.interleaved,r!==null){n.interleaved=null;var l=r.next,s=n.pending;if(s!==null){var c=s.next;s.next=l,r.next=c}n.pending=r}Mn=null}return e}function mc(e,t){do{var n=Qe;try{if(Ao(),is.current=ds,as){for(var r=Be.memoizedState;r!==null;){var l=r.queue;l!==null&&(l.pending=null),r=r.next}as=!1}if($n=0,Xe=Ge=Be=null,rl=!1,ll=0,vi.current=null,n===null||n.return===null){Je=1,ul=t,Qe=null;break}e:{var s=e,c=n.return,g=n,x=t;if(t=tt,g.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){var F=x,G=g,Z=G.tag;if((G.mode&1)===0&&(Z===0||Z===11||Z===15)){var K=G.alternate;K?(G.updateQueue=K.updateQueue,G.memoizedState=K.memoizedState,G.lanes=K.lanes):(G.updateQueue=null,G.memoizedState=null)}var ue=Au(c);if(ue!==null){ue.flags&=-257,Uu(ue,c,g,s,t),ue.mode&1&&$u(s,F,t),t=ue,x=F;var de=t.updateQueue;if(de===null){var fe=new Set;fe.add(x),t.updateQueue=fe}else de.add(x);break e}else{if((t&1)===0){$u(s,F,t),bi();break e}x=Error(i(426))}}else if(Fe&&g.mode&1){var Ve=Au(c);if(Ve!==null){(Ve.flags&65536)===0&&(Ve.flags|=256),Uu(Ve,c,g,s,t),Fo(mr(x,g));break e}}s=x=mr(x,g),Je!==4&&(Je=2),cl===null?cl=[s]:cl.push(s),s=c;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var _=Mu(s,x,t);cu(s,_);break e;case 1:g=x;var N=s.type,T=s.stateNode;if((s.flags&128)===0&&(typeof N.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(xn===null||!xn.has(T)))){s.flags|=65536,t&=-t,s.lanes|=t;var ne=Fu(s,g,t);cu(s,ne);break e}}s=s.return}while(s!==null)}vc(n)}catch(he){t=he,Qe===n&&n!==null&&(Qe=n=n.return);continue}break}while(!0)}function gc(){var e=ys.current;return ys.current=ds,e===null?ds:e}function bi(){(Je===0||Je===3||Je===2)&&(Je=4),qe===null||(An&268435455)===0&&(vs&268435455)===0||Nn(qe,tt)}function js(e,t){var n=Pe;Pe|=2;var r=gc();(qe!==e||tt!==t)&&(nn=null,Bn(e,t));do try{Mf();break}catch(l){mc(e,l)}while(!0);if(Ao(),Pe=n,ys.current=r,Qe!==null)throw Error(i(261));return qe=null,tt=0,Je}function Mf(){for(;Qe!==null;)yc(Qe)}function Ff(){for(;Qe!==null&&!Ke();)yc(Qe)}function yc(e){var t=kc(e.alternate,e,kt);e.memoizedProps=e.pendingProps,t===null?vc(e):Qe=t,vi.current=null}function vc(e){var t=e;do{var n=t.alternate;if(e=t.return,(t.flags&32768)===0){if(n=Df(n,t,kt),n!==null){Qe=n;return}}else{if(n=Of(n,t),n!==null){n.flags&=32767,Qe=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Je=6,Qe=null;return}}if(t=t.sibling,t!==null){Qe=t;return}Qe=t=e}while(t!==null);Je===0&&(Je=5)}function Hn(e,t,n){var r=Te,l=_t.transition;try{_t.transition=null,Te=1,$f(e,t,n,r)}finally{_t.transition=l,Te=r}return null}function $f(e,t,n,r){do xr();while(wn!==null);if((Pe&6)!==0)throw Error(i(327));n=e.finishedWork;var l=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(vd(e,s),e===qe&&(Qe=qe=null,tt=0),(n.subtreeFlags&2064)===0&&(n.flags&2064)===0||ws||(ws=!0,Nc(Pl,function(){return xr(),null})),s=(n.flags&15990)!==0,(n.subtreeFlags&15990)!==0||s){s=_t.transition,_t.transition=null;var c=Te;Te=1;var g=Pe;Pe|=4,vi.current=null,Tf(e,n),ac(n,e),lf(bo),zl=!!Eo,bo=Eo=null,e.current=n,Lf(n),jt(),Pe=g,Te=c,_t.transition=s}else e.current=n;if(ws&&(ws=!1,wn=e,ks=l),s=e.pendingLanes,s===0&&(xn=null),fd(n.stateNode),pt(e,Ae()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)l=t[n],r(l.value,{componentStack:l.stack,digest:l.digest});if(xs)throw xs=!1,e=ki,ki=null,e;return(ks&1)!==0&&e.tag!==0&&xr(),s=e.pendingLanes,(s&1)!==0?e===Ni?dl++:(dl=0,Ni=e):dl=0,mn(),null}function xr(){if(wn!==null){var e=oa(ks),t=_t.transition,n=Te;try{if(_t.transition=null,Te=16>e?16:e,wn===null)var r=!1;else{if(e=wn,wn=null,ks=0,(Pe&6)!==0)throw Error(i(331));var l=Pe;for(Pe|=4,ce=e.current;ce!==null;){var s=ce,c=s.child;if((ce.flags&16)!==0){var g=s.deletions;if(g!==null){for(var x=0;x<g.length;x++){var F=g[x];for(ce=F;ce!==null;){var G=ce;switch(G.tag){case 0:case 11:case 15:al(8,G,s)}var Z=G.child;if(Z!==null)Z.return=G,ce=Z;else for(;ce!==null;){G=ce;var K=G.sibling,ue=G.return;if(rc(G),G===F){ce=null;break}if(K!==null){K.return=ue,ce=K;break}ce=ue}}}var de=s.alternate;if(de!==null){var fe=de.child;if(fe!==null){de.child=null;do{var Ve=fe.sibling;fe.sibling=null,fe=Ve}while(fe!==null)}}ce=s}}if((s.subtreeFlags&2064)!==0&&c!==null)c.return=s,ce=c;else e:for(;ce!==null;){if(s=ce,(s.flags&2048)!==0)switch(s.tag){case 0:case 11:case 15:al(9,s,s.return)}var _=s.sibling;if(_!==null){_.return=s.return,ce=_;break e}ce=s.return}}var N=e.current;for(ce=N;ce!==null;){c=ce;var T=c.child;if((c.subtreeFlags&2064)!==0&&T!==null)T.return=c,ce=T;else e:for(c=N;ce!==null;){if(g=ce,(g.flags&2048)!==0)try{switch(g.tag){case 0:case 11:case 15:gs(9,g)}}catch(he){He(g,g.return,he)}if(g===c){ce=null;break e}var ne=g.sibling;if(ne!==null){ne.return=g.return,ce=ne;break e}ce=g.return}}if(Pe=l,mn(),Ut&&typeof Ut.onPostCommitFiberRoot=="function")try{Ut.onPostCommitFiberRoot(_l,e)}catch{}r=!0}return r}finally{Te=n,_t.transition=t}}return!1}function xc(e,t,n){t=mr(n,t),t=Mu(e,t,1),e=yn(e,t,1),t=at(),e!==null&&(zr(e,1,t),pt(e,t))}function He(e,t,n){if(e.tag===3)xc(e,e,n);else for(;t!==null;){if(t.tag===3){xc(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(xn===null||!xn.has(r))){e=mr(n,e),e=Fu(t,e,1),t=yn(t,e,1),e=at(),t!==null&&(zr(t,1,e),pt(t,e));break}}t=t.return}}function Af(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=at(),e.pingedLanes|=e.suspendedLanes&n,qe===e&&(tt&n)===n&&(Je===4||Je===3&&(tt&130023424)===tt&&500>Ae()-wi?Bn(e,0):xi|=n),pt(e,t)}function wc(e,t){t===0&&((e.mode&1)===0?t=1:(t=Ol,Ol<<=1,(Ol&130023424)===0&&(Ol=4194304)));var n=at();e=Zt(e,t),e!==null&&(zr(e,t,n),pt(e,n))}function Uf(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),wc(e,n)}function Bf(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,l=e.memoizedState;l!==null&&(n=l.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(i(314))}r!==null&&r.delete(t),wc(e,n)}var kc;kc=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||ut.current)dt=!0;else{if((e.lanes&n)===0&&(t.flags&128)===0)return dt=!1,_f(e,t,n);dt=(e.flags&131072)!==0}else dt=!1,Fe&&(t.flags&1048576)!==0&&eu(t,Zl,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;hs(e,t),e=t.pendingProps;var l=ir(t,nt.current);pr(t,n),l=Xo(null,t,r,e,l,n);var s=qo();return t.flags|=1,typeof l=="object"&&l!==null&&typeof l.render=="function"&&l.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ct(r)?(s=!0,Jl(t)):s=!1,t.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,Vo(t),l.updater=fs,t.stateNode=l,l._reactInternals=t,li(t,r,e,n),t=ai(null,t,r,!0,s,n)):(t.tag=0,Fe&&s&&Lo(t),it(null,t,l,n),t=t.child),t;case 16:r=t.elementType;e:{switch(hs(e,t),e=t.pendingProps,l=r._init,r=l(r._payload),t.type=r,l=t.tag=Vf(r),e=Lt(r,e),l){case 0:t=ii(null,t,r,e,n);break e;case 1:t=Qu(null,t,r,e,n);break e;case 11:t=Bu(null,t,r,e,n);break e;case 14:t=Hu(null,t,r,Lt(r.type,e),n);break e}throw Error(i(306,r,""))}return t;case 0:return r=t.type,l=t.pendingProps,l=t.elementType===r?l:Lt(r,l),ii(e,t,r,l,n);case 1:return r=t.type,l=t.pendingProps,l=t.elementType===r?l:Lt(r,l),Qu(e,t,r,l,n);case 3:e:{if(Yu(t),e===null)throw Error(i(387));r=t.pendingProps,s=t.memoizedState,l=s.element,uu(e,t),ss(t,r,null,n);var c=t.memoizedState;if(r=c.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:c.cache,pendingSuspenseBoundaries:c.pendingSuspenseBoundaries,transitions:c.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){l=mr(Error(i(423)),t),t=Gu(e,t,r,n,l);break e}else if(r!==l){l=mr(Error(i(424)),t),t=Gu(e,t,r,n,l);break e}else for(wt=fn(t.stateNode.containerInfo.firstChild),xt=t,Fe=!0,Tt=null,n=iu(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(cr(),r===l){t=tn(e,t,n);break e}it(e,t,r,n)}t=t.child}return t;case 5:return fu(t),e===null&&Mo(t),r=t.type,l=t.pendingProps,s=e!==null?e.memoizedProps:null,c=l.children,Po(r,l)?c=null:s!==null&&Po(r,s)&&(t.flags|=32),Ku(e,t),it(e,t,c,n),t.child;case 6:return e===null&&Mo(t),null;case 13:return Ju(e,t,n);case 4:return Wo(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=dr(t,null,r,n):it(e,t,r,n),t.child;case 11:return r=t.type,l=t.pendingProps,l=t.elementType===r?l:Lt(r,l),Bu(e,t,r,l,n);case 7:return it(e,t,t.pendingProps,n),t.child;case 8:return it(e,t,t.pendingProps.children,n),t.child;case 12:return it(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,l=t.pendingProps,s=t.memoizedProps,c=l.value,Le(ns,r._currentValue),r._currentValue=c,s!==null)if(Rt(s.value,c)){if(s.children===l.children&&!ut.current){t=tn(e,t,n);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var g=s.dependencies;if(g!==null){c=s.child;for(var x=g.firstContext;x!==null;){if(x.context===r){if(s.tag===1){x=en(-1,n&-n),x.tag=2;var F=s.updateQueue;if(F!==null){F=F.shared;var G=F.pending;G===null?x.next=x:(x.next=G.next,G.next=x),F.pending=x}}s.lanes|=n,x=s.alternate,x!==null&&(x.lanes|=n),Bo(s.return,n,t),g.lanes|=n;break}x=x.next}}else if(s.tag===10)c=s.type===t.type?null:s.child;else if(s.tag===18){if(c=s.return,c===null)throw Error(i(341));c.lanes|=n,g=c.alternate,g!==null&&(g.lanes|=n),Bo(c,n,t),c=s.sibling}else c=s.child;if(c!==null)c.return=s;else for(c=s;c!==null;){if(c===t){c=null;break}if(s=c.sibling,s!==null){s.return=c.return,c=s;break}c=c.return}s=c}it(e,t,l.children,n),t=t.child}return t;case 9:return l=t.type,r=t.pendingProps.children,pr(t,n),l=bt(l),r=r(l),t.flags|=1,it(e,t,r,n),t.child;case 14:return r=t.type,l=Lt(r,t.pendingProps),l=Lt(r.type,l),Hu(e,t,r,l,n);case 15:return Vu(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,l=t.pendingProps,l=t.elementType===r?l:Lt(r,l),hs(e,t),t.tag=1,ct(r)?(e=!0,Jl(t)):e=!1,pr(t,n),zu(t,r,l),li(t,r,l,n),ai(null,t,r,!0,e,n);case 19:return qu(e,t,n);case 22:return Wu(e,t,n)}throw Error(i(156,t.tag))};function Nc(e,t){return ye(e,t)}function Hf(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dt(e,t,n,r){return new Hf(e,t,n,r)}function Pi(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Vf(e){if(typeof e=="function")return Pi(e)?1:0;if(e!=null){if(e=e.$$typeof,e===L)return 11;if(e===X)return 14}return 2}function Sn(e,t){var n=e.alternate;return n===null?(n=Dt(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Cs(e,t,n,r,l,s){var c=2;if(r=e,typeof e=="function")Pi(e)&&(c=1);else if(typeof e=="string")c=5;else e:switch(e){case D:return Vn(n.children,l,s,t);case ee:c=8,l|=8;break;case Q:return e=Dt(12,n,t,l|2),e.elementType=Q,e.lanes=s,e;case ae:return e=Dt(13,n,t,l),e.elementType=ae,e.lanes=s,e;case I:return e=Dt(19,n,t,l),e.elementType=I,e.lanes=s,e;case H:return Es(n,l,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case M:c=10;break e;case oe:c=9;break e;case L:c=11;break e;case X:c=14;break e;case re:c=16,r=null;break e}throw Error(i(130,e==null?e:typeof e,""))}return t=Dt(c,n,t,l),t.elementType=e,t.type=r,t.lanes=s,t}function Vn(e,t,n,r){return e=Dt(7,e,r,t),e.lanes=n,e}function Es(e,t,n,r){return e=Dt(22,e,r,t),e.elementType=H,e.lanes=n,e.stateNode={isHidden:!1},e}function _i(e,t,n){return e=Dt(6,e,null,t),e.lanes=n,e}function Di(e,t,n){return t=Dt(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Wf(e,t,n,r,l){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=no(0),this.expirationTimes=no(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=no(0),this.identifierPrefix=r,this.onRecoverableError=l,this.mutableSourceEagerHydrationData=null}function Oi(e,t,n,r,l,s,c,g,x){return e=new Wf(e,t,n,g,x),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Dt(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Vo(s),e}function Kf(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:J,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Sc(e){if(!e)return hn;e=e._reactInternals;e:{if(At(e)!==e||e.tag!==1)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ct(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(i(171))}if(e.tag===1){var n=e.type;if(ct(n))return Xa(e,n,t)}return t}function jc(e,t,n,r,l,s,c,g,x){return e=Oi(n,r,!0,e,l,s,c,g,x),e.context=Sc(null),n=e.current,r=at(),l=kn(n),s=en(r,l),s.callback=t??null,yn(n,s,l),e.current.lanes=l,zr(e,l,r),pt(e,r),e}function bs(e,t,n,r){var l=t.current,s=at(),c=kn(l);return n=Sc(n),t.context===null?t.context=n:t.pendingContext=n,t=en(s,c),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=yn(l,t,c),e!==null&&(Mt(e,l,c,s),ls(e,l,c)),c}function Ps(e){return e=e.current,e.child?(e.child.tag===5,e.child.stateNode):null}function Cc(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Ri(e,t){Cc(e,t),(e=e.alternate)&&Cc(e,t)}function Qf(){return null}var Ec=typeof reportError=="function"?reportError:function(e){console.error(e)};function Ti(e){this._internalRoot=e}_s.prototype.render=Ti.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(i(409));bs(e,t,null,null)},_s.prototype.unmount=Ti.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Un(function(){bs(null,e,null,null)}),t[Gt]=null}};function _s(e){this._internalRoot=e}_s.prototype.unstable_scheduleHydration=function(e){if(e){var t=ua();e={blockedOn:null,target:e,priority:t};for(var n=0;n<un.length&&t!==0&&t<un[n].priority;n++);un.splice(n,0,e),n===0&&fa(e)}};function Li(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Ds(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function bc(){}function Yf(e,t,n,r,l){if(l){if(typeof r=="function"){var s=r;r=function(){var F=Ps(c);s.call(F)}}var c=jc(t,r,e,0,null,!1,!1,"",bc);return e._reactRootContainer=c,e[Gt]=c.current,Gr(e.nodeType===8?e.parentNode:e),Un(),c}for(;l=e.lastChild;)e.removeChild(l);if(typeof r=="function"){var g=r;r=function(){var F=Ps(x);g.call(F)}}var x=Oi(e,0,!1,null,null,!1,!1,"",bc);return e._reactRootContainer=x,e[Gt]=x.current,Gr(e.nodeType===8?e.parentNode:e),Un(function(){bs(t,x,n,r)}),x}function Os(e,t,n,r,l){var s=n._reactRootContainer;if(s){var c=s;if(typeof l=="function"){var g=l;l=function(){var x=Ps(c);g.call(x)}}bs(t,c,e,l)}else c=Yf(n,t,e,l,r);return Ps(c)}ia=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Lr(t.pendingLanes);n!==0&&(ro(t,n|1),pt(t,Ae()),(Pe&6)===0&&(vr=Ae()+500,mn()))}break;case 13:Un(function(){var r=Zt(e,1);if(r!==null){var l=at();Mt(r,e,1,l)}}),Ri(e,1)}},lo=function(e){if(e.tag===13){var t=Zt(e,134217728);if(t!==null){var n=at();Mt(t,e,134217728,n)}Ri(e,134217728)}},aa=function(e){if(e.tag===13){var t=kn(e),n=Zt(e,t);if(n!==null){var r=at();Mt(n,e,t,r)}Ri(e,t)}},ua=function(){return Te},ca=function(e,t){var n=Te;try{return Te=e,t()}finally{Te=n}},Pr=function(e,t,n){switch(t){case"input":if(be(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var l=Yl(r);if(!l)throw Error(i(90));se(r),be(r,l)}}}break;case"textarea":yl(e,n);break;case"select":t=n.value,t!=null&&ot(e,!!n.multiple,t,!1)}},_r=Ci,jl=Un;var Gf={usingClientEntryPoint:!1,Events:[qr,sr,Yl,ln,Yn,Ci]},fl={findFiberByHostInstance:Tn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Jf={bundleType:fl.bundleType,version:fl.version,rendererPackageName:fl.rendererPackageName,rendererConfig:fl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:O.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Tr(e),e===null?null:e.stateNode},findFiberByHostInstance:fl.findFiberByHostInstance||Qf,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Rs=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Rs.isDisabled&&Rs.supportsFiber)try{_l=Rs.inject(Jf),Ut=Rs}catch{}}return ht.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Gf,ht.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Li(t))throw Error(i(200));return Kf(e,t,null,n)},ht.createRoot=function(e,t){if(!Li(e))throw Error(i(299));var n=!1,r="",l=Ec;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(l=t.onRecoverableError)),t=Oi(e,1,!1,null,null,n,!1,r,l),e[Gt]=t.current,Gr(e.nodeType===8?e.parentNode:e),new Ti(t)},ht.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(i(188)):(e=Object.keys(e).join(","),Error(i(268,e)));return e=Tr(t),e=e===null?null:e.stateNode,e},ht.flushSync=function(e){return Un(e)},ht.hydrate=function(e,t,n){if(!Ds(t))throw Error(i(200));return Os(null,e,t,!0,n)},ht.hydrateRoot=function(e,t,n){if(!Li(e))throw Error(i(405));var r=n!=null&&n.hydratedSources||null,l=!1,s="",c=Ec;if(n!=null&&(n.unstable_strictMode===!0&&(l=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(c=n.onRecoverableError)),t=jc(t,null,e,1,n??null,l,!1,s,c),e[Gt]=t.current,Gr(e),r)for(e=0;e<r.length;e++)n=r[e],l=n._getVersion,l=l(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,l]:t.mutableSourceEagerHydrationData.push(n,l);return new _s(t)},ht.render=function(e,t,n){if(!Ds(t))throw Error(i(200));return Os(null,e,t,!1,n)},ht.unmountComponentAtNode=function(e){if(!Ds(e))throw Error(i(40));return e._reactRootContainer?(Un(function(){Os(null,null,e,!1,function(){e._reactRootContainer=null,e[Gt]=null})}),!0):!1},ht.unstable_batchedUpdates=Ci,ht.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Ds(n))throw Error(i(200));if(e==null||e._reactInternals===void 0)throw Error(i(38));return Os(e,t,n,!1,r)},ht.version="18.3.1-next-f1338f8080-20240426",ht}var zc;function sp(){if(zc)return Mi.exports;zc=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(u){console.error(u)}}return a(),Mi.exports=lp(),Mi.exports}var Ic;function op(){if(Ic)return Ts;Ic=1;var a=sp();return Ts.createRoot=a.createRoot,Ts.hydrateRoot=a.hydrateRoot,Ts}var ip=op();const ze={get(a){try{return localStorage.getItem(a)}catch(u){return console.warn("safeLocalStorage.get failed",u),null}},set(a,u){try{if(localStorage.setItem(a,u),localStorage.getItem(a)!==u)throw new Error("Failed to verify localStorage write")}catch(i){throw console.error("safeLocalStorage.set failed",i),i}},remove(a){try{localStorage.removeItem(a)}catch(u){console.warn("safeLocalStorage.remove failed",u)}}};var ap={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const up=a=>a.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),gt=(a,u)=>{const i=b.forwardRef(({color:f="currentColor",size:d=24,strokeWidth:p=2,absoluteStrokeWidth:m,children:y,...v},S)=>b.createElement("svg",{ref:S,...ap,width:d,height:d,stroke:f,strokeWidth:m?Number(p)*24/Number(d):p,className:`lucide lucide-${up(a)}`,...v},[...u.map(([k,P])=>b.createElement(k,P)),...(Array.isArray(y)?y:[y])||[]]));return i.displayName=`${a}`,i},cp=gt("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),Xc=gt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),Is=gt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),qc=gt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),dp=gt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),Zc=gt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),Vi=gt("FolderOpen",[["path",{d:"m6 14 1.45-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.55 6a2 2 0 0 1-1.94 1.5H4a2 2 0 0 1-2-2V5c0-1.1.9-2 2-2h3.93a2 2 0 0 1 1.66.9l.82 1.2a2 2 0 0 0 1.66.9H18a2 2 0 0 1 2 2v2",key:"1nmvlm"}]]),Ms=gt("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),Vs=gt("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]),Wi=gt("Pencil",[["line",{x1:"18",x2:"22",y1:"2",y2:"6",key:"1e96e7"}],["path",{d:"M7.5 20.5 19 9l-4-4L3.5 16.5 2 22z",key:"12iwkt"}]]),fp=gt("Plus",[["line",{x1:"12",x2:"12",y1:"5",y2:"19",key:"pwfkuu"}],["line",{x1:"5",x2:"19",y1:"12",y2:"12",key:"13b5wn"}]]),Ki=gt("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),pp=gt("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]),rn=gt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),hp=/^(?:day|d)[\s_-]?(\d{1,2})(?:[^\d]|$)/i,mp=/(\d{4})-(\d{2})-(\d{2})/,gp=/(\d{4})_(\d{2})_(\d{2})/,yp=/^(\d{1,2})[\s_-]/,vp=/^([A-M])(?:[\s_-]+)(Establishing|People|Culture(?:[-_\s]?Detail)?|Detail|Action|Moment|Transition|Mood|Food)$/i,xp=/^([A-M])$/i,wp=/^([A-M])(?:[\s_-]+)(.+)$/i,kp=/^(0[1-6])$/,Mc={"01":"A","02":"B","03":"C","04":"D","05":"E","06":"M"};function Fc(a,u){try{const i=new Date(a),f=u?new Date(u):i;if(isNaN(i.getTime())||isNaN(f.getTime()))return null;const d=i.getTime()-f.getTime();return Math.floor(d/(1e3*60*60*24))+1}catch{return null}}function Fs(a,u){const i=a.match(hp);if(i){const p=parseInt(i[1],10);if(p>=1&&p<=31)return{day:p,pattern:"day_prefix",confidence:"high"}}let f=a.match(mp);if(f){const p=`${f[1]}-${f[2]}-${f[3]}`,m=Fc(p,u);if(m!==null)return{day:m,pattern:"iso_date",confidence:u?"high":"medium"}}if(f=a.match(gp),f){const p=`${f[1]}-${f[2]}-${f[3]}`,m=Fc(p,u);if(m!==null)return{day:m,pattern:"iso_date",confidence:u?"high":"medium"}}const d=a.match(yp);if(d){const p=parseInt(d[1],10);if(p>=1&&p<=31)return{day:p,pattern:"numeric_prefix",confidence:"medium"}}return null}function Nr(a,u){return Fs(a,u)?.day??null}function Qi(a){const u=a.match(vp);if(u)return{bucket:u[1].toUpperCase(),confidence:"high",pattern:"standard"};const i=a.match(xp);if(i)return{bucket:i[1].toUpperCase(),confidence:"high",pattern:"letter"};const f=a.match(wp);if(f)return{bucket:f[1].toUpperCase(),confidence:"medium",pattern:"custom"};const d=a.match(kp);return d&&Mc[d[1]]?{bucket:Mc[d[1]],confidence:"low",pattern:"numeric"}:null}function Np(a,u){const i="01_DAYS",f=a.split(/[\\/]/).filter(Boolean),d=f.length>0?f.slice(0,-1):[];let p=null,m=null,y="none",v="none";const S=d.findIndex(R=>{const $=R.toLowerCase();return $===i.toLowerCase()||$==="01_days"||$==="days"});if(S!==-1&&S<d.length-1){const R=d[S+1],$=Fs(R);if($&&(p=$.day,y=$.confidence,S+2<d.length)){const B=d[S+2],z=Qi(B);z&&(m=z.bucket,v=z.confidence)}}else for(let R=0;R<d.length;R++){const $=d[R],B=Fs($);if(B){if(p=B.day,y=B.confidence==="high"?"medium":"low",R+1<d.length){const z=d[R+1],U=Qi(z);U&&(m=U.bucket,v=U.confidence)}break}}const k=p!==null&&m!==null;let P="none";return k?y==="high"&&v==="high"?P="high":y!=="none"&&v!=="none"?P="medium":P="low":p!==null&&(P=y),{detectedDay:p,detectedBucket:m,isPreOrganized:k,confidence:P,pathSegments:d}}async function $c(a){const u=[],i=["jpg","jpeg","png","heic","webp","mp4","mov","webm","avi","mkv"];try{for await(const[f,d]of a.entries()){if(d.kind!=="directory")continue;const p=Qi(f);if(!p)continue;let m=0;for await(const[y,v]of d.entries()){if(v.kind!=="file")continue;const S=y.split(".").pop()?.toLowerCase()||"";i.includes(S)&&(m+=1)}u.push({bucketLetter:p.bucket,folderName:f,photoCount:m,confidence:p.confidence,patternMatched:p.pattern})}}catch(f){console.warn("Failed to scan for buckets:",f)}return u.sort((f,d)=>f.bucketLetter.localeCompare(d.bucketLetter))}function Ac(a){return a===null?"Unsorted":`Day ${String(a).padStart(2,"0")}`}function Sp(a){return[/^\..*/,/^unsorted$/i,/^inbox$/i,/^miscellaneous$/i,/^metadata$/i,/^_meta$/i].some(i=>i.test(a))}function Uc(a,u){const{photoCountMap:i=new Map,projectName:f="",tripStart:d}=u||{},p=[];for(const m of a){if(Sp(m)||f&&m.toLowerCase()===f.toLowerCase())continue;const y=i.get(m)||0,v=Fs(m,d);v?p.push({folder:m,folderPath:m,detectedDay:v.day,confidence:v.confidence,patternMatched:v.pattern,suggestedName:Ac(v.day),manual:!1,photoCount:y}):p.push({folder:m,folderPath:m,detectedDay:null,confidence:"undetected",patternMatched:"none",suggestedName:Ac(null),manual:!1,photoCount:y})}return p.sort((m,y)=>m.detectedDay===null&&y.detectedDay===null?m.folder.localeCompare(y.folder):m.detectedDay===null?1:y.detectedDay===null?-1:m.detectedDay-y.detectedDay),p}function ed({isOpen:a,onClose:u,onComplete:i,recentProjects:f=[],onSelectRecent:d}){const[p,m]=b.useState("select"),[y,v]=b.useState(""),[S,k]=b.useState(""),[P,R]=b.useState(null),[$,B]=b.useState(null),[z,U]=b.useState([]),[V,W]=b.useState(!1),le=zs.useRef(null),O=b.useCallback(async()=>{if(!y.trim()){R("Please enter a project name");return}if(!$){R("Please choose a folder");return}R(null),W(!0);try{const D=["jpg","jpeg","png","heic","webp","mp4","mov","webm","avi","mkv"],ee=H=>{const C=H.toLowerCase().replace(/[^a-z0-9]+/g,"");return C==="01days"||C==="days"},Q=async H=>{let C=0;for await(const[,A]of H.entries())if(A.kind==="directory")C+=await Q(A);else if(A.kind==="file"){const j=A.name.split(".").pop()?.toLowerCase()||"";D.includes(j)&&(C+=1)}return C},M=new Map,oe=[],L=new Map;for await(const[H,C]of $.entries()){if(C.kind!=="directory")continue;oe.push(H),L.set(H,C);let A=0;for await(const[,j]of C.entries()){if(j.kind!=="file")continue;const h=j.name.split(".").pop()?.toLowerCase()||"";D.includes(h)&&(A+=1)}M.set(H,A)}const ae=oe.find(H=>ee(H))||null;if(ae){const H=L.get(ae);if(H){const C=[],A=new Map,j=new Map;for await(const[te,ie]of H.entries()){if(ie.kind!=="directory")continue;C.push(te),A.set(te,ie);const me=await Q(ie);j.set(te,me)}const h=Uc(C,{photoCountMap:j,projectName:y}).map(te=>({...te,folderPath:`${ae}/${te.folder}`})),Y=(await Promise.all(h.map(async te=>{const ie=A.get(te.folder);if(!ie||te.confidence==="undetected")return te;const me=await $c(ie);return{...te,detectedBuckets:me,isOrganizedStructure:me.length>0,bucketConfidence:me.length>0?me.every(ge=>ge.confidence==="high")?"high":"medium":"none"}}))).map(te=>({...te,skip:te.confidence==="undetected"?!0:te.skip??!1}));U(Y),m("preview");return}}const I=Uc(oe,{photoCountMap:M,projectName:y}),re=(await Promise.all(I.map(async H=>{const C=L.get(H.folder);if(!C||H.confidence==="undetected")return H;const A=await $c(C);return{...H,detectedBuckets:A,isOrganizedStructure:A.length>0,bucketConfidence:A.length>0?A.every(j=>j.confidence==="high")?"high":"medium":"none"}}))).map(H=>({...H,skip:H.confidence==="undetected"?!0:H.skip??!1}));U(re),m("preview")}catch(D){R(D instanceof Error?D.message:"Failed to detect folder structure")}finally{W(!1)}},[$,y]),w=b.useCallback((D,ee,Q)=>{U(M=>{const oe=[...M];return ee==="detectedDay"?(oe[D].detectedDay=Q===""?null:parseInt(Q,10),oe[D].manual=!0):ee==="skip"?oe[D].skip=Q:oe[D][ee]=Q,oe})},[]),J=b.useCallback(()=>{if(!y.trim()){R("Please enter a project name");return}if(!$){R("Please choose a folder");return}const D=S.trim()||$.name,ee=f.find(Q=>Q.rootPath.toLowerCase()===D.toLowerCase());if(ee){R(`This folder is already being used by project "${ee.projectName}". Opening the same folder twice could cause conflicts. Open the existing project instead or choose a different folder.`);return}R(null),i({projectName:y.trim(),rootPath:D,dirHandle:$,mappings:z}),u()},[$,z,u,i,y,S,f]);return a?o.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-start justify-center z-50 pt-12",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-3xl w-full mx-6 max-h-[88vh] overflow-y-auto",children:[o.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-8 py-6 flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-extrabold text-gray-900",children:p==="select"?"Create Project":"Review Folder Structure"}),o.jsx("p",{className:"text-sm text-gray-500 mt-1",children:p==="select"?"Add a project name and choose the folder that contains your photos.":"Confirm how your existing folders map to days."})]}),o.jsx("button",{onClick:u,className:"text-gray-600 hover:text-gray-800 rounded-md px-2 py-1","aria-label":"Close",children:o.jsx(rn,{size:20})})]}),o.jsxs("div",{className:"px-8 py-6 space-y-6",children:[P&&o.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg text-sm text-red-800",children:P}),p==="select"&&f.length>0&&o.jsxs("div",{className:"space-y-3 rounded-lg border border-gray-200 bg-gray-50 p-4",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Recent Projects"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Open a recent project instead of creating a new one."})]}),o.jsx("div",{className:"space-y-2",children:f.map(D=>o.jsxs("button",{onClick:()=>{d?.(D.projectId),u()},className:"w-full text-left rounded-lg border border-gray-200 bg-white px-3 py-2 hover:border-blue-300 hover:bg-blue-50",children:[o.jsx("div",{className:"text-sm font-medium text-gray-900",children:D.projectName}),o.jsx("div",{className:"text-xs text-gray-600 truncate",children:D.rootPath})]},D.projectId))})]}),p==="select"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Project Name"}),o.jsx("input",{type:"text",value:y,onChange:D=>v(D.target.value),placeholder:"e.g., Mexico 2025",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 placeholder:text-gray-600 text-gray-900"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Folder Path"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{type:"text",value:S,onChange:D=>k(D.target.value),placeholder:"/Users/you/trips/mexico",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 placeholder:text-gray-600 text-gray-900"}),o.jsx("input",{ref:le,type:"file",webkitdirectory:"true",as:!0,any:!0,directory:"true",mozdirectory:"true",className:"hidden",onChange:D=>{const ee=D.currentTarget.files;if(!ee||ee.length===0)return;const Q=ee[0],oe=(Q.webkitRelativePath||Q.name).split("/")[0];k(oe),B(null),D.currentTarget.value=""}}),o.jsxs("button",{onClick:async()=>{if("showDirectoryPicker"in window){const D=await window.showDirectoryPicker();B(D),k(D?.name||"");return}le.current?.click()},className:"px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 flex items-center gap-2",children:[o.jsx(Vi,{size:18}),"Browse"]})]}),o.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Use the folder picker to grant access. If the picker is unavailable, paste the full path (the app will ask again on first open)."})]})]}),p==="preview"&&o.jsxs("div",{className:"space-y-4",children:[o.jsx("p",{className:"text-sm text-gray-600",children:"Review the detected folders and adjust the day numbers if needed."}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50",children:[o.jsx("th",{className:"text-left px-3 py-2 font-medium text-gray-700",children:"Folder"}),o.jsx("th",{className:"text-center px-3 py-2 font-medium text-gray-700",children:"Day #"}),o.jsx("th",{className:"text-left px-3 py-2 font-medium text-gray-700",children:"Buckets"}),o.jsx("th",{className:"text-center px-3 py-2 font-medium text-gray-700",children:"Photos"}),o.jsx("th",{className:"text-center px-3 py-2 font-medium text-gray-700",children:"Action"})]})}),o.jsxs("tbody",{children:[z.map((D,ee)=>o.jsxs("tr",{className:`border-b border-gray-200 ${D.skip?"bg-gray-100 opacity-60":"hover:bg-blue-50"}`,children:[o.jsx("td",{className:"px-3 py-3 text-gray-900",children:D.folder}),o.jsx("td",{className:"px-3 py-3 text-center",children:o.jsx("input",{type:"number",min:"1",max:"31",value:D.detectedDay??"",onChange:Q=>w(ee,"detectedDay",Q.target.value),disabled:D.skip,className:"w-12 px-2 py-1 border border-gray-300 rounded text-center focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900",placeholder:""})}),o.jsx("td",{className:"px-3 py-3",children:D.detectedBuckets&&D.detectedBuckets.length>0?o.jsx("div",{className:"flex flex-wrap gap-1",children:D.detectedBuckets.map(Q=>o.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800",title:`${Q.folderName} (${Q.photoCount} photos)`,children:[Q.bucketLetter,o.jsxs("span",{className:"ml-1 text-green-600",children:["(",Q.photoCount,")"]})]},Q.bucketLetter))}):o.jsx("span",{className:"text-xs text-gray-400 italic",children:"None detected"})}),o.jsx("td",{className:"px-3 py-3 text-center text-gray-600",children:D.photoCount}),o.jsx("td",{className:"px-3 py-3 text-center",children:o.jsx("button",{onClick:()=>w(ee,"skip",!D.skip),className:`px-3 py-1 rounded text-sm font-medium ${D.skip?"bg-gray-200 text-gray-700 hover:bg-gray-300":"bg-blue-100 text-blue-700 hover:bg-blue-200"}`,children:D.skip?"Skip":"Map"})})]},D.folder)),z.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:5,className:"px-3 py-4 text-sm text-gray-600 text-center",children:"No subfolders detected. You can still continue and sort manually."})})]})]})})]})]}),o.jsx("div",{className:"sticky bottom-0 bg-white border-t border-gray-200 px-6 py-4 flex justify-between gap-3",children:p==="select"?o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:u,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 font-medium",children:"Cancel"}),o.jsx("button",{onClick:O,disabled:!y.trim()||!$||V,"aria-disabled":!y.trim()||!$||V,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium disabled:bg-gray-200 disabled:text-gray-500 disabled:cursor-not-allowed",children:V?"Detecting":"Next"})]}):o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:()=>m("select"),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 font-medium",children:"Back"}),o.jsx("button",{onClick:J,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",children:"Create Project"})]})})]})}):null}const jp="narrative-covers",Cp=1,bn="covers",mt="metadata";let Ls=null;async function Ws(){return Ls||new Promise((a,u)=>{const i=indexedDB.open(jp,Cp);i.onerror=()=>u(i.error),i.onsuccess=()=>{Ls=i.result,a(Ls)},i.onupgradeneeded=f=>{const d=f.target.result;d.objectStoreNames.contains(bn)||d.createObjectStore(bn,{keyPath:"coverKey"}),d.objectStoreNames.contains(mt)||d.createObjectStore(mt,{keyPath:"projectId"}).createIndex("lastUsed","lastUsed",{unique:!1})}})}async function Ep(a,u,i=120,f=90){const d=await Ws(),p=`cover-${a}-${Date.now()}`,m=u.size,y=d.transaction([bn],"readwrite").objectStore(bn).put({coverKey:p,blob:u});await new Promise((k,P)=>{y.onsuccess=()=>k(),y.onerror=()=>P(y.error)});const v={projectId:a,coverKey:p,lastUsed:Date.now(),width:i,height:f,sizeBytes:m},S=d.transaction([mt],"readwrite").objectStore(mt).put(v);return await new Promise((k,P)=>{S.onsuccess=()=>k(),S.onerror=()=>P(S.error)}),p}async function bp(a){const u=await Ws(),i=u.transaction([mt],"readonly").objectStore(mt).get(a),f=await new Promise((y,v)=>{i.onsuccess=()=>y(i.result),i.onerror=()=>v(i.error)});if(!f)return null;const d=u.transaction([mt],"readwrite").objectStore(mt).put({...f,lastUsed:Date.now()});await new Promise((y,v)=>{d.onsuccess=()=>y(),d.onerror=()=>v(d.error)});const p=u.transaction([bn],"readonly").objectStore(bn).get(f.coverKey);return(await new Promise((y,v)=>{p.onsuccess=()=>y(p.result),p.onerror=()=>v(p.error)}))?.blob||null}async function Pp(a){const u=await bp(a);return u?URL.createObjectURL(u):null}async function _p(a){const u=await Ws(),i=u.transaction([mt],"readonly").objectStore(mt).get(a),f=await new Promise((m,y)=>{i.onsuccess=()=>m(i.result),i.onerror=()=>y(i.error)});if(!f)return;const d=u.transaction([bn],"readwrite").objectStore(bn).delete(f.coverKey);await new Promise((m,y)=>{d.onsuccess=()=>m(),d.onerror=()=>y(d.error)});const p=u.transaction([mt],"readwrite").objectStore(mt).delete(a);await new Promise((m,y)=>{p.onsuccess=()=>m(),p.onerror=()=>y(p.error)})}async function Dp(){const u=(await Ws()).transaction([mt],"readonly").objectStore(mt).index("lastUsed");return await new Promise((f,d)=>{const p=u.getAll();p.onsuccess=()=>f(p.result),p.onerror=()=>d(p.error)})}async function Op(a=10){const u=await Dp(),i=[];if(u.length>a){const f=u.slice(0,u.length-a);for(const d of f)await _p(d.projectId),i.push(d.projectId)}return i}function Rp({project:a,onOpen:u}){const[i,f]=b.useState(null);return b.useEffect(()=>(a.coverKey?Pp(a.projectId).then(d=>f(d)).catch(d=>{console.warn(`Failed to load cover for ${a.projectId}:`,d),a.coverUrl&&f(a.coverUrl)}):a.coverUrl&&f(a.coverUrl),()=>{i&&i.startsWith("blob:")&&URL.revokeObjectURL(i)}),[a,a.coverKey,a.coverUrl]),o.jsxs("div",{className:"relative rounded-lg overflow-hidden border border-gray-800 bg-gray-950 hover:border-blue-500 transition-colors group cursor-pointer",children:[o.jsx("button",{onClick:()=>u(a.projectId),className:"w-full block text-left","aria-label":`Open project ${a.projectName}`,children:o.jsx("div",{className:"aspect-video overflow-hidden bg-gray-900 relative",children:i?o.jsx("img",{src:i,alt:a.projectName,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-200"}):o.jsx("div",{className:"w-full h-full bg-gradient-to-br from-gray-800 to-gray-900 flex items-center justify-center text-sm text-gray-400",children:o.jsx("div",{className:"text-center",children:o.jsx("div",{className:"text-xs font-medium text-gray-500",children:"No cover"})})})})}),o.jsxs("div",{className:"p-3 space-y-1",children:[o.jsx("div",{className:"text-sm font-semibold text-gray-200 truncate",children:a.projectName}),typeof a.totalPhotos=="number"&&o.jsx("div",{className:"text-xs text-gray-500",children:`${a.totalPhotos} ${a.totalPhotos===1?"photo":"photos"}`}),o.jsx("div",{className:"text-xs text-gray-600 truncate",children:a.rootPath})]})]})}const Tp="4.1.1";class kr{static instance;version;constructor(){this.version=Tp}static getInstance(){return kr.instance||(kr.instance=new kr),kr.instance}getVersion(){return this.version}getDisplayVersion(){return`v${this.version}`}isValidVersion(u){return/^\d+\.\d+\.\d+$/.test(u)}isCurrentVersionValid(){return this.isValidVersion(this.version)}getVersionComponents(){const[u,i,f]=this.version.split(".").map(Number);return{major:u,minor:i,patch:f}}compareVersions(u,i){const f=u.split(".").map(Number),d=i.split(".").map(Number);for(let p=0;p<3;p++){if(f[p]<d[p])return-1;if(f[p]>d[p])return 1}return 0}async fetchRuntimeVersion(){try{return null}catch(u){return console.warn("Error fetching runtime version:",u),null}}async getCurrentVersion(){return this.version}}const $s=kr.getInstance();function Lp({isOpen:a,onClose:u,onCreateComplete:i,onOpenProject:f,recentProjects:d=[],canClose:p=!1,errorMessage:m=null}){const[y,v]=b.useState(!1),[S,k]=b.useState($s.getDisplayVersion());b.useEffect(()=>{(async()=>{try{const z=await $s.getCurrentVersion();k(`v${z}`)}catch(z){console.warn("Failed to fetch runtime version:",z)}})()},[]);const P=typeof globalThis<"u"&&(globalThis.vitest||globalThis.__APP_VERSION__==="0.0.0"),R="showDirectoryPicker"in window,$="indexedDB"in window;return!P&&(!R||!$)?o.jsx("div",{className:"h-screen bg-gray-950 text-gray-100 flex items-center justify-center",children:o.jsxs("div",{className:"max-w-md mx-auto text-center p-6",children:[o.jsx("div",{className:"text-red-400 text-6xl mb-4",children:""}),o.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Browser Not Supported"}),o.jsx("p",{className:"text-gray-400 mb-4",children:"This app requires a modern browser with support for the File System Access API and IndexedDB."}),o.jsxs("div",{className:"text-sm text-gray-500 space-y-1",children:[!R&&o.jsx("div",{children:" File System Access API not available"}),!$&&o.jsx("div",{children:" IndexedDB not available"})]}),o.jsx("p",{className:"text-gray-400 text-sm mt-4",children:"Please use a recent version of Chrome, Edge, or another supported browser."})]})}):o.jsxs("div",{className:"h-screen bg-gray-950 text-gray-100 flex flex-col",children:[o.jsx("div",{className:"border-b border-gray-800 bg-gray-900/50 backdrop-blur-sm",children:o.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-4 flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("img",{src:"/Narrative/assets/Narrative_icon.png",alt:"Narrative",className:"w-8 h-8 rounded"}),o.jsx("h1",{className:"text-xl font-bold",children:"Narrative"})]}),o.jsx("div",{className:"px-3 py-1 bg-gray-800 text-gray-300 rounded-md text-xs font-medium tracking-wide",children:o.jsx("span",{className:"uppercase",children:S})})]})}),o.jsx("div",{className:"flex-1 flex items-center justify-center p-6",children:o.jsxs("div",{className:"w-full max-w-7xl",children:[o.jsxs("div",{className:"mb-8",children:[o.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Projects"}),o.jsx("p",{className:"text-gray-400 text-sm",children:"Create a new project or open a recent one"})]}),m&&o.jsx("div",{className:"rounded-lg border border-red-800 bg-red-950/60 px-4 py-3 text-sm text-red-200 mb-6",children:m}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 auto-rows-max",children:[o.jsxs("div",{className:"relative rounded-lg overflow-hidden border-2 border-dashed border-gray-700 bg-gray-950 hover:border-blue-500 transition-colors group cursor-pointer",children:[o.jsx("button",{onClick:()=>v(!0),className:"w-full block text-left","aria-label":"Create new project",children:o.jsx("div",{className:"aspect-video overflow-hidden bg-gray-900 relative",children:o.jsx("div",{className:"w-full h-full bg-gradient-to-br from-gray-800 to-gray-900 flex items-center justify-center group-hover:from-gray-700 group-hover:to-gray-800 transition-colors",children:o.jsx("div",{className:"w-14 h-14 rounded-full bg-gray-700 group-hover:bg-blue-500/20 flex items-center justify-center mb-2 transition-colors",children:o.jsx(fp,{className:"w-7 h-7 text-blue-400"})})})})}),o.jsxs("div",{className:"p-3 space-y-1",children:[o.jsx("div",{className:"text-sm font-semibold text-gray-200",children:"New Project"}),o.jsx("div",{className:"text-xs text-gray-500",children:"Start organizing photos"})]})]}),d.map(B=>o.jsx(Rp,{project:B,onOpen:f},B.projectId))]}),d.length===0&&o.jsx("div",{className:"text-center py-12 text-gray-500",children:o.jsx("p",{className:"text-sm",children:"No recent projects. Create one to get started."})})]})}),o.jsx(ed,{isOpen:y,onClose:()=>v(!1),onComplete:B=>{v(!1),i(B)},recentProjects:d,onSelectRecent:f})]})}function zp({isOpen:a,title:u="Loading Project",message:i="Please wait while we load your project...",progress:f=0,showProgressBar:d=!0}){const[p,m]=b.useState(0);return b.useEffect(()=>{if(f!==p){const y=setTimeout(()=>{m(f)},100);return()=>clearTimeout(y)}},[f,p]),a?o.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-gray-900 rounded-lg shadow-2xl p-8 max-w-md w-full mx-4 border border-gray-800",children:[o.jsxs("div",{className:"flex flex-col items-center gap-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute inset-0 bg-blue-500 rounded-full blur-lg opacity-20"}),o.jsx(Vs,{className:"w-12 h-12 text-blue-400 animate-spin relative"})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:u}),o.jsx("p",{className:"text-gray-400 text-sm",children:i})]})]}),d&&o.jsxs("div",{className:"mt-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-2",children:[o.jsx("span",{className:"text-xs font-medium text-gray-400",children:"Progress"}),o.jsxs("span",{className:"text-xs font-bold text-blue-400",children:[Math.round(p),"%"]})]}),o.jsx("div",{className:"w-full bg-gray-800 rounded-full h-2 overflow-hidden",children:o.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-400 h-full rounded-full transition-all duration-300 ease-out",style:{width:`${p}%`}})})]}),o.jsx("div",{className:"mt-6 text-center",children:o.jsx("p",{className:"text-xs text-gray-500 animate-pulse",children:p===100?"Almost done...":"Loading..."})})]})}):null}const Ip="modulepreload",Mp=function(a){return"/Narrative/"+a},Bc={},Fp=function(u,i,f){let d=Promise.resolve();if(i&&i.length>0){let v=function(S){return Promise.all(S.map(k=>Promise.resolve(k).then(P=>({status:"fulfilled",value:P}),P=>({status:"rejected",reason:P}))))};document.getElementsByTagName("link");const m=document.querySelector("meta[property=csp-nonce]"),y=m?.nonce||m?.getAttribute("nonce");d=v(i.map(S=>{if(S=Mp(S),S in Bc)return;Bc[S]=!0;const k=S.endsWith(".css"),P=k?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${S}"]${P}`))return;const R=document.createElement("link");if(R.rel=k?"stylesheet":Ip,k||(R.as="script"),R.crossOrigin="",R.href=S,y&&R.setAttribute("nonce",y),document.head.appendChild(R),k)return new Promise(($,B)=>{R.addEventListener("load",$),R.addEventListener("error",()=>B(new Error(`Unable to preload CSS for ${S}`)))})}))}function p(m){const y=new Event("vite:preloadError",{cancelable:!0});if(y.payload=m,window.dispatchEvent(y),!y.defaultPrevented)throw m}return d.then(m=>{for(const y of m||[])y.status==="rejected"&&p(y.reason);return u().catch(p)})},Yi=(a,u)=>u.some(i=>a instanceof i);let Hc,Vc;function $p(){return Hc||(Hc=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Ap(){return Vc||(Vc=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Gi=new WeakMap,Ai=new WeakMap,Ks=new WeakMap;function Up(a){const u=new Promise((i,f)=>{const d=()=>{a.removeEventListener("success",p),a.removeEventListener("error",m)},p=()=>{i(Kn(a.result)),d()},m=()=>{f(a.error),d()};a.addEventListener("success",p),a.addEventListener("error",m)});return Ks.set(u,a),u}function Bp(a){if(Gi.has(a))return;const u=new Promise((i,f)=>{const d=()=>{a.removeEventListener("complete",p),a.removeEventListener("error",m),a.removeEventListener("abort",m)},p=()=>{i(),d()},m=()=>{f(a.error||new DOMException("AbortError","AbortError")),d()};a.addEventListener("complete",p),a.addEventListener("error",m),a.addEventListener("abort",m)});Gi.set(a,u)}let Ji={get(a,u,i){if(a instanceof IDBTransaction){if(u==="done")return Gi.get(a);if(u==="store")return i.objectStoreNames[1]?void 0:i.objectStore(i.objectStoreNames[0])}return Kn(a[u])},set(a,u,i){return a[u]=i,!0},has(a,u){return a instanceof IDBTransaction&&(u==="done"||u==="store")?!0:u in a}};function td(a){Ji=a(Ji)}function Hp(a){return Ap().includes(a)?function(...u){return a.apply(Xi(this),u),Kn(this.request)}:function(...u){return Kn(a.apply(Xi(this),u))}}function Vp(a){return typeof a=="function"?Hp(a):(a instanceof IDBTransaction&&Bp(a),Yi(a,$p())?new Proxy(a,Ji):a)}function Kn(a){if(a instanceof IDBRequest)return Up(a);if(Ai.has(a))return Ai.get(a);const u=Vp(a);return u!==a&&(Ai.set(a,u),Ks.set(u,a)),u}const Xi=a=>Ks.get(a);function Wp(a,u,{blocked:i,upgrade:f,blocking:d,terminated:p}={}){const m=indexedDB.open(a,u),y=Kn(m);return f&&m.addEventListener("upgradeneeded",v=>{f(Kn(m.result),v.oldVersion,v.newVersion,Kn(m.transaction),v)}),i&&m.addEventListener("blocked",v=>i(v.oldVersion,v.newVersion,v)),y.then(v=>{p&&v.addEventListener("close",()=>p()),d&&v.addEventListener("versionchange",S=>d(S.oldVersion,S.newVersion,S))}).catch(()=>{}),y}const Kp=["get","getKey","getAll","getAllKeys","count"],Qp=["put","add","delete","clear"],Ui=new Map;function Wc(a,u){if(!(a instanceof IDBDatabase&&!(u in a)&&typeof u=="string"))return;if(Ui.get(u))return Ui.get(u);const i=u.replace(/FromIndex$/,""),f=u!==i,d=Qp.includes(i);if(!(i in(f?IDBIndex:IDBObjectStore).prototype)||!(d||Kp.includes(i)))return;const p=async function(m,...y){const v=this.transaction(m,d?"readwrite":"readonly");let S=v.store;return f&&(S=S.index(y.shift())),(await Promise.all([S[i](...y),d&&v.done]))[0]};return Ui.set(u,p),p}td(a=>({...a,get:(u,i,f)=>Wc(u,i)||a.get(u,i,f),has:(u,i)=>!!Wc(u,i)||a.has(u,i)}));const Yp=["continue","continuePrimaryKey","advance"],Kc={},qi=new WeakMap,nd=new WeakMap,Gp={get(a,u){if(!Yp.includes(u))return a[u];let i=Kc[u];return i||(i=Kc[u]=function(...f){qi.set(this,nd.get(this)[u](...f))}),i}};async function*Jp(...a){let u=this;if(u instanceof IDBCursor||(u=await u.openCursor(...a)),!u)return;u=u;const i=new Proxy(u,Gp);for(nd.set(i,u),Ks.set(i,Xi(u));u;)yield i,u=await(qi.get(i)||u.continue()),qi.delete(i)}function Qc(a,u){return u===Symbol.asyncIterator&&Yi(a,[IDBIndex,IDBObjectStore,IDBCursor])||u==="iterate"&&Yi(a,[IDBIndex,IDBObjectStore])}td(a=>({...a,get(u,i,f){return Qc(u,i)?Jp:a.get(u,i,f)},has(u,i){return Qc(u,i)||a.has(u,i)}}));class Xp{db=null;objectUrls=new Map;async init(){this.db||(this.db=await Wp("narrative-thumbnails",1,{upgrade(u){u.objectStoreNames.contains("thumbnails")||u.createObjectStore("thumbnails",{keyPath:"id"})}}))}async get(u){if(this.objectUrls.has(u))return this.objectUrls.get(u);await this.init();const i=await this.db.get("thumbnails",u);if(!i?.blob)return null;const f=URL.createObjectURL(i.blob);return this.objectUrls.set(u,f),f}async set(u,i){await this.init();const f=this.objectUrls.get(u);if(f){try{URL.revokeObjectURL(f)}catch{}this.objectUrls.delete(u)}await this.db.put("thumbnails",{id:u,blob:i,timestamp:Date.now()})}async clear(){await this.init(),await this.db.clear("thumbnails"),this.objectUrls.forEach(u=>{try{URL.revokeObjectURL(u)}catch{}}),this.objectUrls.clear()}}const Yc=new Xp,qp=["jpg","jpeg","png","heic","webp","mp4","mov","webm","avi","mkv"],Qs="narrative:projectState:",Zp="narrative:handles",Kt="projects",As={autoDay:!0,folderStructure:{daysFolder:"01_DAYS",archiveFolder:"98_ARCHIVE",favoritesFolder:"FAV",metaFolder:"_meta"}};function rd(){return`${Date.now().toString(36)}-${Math.random().toString(36).slice(2,8)}`}const eh=1e4;async function Ys(){if(!window.indexedDB)throw new Error("IndexedDB is not available in this environment.");return new Promise((a,u)=>{let i=!1;const f=m=>{i||(i=!0,m())},d=window.setTimeout(()=>{f(()=>u(new Error("IndexedDB open timed out.")))},eh),p=indexedDB.open(Zp,1);p.onupgradeneeded=()=>{const m=p.result;m.objectStoreNames.contains(Kt)||m.createObjectStore(Kt)},p.onsuccess=()=>{window.clearTimeout(d),f(()=>a(p.result))},p.onerror=()=>{window.clearTimeout(d),f(()=>u(p.error))},p.onblocked=()=>{window.clearTimeout(d),f(()=>u(new Error("IndexedDB open was blocked. Please close other Narrative tabs and retry.")))}})}async function ea(a,u){const i=await Ys();return new Promise((f,d)=>{const p=i.transaction(Kt,"readwrite");p.objectStore(Kt).put(u,a),p.oncomplete=()=>f(),p.onerror=()=>d(p.error)})}async function Us(a){const u=await Ys();return new Promise((i,f)=>{const p=u.transaction(Kt,"readonly").objectStore(Kt).get(a);p.onsuccess=()=>i(p.result||null),p.onerror=()=>f(p.error)})}async function th(a){const u=await Ys();return new Promise((i,f)=>{const d=u.transaction(Kt,"readwrite");d.objectStore(Kt).delete(a),d.oncomplete=()=>i(),d.onerror=()=>f(d.error)})}function nh(a){const u=a.split(".").pop()?.toLowerCase()||"";return qp.includes(u)}function rh(a){const u=a.toLowerCase();return a.startsWith(".")||a.startsWith("._")||u==="thumbs.db"||u==="desktop.ini"}async function ld(a,u=""){const i=[];for await(const[f,d]of a.entries())if(d.kind==="directory"){if(f.startsWith("."))continue;const p=await ld(d,u?`${u}/${f}`:f);i.push(...p)}else if(d.kind==="file"){if(rh(f)||!nh(f))continue;const p=u?`${u}/${f}`:f;i.push({handle:d,path:p})}return i}async function lh(a){try{if(typeof createImageBitmap<"u")return(await createImageBitmap(a)).close(),a}catch{}try{const f=(await Fp(async()=>{const{default:d}=await import("./heic2any-DLb4edze.js").then(p=>p.h);return{default:d}},[])).default;try{return await f({blob:a,toType:"image/jpeg",quality:.8})}catch(d){if(d?.message?.includes("already browser readable")||d?.message?.includes("ERR_USER")||d?.code===1)return a;console.warn(`heic2any conversion failed for ${a.name}:`,d)}}catch{console.warn("heic2any library not available, trying fallbacks")}const u=document.createElement("canvas"),i=u.getContext("2d");if(!i)return new Blob([""],{type:"image/jpeg"});try{if(typeof createImageBitmap<"u")try{const f=await createImageBitmap(a);u.width=f.width||400,u.height=f.height||300;try{i.drawImage(f,0,0)}catch{}return new Promise((d,p)=>{try{if(typeof u.toBlob=="function")u.toBlob(m=>{if(m){d(m);return}try{const v=u.toDataURL("image/jpeg",.8).split(","),S=v[0].match(/:(.*?);/),k=v[1];let P;if(typeof atob=="function"){const R=atob(k);let $=R.length;for(P=new Uint8Array($);$--;)P[$]=R.charCodeAt($)}else if(typeof Buffer<"u"){const R=Buffer.from(k,"base64");P=new Uint8Array(R.buffer,R.byteOffset,R.byteLength)}else throw new Error("No base64 decoder available");d(new Blob([P],{type:S&&S[1]||"image/jpeg"}))}catch{d(new Blob([""],{type:"image/jpeg"}))}},"image/jpeg",.8);else{const y=u.toDataURL("image/jpeg",.8).split(","),v=y[0].match(/:(.*?);/),S=y[1];let k;if(typeof atob=="function"){const P=atob(S);let R=P.length;for(k=new Uint8Array(R);R--;)k[R]=P.charCodeAt(R)}else if(typeof Buffer<"u"){const P=Buffer.from(S,"base64");k=new Uint8Array(P.buffer,P.byteOffset,P.byteLength)}else return d(new Blob([""],{type:"image/jpeg"}));d(new Blob([k],{type:v&&v[1]||"image/jpeg"}))}}catch{d(new Blob([""],{type:"image/jpeg"}))}})}catch{}try{const f=new Image,d=URL.createObjectURL(a);return f.crossOrigin="Anonymous",await new Promise((p,m)=>{f.onload=()=>p(),f.onerror=()=>m(new Error("Image load failed")),f.src=d}),u.width=f.naturalWidth||f.width||400,u.height=f.naturalHeight||f.height||300,i.drawImage(f,0,0),URL.revokeObjectURL(d),new Promise((p,m)=>{u.toBlob(y=>{if(y){p(y);return}try{const S=u.toDataURL("image/jpeg",.8).split(","),k=S[0].match(/:(.*?);/),P=S[1];let R;if(typeof atob=="function"){const $=atob(P);let B=$.length;for(R=new Uint8Array(B);B--;)R[B]=$.charCodeAt(B)}else if(typeof Buffer<"u"){const $=Buffer.from(P,"base64");R=new Uint8Array($.buffer,$.byteOffset,$.byteLength)}else{p(new Blob([""],{type:"image/jpeg"}));return}p(new Blob([R],{type:k&&k[1]||"image/jpeg"}))}catch{p(new Blob([""],{type:"image/jpeg"}))}},"image/jpeg",.8)})}catch{}return u.width=400,u.height=300,i.fillStyle="#e5e5e5",i.fillRect(0,0,400,300),i.fillStyle="#666666",i.font="bold 16px sans-serif",i.textAlign="center",i.textBaseline="middle",i.fillText("HEIC",200,140),i.font="12px sans-serif",i.fillText("Preview not available",200,165),new Promise(f=>{u.toBlob(d=>{if(d){f(d);return}f(new Blob([""],{type:"image/jpeg"}))},"image/jpeg",.8)})}catch{return new Blob([""],{type:"image/jpeg"})}}async function ta(a,u){const i=await ld(a),f=[],d=new Set;for(let p=0;p<i.length;p++){const m=i[p],y=Math.round((p+1)/i.length*100);u?.(y,`Processing ${m.handle.name}...`);const v=await m.handle.getFile(),S=v.lastModified,k=v.name,P=`${k}|${S}|${v.size}`;if(d.has(P))continue;d.add(P);const R=rd(),$=v.name.split(".").pop()?.toLowerCase()||"",B=$==="heic"||$==="heif"||v.type.toLowerCase().includes("heic");let z="";if(B)try{const J=m.path,D=await Yc.get(J);if(D)z=D;else{const ee=await lh(v);ee&&(z=URL.createObjectURL(ee),await Yc.set(J,ee))}}catch(J){console.warn(`Failed to generate preview for ${k}:`,J)}else try{z=URL.createObjectURL(v)}catch(J){console.warn(`Failed to create object URL for ${k}:`,J)}const U=Np(m.path),V=m.path.split(/[\\/]/).filter(Boolean),W=V.length>1?V.slice(0,-1):[],le=W[W.length-1]||"root";let O=null,w=null;U.isPreOrganized&&U.confidence==="high"&&(O=U.detectedDay,w=U.detectedBucket),f.push({id:R,originalName:k,currentName:k,timestamp:S,day:O,bucket:w,sequence:null,favorite:!1,rating:0,archived:!1,thumbnail:z,mimeType:v.type||(B?"image/heic":""),fileHandle:m.handle,filePath:m.path,sourceFolder:le,folderHierarchy:W,detectedDay:U.detectedDay,detectedBucket:U.detectedBucket,isPreOrganized:U.isPreOrganized,organizationConfidence:U.confidence})}return f.sort((p,m)=>p.timestamp-m.timestamp)}function sh(a){const u={};if(a.length===0)return u;let i=1,f=a[0].timestamp;const d=360*60*1e3;return u[i]=[],a.forEach(p=>{p.timestamp-f>d&&(i+=1,u[i]=[]),u[i].push(p.id),f=p.timestamp}),u}function sd(a){const u=a.photos.map(i=>({filePath:i.filePath,day:i.day,bucket:i.bucket,sequence:i.sequence,favorite:i.favorite,rating:i.rating,archived:i.archived,currentName:i.currentName,sourceFolder:i.sourceFolder,folderHierarchy:i.folderHierarchy,detectedDay:i.detectedDay,detectedBucket:i.detectedBucket,isPreOrganized:i.isPreOrganized,organizationConfidence:i.organizationConfidence,subfolderOverride:i.subfolderOverride}));return{projectName:a.projectName,rootPath:a.rootPath,settings:a.settings,dayLabels:a.dayLabels||{},dayContainers:a.dayContainers||[],lastModified:a.lastModified??Date.now(),edits:u}}function oh(a,u){const i=a.toLowerCase(),f=i.replace(/[^a-z0-9]+/g," ").trim(),d=u.toLowerCase();return!!(d&&i===d||i==="archive"||i==="archives"||i.endsWith("_archive")||i.endsWith("-archive")||i.includes("archive")||f.includes("archive"))}function od(a,u){return u?a.map(i=>i.filePath&&i.filePath.split(/[\\/]/).filter(Boolean).some(d=>oh(d,u))?{...i,archived:!0,bucket:"X"}:i):a}async function ih(a){const{dirHandle:u,projectName:i,rootLabel:f,onProgress:d}=a;if(!("requestPermission"in u))throw new Error("File System Access API is not available or supported in this environment.");let p;try{p=await u.requestPermission({mode:"read"})}catch(k){throw console.warn("Permission request failed:",k),new Error("Unable to request folder access. Please try again.")}if(p!=="granted")throw new Error("Folder access was not granted. Please allow access to create the project.");d?.(5,"Scanning folder structure...");const m=rd();d?.(10,"Collecting image files...");const y=od(await ta(u,(k,P)=>{const R=10+k*.6;d?.(R,P)}),As.folderStructure.archiveFolder);d?.(75,"Analyzing photo timestamps...");const v=sh(y);d?.(85,"Saving project data...");const S={projectName:i?.trim()||u.name,rootPath:f||u.name,photos:y,settings:As,lastModified:Date.now()};return await ea(m,u),ze.set(`${Qs}${m}`,JSON.stringify(sd(S))),d?.(95,"Project initialized successfully"),{projectId:m,photos:y,suggestedDays:v}}async function ah(a){const u=await Us(a);if(!u)throw new Error("Project folder access not available. Please reselect the folder.");if(!("requestPermission"in u))throw new Error("File System Access API is not available or supported in this environment.");let i;try{i=await u.requestPermission({mode:"read"})}catch(S){throw console.warn("Permission request failed, removing stale handle:",S),await th(a),new Error("Project folder access has expired. Please click the project again to reselect the folder.")}if(i!=="granted")throw new Error("Folder access was not granted. Please allow access to continue.");const f=ze.get(`${Qs}${a}`),d=f?JSON.parse(f):{},p=await ta(u);if(p.length===0)throw new Error("Project folder access is no longer available. Please reselect the folder.");let m=p;if(d.edits){const S=new Map;d.edits.forEach(k=>{k?.filePath&&S.set(k.filePath,k)}),m=p.map(k=>{const P=k.filePath?S.get(k.filePath):null;return P?{...k,day:P.day,bucket:P.bucket,sequence:P.sequence,favorite:P.favorite,rating:P.rating,archived:P.archived,currentName:P.currentName,subfolderOverride:P.subfolderOverride}:k})}const y=d.settings||As,v=od(m,y.folderStructure?.archiveFolder||As.folderStructure.archiveFolder);return{projectName:d.projectName||u.name,rootPath:d.rootPath||u.name,photos:v,settings:y,dayLabels:d.dayLabels||{},dayContainers:d.dayContainers||[],lastModified:d.lastModified}}async function id(a,u){ze.set(`${Qs}${a}`,JSON.stringify(sd(u)))}async function uh(a){try{ze.remove(`${Qs}${a}`)}catch{}try{const u=await Ys();await new Promise((i,f)=>{const d=u.transaction(Kt,"readwrite");d.objectStore(Kt).delete(a),d.oncomplete=()=>i(),d.onerror=()=>f(d.error)})}catch{}}const Nt="narrative:recentProjects",Cn="narrative:activeProject";function ch({photos:a,setPhotos:u,projectRootPath:i,projectName:f,projectFolderLabel:d,projectSettings:p,dayLabels:m,prevThumbnailsRef:y}){const[v,S]=b.useState([]),[k,P]=b.useState(-1),R=b.useCallback(U=>{if(!i)return;id(i,{projectName:f,rootPath:d||i,photos:U??a,settings:p,dayLabels:m}).catch(()=>{})},[i,f,d,a,p,m]),$=b.useCallback(U=>{const V=a.map(O=>({id:O.id,filePath:O.filePath,day:O.day,bucket:O.bucket,sequence:O.sequence,favorite:O.favorite,rating:O.rating,archived:O.archived,currentName:O.currentName,originalName:O.originalName,timestamp:O.timestamp,subfolderOverride:O.subfolderOverride})),W=v.slice(0,k+1);W.push(V);const le=W.slice(-30);S(le),P(le.length-1);try{const O=U.map(w=>w.thumbnail).filter(Boolean);y.current.forEach(w=>{if(w&&!O.includes(w)&&w.startsWith("blob:"))try{URL.revokeObjectURL(w)}catch{}}),y.current=O}catch{}u(U),R(U)},[v,k,a,R,y,u]),B=b.useCallback(()=>{if(k>0){const U=v[k-1],V=a.map(W=>{const le=U.find(O=>O.id===W.id);return le?{...W,...le}:W});P(k-1),u(V),R(V)}},[v,k,R,a,u]),z=b.useCallback(()=>{if(k<v.length-1){const U=v[k+1],V=a.map(W=>{const le=U.find(O=>O.id===W.id);return le?{...W,...le}:W});P(k+1),u(V),R(V)}},[v,k,R,a,u]);return{history:v,historyIndex:k,setHistory:S,setHistoryIndex:P,persistState:R,saveToHistory:$,undo:B,redo:z}}function dh({filteredPhotos:a,coverSelectionMode:u,setCoverForPhotoId:i,setCoverSelectionMode:f}){const[d,p]=b.useState(new Set),[m,y]=b.useState(null),[v,S]=b.useState(null),k=b.useRef(null),P=b.useCallback(()=>{p(new Set),y(null),S(null),k.current=null},[]),R=b.useCallback(async($,B,z,U=a)=>{if($.shiftKey&&k.current!==null&&k.current!==void 0){const V=Math.min(k.current,z),W=Math.max(k.current,z),le=U.slice(V,W+1).map(O=>O.id);p(new Set(le)),y(B),S(z),k.current=z;return}if($.metaKey||$.ctrlKey){const V=new Set(d);V.has(B)?V.delete(B):V.add(B),p(V),y(B),S(z),k.current=z;return}p(new Set([B])),y(B),S(z),k.current=z,u&&(await i(B),f(!1))},[u,a,d,i,f]);return{selectedPhotos:d,setSelectedPhotos:p,focusedPhoto:m,setFocusedPhoto:y,lastSelectedIndex:v,setLastSelectedIndex:S,lastSelectedIndexRef:k,resetSelection:P,handleSelectPhoto:R}}const hl={autoDay:!0,folderStructure:{daysFolder:"01_DAYS",archiveFolder:"98_ARCHIVE",favoritesFolder:"FAV",metaFolder:"_meta"}},fh="narrative:projectState:";function ph({debugEnabled:a,showToast:u,prevThumbnailsRef:i}){const[f,d]=b.useState([]),[p,m]=b.useState("No Project"),[y,v]=b.useState(null),[S,k]=b.useState(null),[P,R]=b.useState(hl),[$,B]=b.useState([]),[z,U]=b.useState(!1),[V,W]=b.useState(()=>!ze.get(Cn)),[le,O]=b.useState(null),[w,J]=b.useState(null),[D,ee]=b.useState(null),[Q,M]=b.useState(!1),[oe,L]=b.useState(0),[ae,I]=b.useState("Loading project..."),[X,re]=b.useState({}),[H,C]=b.useState([]),A=b.useRef(!1),j=b.useCallback(q=>{const pe=q.split(/[/\\]/).filter(Boolean);return pe[pe.length-1]||"Untitled Project"},[]),h=b.useCallback((q,pe)=>{if(!pe)return q;const Ne=new Map;return Object.entries(pe).forEach(([se,ke])=>{const Ee=Number.parseInt(se,10);Number.isNaN(Ee)||ke.forEach(De=>Ne.set(De,Ee))}),q.map(se=>({...se,day:Ne.get(se.id)??se.day}))},[]),E=b.useCallback(q=>{try{const pe=(q.photos||[]).map(Ne=>Ne.thumbnail).filter(Boolean);i.current.forEach(Ne=>{if(Ne&&!pe.includes(Ne)&&Ne.startsWith("blob:"))try{URL.revokeObjectURL(Ne)}catch{}}),i.current=pe}catch{}d(q.photos||[]),m(q.projectName||"No Project"),k(q.rootPath||null),R(q.settings||hl),re(q.dayLabels||{}),C(q.dayContainers||[])},[i]),Y=b.useCallback(q=>{try{const pe=ze.get(Nt),se=(pe?JSON.parse(pe):[]).map(Oe=>({...Oe,projectId:Oe.projectId||Oe.rootPath}));let ke=se.findIndex(Oe=>Oe.projectId===q.projectId);ke===-1&&(ke=se.findIndex(Oe=>Oe.rootPath===q.rootPath));const De={...ke!==-1?se[ke]:{},...q},je=se.filter((Oe,Ye)=>Ye!==ke),be=[De,...je].slice(0,20);ze.set(Nt,JSON.stringify(be)),B(be)}catch(pe){if(pe instanceof Error&&pe.name==="QuotaExceededError")try{const Ne=[q,...$].map((se,ke)=>{if(ke>=3&&se.coverUrl){const{coverUrl:Ee,...De}=se;return De}return se}).slice(0,20);ze.set(Nt,JSON.stringify(Ne)),B(Ne),u("Storage limit reached. Kept covers for 3 most recent projects.","info")}catch{try{const se=[q,...$.slice(0,9)].map((ke,Ee)=>{if(Ee>0&&ke.coverUrl){const{coverUrl:De,...je}=ke;return je}return ke});ze.set(Nt,JSON.stringify(se)),B(se),u("Storage critically low. Removed older project covers.","error")}catch{try{const ke=[{...q,coverUrl:void 0}];ze.set(Nt,JSON.stringify(ke)),B(ke),u("Storage full. Reset to current project only.","error")}catch{ze.remove(Nt),B([]),u("Storage exhausted. Unable to save projects.","error")}}}else u("Failed to persist recent project updates. Changes may not be saved.","error")}},[$,u]),te=b.useCallback((q,pe)=>{const Ne=new Map;return pe.forEach(se=>Ne.set(se.folderPath||se.folder,se)),q.map(se=>{if(!se.filePath||se.isPreOrganized&&se.day!=null&&se.bucket!=null)return se;const ke=se.filePath.split(/[\\/]/),Ee=ke.join("/");if(ke.length>1){const je=ke[1].match(/^D(\d{1,2})/i);if(je){const be=parseInt(je[1],10);if(!Number.isNaN(be))return{...se,day:be}}}for(const[De,je]of Ne.entries()){if(!je||je.skip||je.detectedDay==null)continue;const be=De.split(/[\\/]/).join("/");if(Ee===be||Ee.startsWith(`${be}/`))return{...se,day:je.detectedDay}}return se.day!=null?se:{...se,day:null}})},[]),ie=b.useCallback((q,pe)=>{const Ne=new Map;return pe.forEach((se,ke)=>{const Ee=Nr(se);Ee!=null&&Ne.set(se,Ee)}),q.map(se=>{if(!se.filePath||se.isPreOrganized&&se.day!=null)return se;const ke=se.filePath.split(/[\\/]/),Ee=ke.join("/"),De=ke[0],je=Ne.get(De);if(je!=null)return{...se,day:je};for(const[be,Oe]of Ne.entries()){const Ye=be.split(/[\\/]/).join("/");if(Ee===Ye||Ee.startsWith(`${Ye}/`))return{...se,day:Oe}}if(ke.length>1){const Oe=ke[1].match(/^D(\d{1,2})/i);if(Oe){const Ye=parseInt(Oe[1],10);if(!Number.isNaN(Ye))return{...se,day:Ye}}}return se})},[]),me=b.useCallback(async(q,pe)=>{const Ne=typeof performance<"u"?performance.now():Date.now();console.log("[Performance] Starting project load:",q),M(!0),L(0),I("Loading project..."),O(null);try{L(25),I("Reading project data...");const se=await ah(q);L(50),I("Processing photos...");const ke=ie(se.photos,se.dayContainers||[]),Ee={...se,photos:ke};if(L(75),I("Initializing view..."),E(Ee),v(q),U(!1),W(!1),ze.set(Cn,q),L(90),pe?.addRecent!==!1){const Oe=ze.get(Nt),yt=(Oe?JSON.parse(Oe):[]).map($e=>({...$e,projectId:$e.projectId||$e.rootPath}));let ot=yt.find($e=>$e.projectId===q);ot||(ot=yt.find($e=>$e.rootPath===q));const We=ot?.coverUrl;Y({projectName:se.projectName||"Untitled Project",projectId:q,rootPath:se.rootPath||"Unknown location",lastOpened:Date.now(),totalPhotos:se.photos?.length||0,...We&&{coverUrl:We}})}L(100),J(null);const je=(typeof performance<"u"?performance.now():Date.now())-Ne,be=ke.length;console.log("[Performance] Project loaded in:",je.toFixed(2),"ms"),console.log("[Performance] Photo count:",be),be>0&&console.log("[Performance] Time per photo:",(je/be).toFixed(2),"ms"),je>5e3&&u("Large project loaded. Performance may be slower.","info")}catch(se){const ke=se instanceof Error?se.message:"Failed to load project";console.error("Failed to load project:",se),O(ke),(ke.includes("access")&&!ke.includes("no longer available")||ke.includes("permission")||ke.includes("granted"))&&J(q),u(ke,"error"),ze.remove(Cn),W(!0)}finally{M(!1),L(0)}},[ie,E,u,Y]),ge=b.useCallback(async()=>{if(w){M(!0),L(0),I("Requesting folder access..."),O(null);try{const q=await Us(w);if(q){if(L(25),I("Re-requesting permissions..."),await q.requestPermission({mode:"read"})==="granted"){L(50),I("Loading project..."),await me(w,{addRecent:!1}),J(null);return}}else throw new Error("Project folder access is no longer available. Please reselect the folder from the start screen.");throw new Error("Folder access was not granted.")}catch(q){const pe=q instanceof Error?q.message:"Failed to retry permission";console.error("Failed to retry permission:",q),O(pe),u(pe,"error"),W(!0),J(null)}finally{M(!1),L(0)}}},[w,me,u]),ve=b.useCallback(async(q,pe)=>{M(!0),L(0),I("Initializing project..."),O(null);try{if(pe)return L(25),I("Saving folder access..."),await ea(pe,q.dirHandle),L(50),I("Loading project..."),me(pe),!0;L(5),I("Requesting folder access...");const Ne=await ih({dirHandle:q.dirHandle,projectName:q.projectName,rootLabel:q.rootPath,onProgress:(be,Oe)=>{const Ye=5+be*.789;L(Ye),I(Oe)}});L(80),I("Processing photo organization...");const se=q.mappings?.length?te(Ne.photos,q.mappings):h(Ne.photos,Ne.suggestedDays),ke=(q.mappings||[]).filter(be=>!be.skip).map(be=>be.folderPath||be.folder),Ee=q.projectName?.trim()||j(q.rootPath);let De,je;if(pe){De=pe,L(80),I("Loading existing project data...");const be=ze.get(`${fh}${pe}`),Oe=be?JSON.parse(be):{},Ye=await ta(q.dirHandle);let yt=Ye;if(Oe.edits){const ot=new Map;Oe.edits.forEach(We=>{We?.filePath&&ot.set(We.filePath,We)}),yt=Ye.map(We=>{const $e=We.filePath?ot.get(We.filePath):null;return $e?{...We,day:$e.day,bucket:$e.bucket,sequence:$e.sequence,favorite:$e.favorite,rating:$e.rating,archived:$e.archived,currentName:$e.currentName}:We})}je={projectName:Oe.projectName||Ee,rootPath:q.rootPath||q.dirHandle.name,photos:yt,settings:Oe.settings||hl,dayContainers:Oe.dayContainers||ke,dayLabels:Oe.dayLabels,lastModified:Date.now()}}else De=Ne.projectId,je={projectName:Ee,rootPath:q.rootPath||q.dirHandle.name,photos:se,settings:hl,dayContainers:ke};return L(90),I("Saving project state..."),d(se),m(Ee),v(De),k(q.rootPath||q.dirHandle.name),R(hl),U(!1),W(!1),ze.set(Cn,De),L(95),I("Updating recent projects..."),Y({projectName:Ee,projectId:De,rootPath:q.rootPath||q.dirHandle.name,lastOpened:Date.now(),totalPhotos:se.length}),L(98),I("Finalizing project..."),await id(De,je),W(!1),L(100),J(null),!0}catch(Ne){return O(Ne instanceof Error?Ne.message:"Failed to initialize project"),U(!0),W(!0),!1}finally{M(!1),L(0)}},[te,h,a,j,me,Y]);return b.useEffect(()=>{if(A.current)return;A.current=!0;try{const Ne=ze.get(Nt);if(Ne)try{const se=JSON.parse(Ne),ke=Array.isArray(se)?se.map(je=>({...je,projectId:je.projectId||je.rootPath})):[],Ee=new Map;ke.forEach(je=>{je.projectId&&!Ee.has(je.projectId)&&Ee.set(je.projectId,je)});const De=Array.from(Ee.values());JSON.stringify(De)!==JSON.stringify(se)&&ze.set(Nt,JSON.stringify(De)),console.log("Loaded recent projects:",De.map(je=>({id:je.projectId,cover:je.coverUrl?"has cover":"no cover"}))),B(De)}catch(se){console.warn("Failed to parse recent projects from storage",se),B([])}}catch{B([])}const q=ze.get(Cn),pe=typeof globalThis<"u"&&(globalThis.vitest||globalThis.__APP_VERSION__==="0.0.0");q&&(pe||"showDirectoryPicker"in window)?pe?W(!1):(async()=>{try{await Us(q)&&(J(q),O('Project needs permission to access its folder. Click "Try Again" to grant access.')),W(!0)}catch(Ne){console.warn("Error checking stored handle on startup:",Ne),W(!0)}})():W(!0)},[]),{photos:f,setPhotos:d,projectName:p,setProjectName:m,projectRootPath:y,setProjectRootPath:v,projectFolderLabel:S,setProjectFolderLabel:k,projectSettings:P,setProjectSettings:R,recentProjects:$,setRecentProjects:B,showOnboarding:z,setShowOnboarding:U,showWelcome:V,setShowWelcome:W,projectError:le,setProjectError:O,permissionRetryProjectId:w,setPermissionRetryProjectId:J,projectNeedingReselection:D,setProjectNeedingReselection:ee,loadingProject:Q,loadingProgress:oe,loadingMessage:ae,dayLabels:X,setDayLabels:re,dayContainers:H,setDayContainers:C,loadProject:me,retryProjectPermission:ge,handleOnboardingComplete:ve,updateRecentProjects:Y,applySuggestedDays:h,applyFolderMappings:te,applyDayContainers:ie}}function hh(){const[a,u]=b.useState("folders"),[i,f]=b.useState(!1),[d,p]=b.useState(!1),[m,y]=b.useState(!1),[v,S]=b.useState(null),[k,P]=b.useState(null),[R,$]=b.useState(null),[B,z]=b.useState(null),U=b.useRef({selectedRootFolder:null,selectedDay:null});return{currentView:a,setCurrentView:u,sidebarCollapsed:i,setSidebarCollapsed:f,hideAssigned:d,setHideAssigned:p,showHelp:m,setShowHelp:y,galleryViewPhoto:v,setGalleryViewPhoto:S,fullscreenPhoto:k,setFullscreenPhoto:P,selectedDay:R,setSelectedDay:$,selectedRootFolder:B,setSelectedRootFolder:z,foldersViewStateRef:U}}function mh(){const[a,u]=b.useState(null),i=b.useRef(null),f=b.useCallback(()=>{u(null),i.current&&(window.clearTimeout(i.current),i.current=null)},[]),d=b.useCallback((p,m="info",y)=>{u({message:p,tone:m,actionLabel:y?.actionLabel,onAction:y?.onAction}),i.current&&window.clearTimeout(i.current);const v=y?.durationMs??2500;i.current=window.setTimeout(()=>{u(null),i.current=null},v)},[]);return{toast:a,showToast:d,clearToast:f}}function gh(a,u,i,f){const[d,p]=b.useState(!1),[m,y]=b.useState(""),[v,S]=b.useState("idle"),[k,P]=b.useState(""),R=b.useCallback(O=>{const w=[],J=i.folderStructure.daysFolder,D=i.folderStructure.archiveFolder;let ee=O||k||"";if(!ee){const I=a.find(X=>X.filePath);if(I?.filePath&&I.folderHierarchy){const X=I.folderHierarchy.join("/"),re=I.filePath;if(X&&re.includes(X)){const H=re.lastIndexOf(X);H>0&&(ee=re.substring(0,H-1))}}if(!ee&&I?.filePath){const X=I.filePath.split("/");X.length>3&&(ee=X.slice(0,-2).join("/"))}}const Q={A:"Establishing",B:"People",C:"Culture-Detail",D:"Action-Moment",E:"Transition",M:"Mood-Food"},M={},oe=[],L=[];a.forEach(I=>{const X=I.originalName!==I.currentName,re=I.bucket&&!I.isPreOrganized,H=I.day!==null&&I.day!==I.detectedDay,C=I.archived&&!I.filePath?.includes(D);let A=!1;if(I.bucket&&I.day!==null){const h=u[I.day]||`Day ${String(I.day).padStart(2,"0")}`,E=Q[I.bucket]||I.bucket,Y=`${J}/${h}/${I.bucket}_${E}/${I.currentName}`;A=I.filePath!==Y&&!I.filePath?.includes(Y)}else if(I.archived){const h=`${D}/${I.currentName}`;A=I.filePath!==h&&!I.filePath?.includes(h)}if(X||re||H||C||A)if(I.archived)oe.push(I);else if(I.bucket){const h=I.day;M[h]||(M[h]={}),M[h][I.bucket]||(M[h][I.bucket]=[]),M[h][I.bucket].push(I)}else L.push(I)}),w.push("# Narrative Export Script"),w.push("# This script organizes your photos into day folders with buckets"),w.push("set -e"),w.push(""),w.push("# Export script with dry-run first, then safe execution with preview and confirmation."),w.push("# NOTE: Only modified/newly organized photos are included - existing organized files are left untouched."),w.push(""),ee?(w.push("# Where should organized photos be saved?"),w.push(`read -r -p "Destination folder [${ee}]: " USER_PROJECT_ROOT`),w.push(`PROJECT_ROOT="\${USER_PROJECT_ROOT:-${ee}}"`)):(w.push("# Where should organized photos be saved?"),w.push('read -r -p "Destination folder: " PROJECT_ROOT'),w.push('if [ -z "$PROJECT_ROOT" ]; then'),w.push('  echo "Error: Destination folder is required"'),w.push("  exit 1"),w.push("fi")),w.push(""),w.push("# Remove quotes if present"),w.push('PROJECT_ROOT="${PROJECT_ROOT//\\\'/}"'),w.push('PROJECT_ROOT="${PROJECT_ROOT//\\"/}"'),w.push(""),w.push("# Create destination folder if needed"),w.push('mkdir -p "$PROJECT_ROOT"'),w.push(""),w.push(`DAYS_FOLDER="${J}"`),w.push(`ARCHIVE_FOLDER="${D}"`),w.push('TARGET_DAYS_DIR="${PROJECT_ROOT}/${DAYS_FOLDER}"'),w.push('TARGET_ARCHIVE_DIR="${PROJECT_ROOT}/${ARCHIVE_FOLDER}"'),w.push(""),w.push("# Color codes for output"),w.push("RED='\\033[0;31m'"),w.push("GREEN='\\033[0;32m'"),w.push("YELLOW='\\033[1;33m'"),w.push("BLUE='\\033[0;34m'"),w.push("NC='\\033[0m' # No Color"),w.push(""),w.push('echo "${BLUE}${NC}"'),w.push('echo "${BLUE}       EXPORT SCRIPT - DRY RUN PREVIEW${NC}"'),w.push('echo "${BLUE}${NC}"'),w.push("echo"),w.push('echo "${YELLOW}Project root:${NC} ${PROJECT_ROOT}"'),w.push('echo "${YELLOW}Target days folder:${NC} ${TARGET_DAYS_DIR}"'),w.push('echo "${YELLOW}Target archive folder:${NC} ${TARGET_ARCHIVE_DIR}"'),w.push("echo"),w.push('echo "${GREEN}This is a DRY RUN - no files will be copied yet.${NC}"'),w.push('echo "${GREEN}You will be asked to confirm before any files are moved.${NC}"'),w.push("echo"),L.length>0&&(w.push('echo "${YELLOW}Root files (${NC}'+L.length+'):${NC}"'),L.forEach(I=>{I.filePath&&w.push(`echo "  cp "\${PROJECT_ROOT}/${I.filePath}"  "${I.currentName}""`)}),w.push(""));let ae=L.length+oe.length;return Object.keys(M).forEach(I=>{Object.keys(M[parseInt(I)]).forEach(X=>{ae+=M[parseInt(I)][X].length})}),w.push('echo "${YELLOW}Days with organized photos:${NC}"'),Object.keys(M).map(Number).sort((I,X)=>I-X).forEach(I=>{const X=u[I]||`Day ${String(I).padStart(2,"0")}`,re=M[I],H=Object.values(re).reduce((C,A)=>C+A.length,0);w.push(`echo "  ${X} (${H} photos)"`),Object.keys(re).sort().forEach(C=>{const A=Q[C]||C,j=re[C];w.push(`echo "     ${C}_${A} (${j.length})"`)})}),oe.length>0&&w.push('echo "  ${YELLOW}Archive ('+oe.length+')${NC}"'),w.push(""),w.push('echo "${YELLOW}Total files to copy:${NC} '+ae+'"'),w.push("echo"),w.push('echo "${YELLOW}${NC}"'),w.push('echo "${YELLOW}Ready to proceed?${NC}"'),w.push('echo "${RED}WARNING: This will copy files to your project directory.${NC}"'),w.push('echo "${YELLOW}${NC}"'),w.push("echo"),w.push('read -r -p "${YELLOW}Type \\"yes\\" to confirm and copy files (or press Ctrl+C to abort):${NC} " confirm'),w.push('if [ "$confirm" != "yes" ]; then'),w.push('  echo "${RED}Aborted - no files were copied.${NC}"'),w.push("  exit 0"),w.push("fi"),w.push(""),w.push('echo "${GREEN}${NC}"'),w.push('echo "${GREEN}Starting file copy operation...${NC}"'),w.push('echo "${GREEN}${NC}"'),w.push("echo"),L.length>0&&(L.forEach(I=>{I.filePath&&w.push(`if [ -e "${I.currentName}" ]; then echo "Skipping existing: ${I.currentName}"; else cp "\${PROJECT_ROOT}/${I.filePath}" "${I.currentName}"; fi`)}),w.push("")),w.push('mkdir -p "${DAYS_FOLDER}"'),Object.keys(M).map(Number).sort((I,X)=>I-X).forEach(I=>{const X=u[I]||`Day ${String(I).padStart(2,"0")}`,re=`${J}/${X}`,H=M[I];Object.keys(H).sort().forEach(C=>{const A=Q[C]||C,j=`${re}/${C}_${A}`,h=H[C];w.push(`mkdir -p "${j}"`),h.forEach(E=>{E.filePath&&w.push(`if [ -e "${j}/${E.currentName}" ]; then echo "Skipping existing: ${j}/${E.currentName}"; else cp "\${PROJECT_ROOT}/${E.filePath}" "${j}/${E.currentName}"; fi`)})})}),oe.length>0&&(w.push('mkdir -p "${ARCHIVE_FOLDER}"'),oe.forEach(I=>{I.filePath&&w.push(`if [ -e "${D}/${I.currentName}" ]; then echo "Skipping existing: ${D}/${I.currentName}"; else cp "\${PROJECT_ROOT}/${I.filePath}" "${D}/${I.currentName}"; fi`)})),w.push(""),w.push('echo "${GREEN}${NC}"'),w.push('echo "${GREEN} Copy operation complete!${NC}"'),w.push('echo "${GREEN}${NC}"'),w.join(`
`)},[a,u,i,f,k]),$=b.useCallback(()=>{const O=R();y(O),S("idle"),p(!0)},[R]),B=b.useCallback(()=>{p(!1)},[]),z=b.useCallback(()=>{const O=m||R(),w=new Blob([O],{type:"text/plain"}),J=URL.createObjectURL(w),D=document.createElement("a");D.href=J,D.download="narrative-export.sh",document.body.appendChild(D),D.click(),document.body.removeChild(D),URL.revokeObjectURL(J)},[m,R]),U=b.useCallback(async()=>{const O=m||R();m||y(O);try{if(!navigator?.clipboard?.writeText)throw new Error("Clipboard API unavailable");await navigator.clipboard.writeText(O),S("copied")}catch{S("failed")}},[m,R]),V=b.useCallback(()=>{S("idle")},[]),W=b.useCallback(O=>{P(O);const w=R(O);y(w)},[R]),le=b.useCallback(()=>{if(k)return k;const O=a.find(w=>w.filePath);if(O?.filePath&&O.folderHierarchy){const w=O.folderHierarchy.join("/"),J=O.filePath;if(w&&J.includes(w)){const D=J.lastIndexOf(w);if(D>0)return J.substring(0,D-1)}}if(O?.filePath){const w=O.filePath.split("/");if(w.length>3)return w.slice(0,-2).join("/")}return""},[a,k]);return{showExportScript:d,exportScriptText:m,exportCopyStatus:v,buildExportScript:R,openExportScriptModal:$,closeExportScriptModal:B,copyExportScript:U,downloadExportScript:z,resetExportCopyStatus:V,regenerateScript:W,getDetectedProjectPath:le}}function yh(a,u){if(a.timestamp!==u.timestamp)return a.timestamp-u.timestamp;const i=a.filePath||a.originalName||"",f=u.filePath||u.originalName||"",d=i.localeCompare(f);if(d!==0)return d;const p=(a.originalName||"").localeCompare(u.originalName||"");return p!==0?p:a.id.localeCompare(u.id)}function na(a,u={}){const{groupBy:i,separateVideos:f,selectedDay:d,getSubfolderGroup:p,isVideo:m}=u,y=[...a].sort(yh);if(i==="subfolder"&&d!=null&&p)return vh(y,d,p,f,m);if(i==="bucket")return xh(y,f,m);if(i==="day")return wh(y,f,m);if(f&&m){const v=y.filter(k=>!m(k)),S=y.filter(k=>m(k));return Bs([...v,...S])}return Bs(y)}function vh(a,u,i,f,d){const p=new Map;a.forEach(k=>{const P=i(k,u);p.has(P)||p.set(P,[]),p.get(P).push(k)});const m=Array.from(p.entries()).sort(([k],[P])=>k==="Day Root"?-1:P==="Day Root"?1:k.localeCompare(P)).map(([k,P])=>({label:k,photos:P})),y=[],v=[];m.forEach(k=>{const P=y.length;if(f&&d){const R=k.photos.filter(B=>!d(B)),$=k.photos.filter(B=>d(B));y.push(...R,...$)}else y.push(...k.photos);v.push({label:k.label,photos:k.photos,startIndex:P})});const S=new Map;return y.forEach((k,P)=>S.set(k.id,P)),{photos:y,indexMap:S,groups:v}}function xh(a,u,i){const f=["A","B","C","D","E","M","X",null],d=new Map;a.forEach(m=>{const y=m.bucket||null;d.has(y)||d.set(y,[]),d.get(y).push(m)});const p=[];return f.forEach(m=>{if(!d.has(m))return;const y=d.get(m);if(u&&i){const v=y.filter(k=>!i(k)),S=y.filter(k=>i(k));p.push(...v,...S)}else p.push(...y)}),Bs(p)}function wh(a,u,i){const f=new Map;a.forEach(m=>{const y=m.day??null;f.has(y)||f.set(y,[]),f.get(y).push(m)});const d=Array.from(f.keys()).sort((m,y)=>m===null?1:y===null?-1:m-y),p=[];return d.forEach(m=>{const y=f.get(m);if(u&&i){const v=y.filter(k=>!i(k)),S=y.filter(k=>i(k));p.push(...v,...S)}else p.push(...y)}),Bs(p)}function Bs(a){const u=new Map;return a.forEach((i,f)=>u.set(i.id,f)),{photos:a,indexMap:u}}function Wn(a,u){return u.get(a)??-1}function Ft(a,u,i,f){const d=Wn(a,i.indexMap);if(d===-1)return null;const p=u==="next"?1:-1;let m=d+p;if(f){for(;m>=0&&m<i.photos.length;){if(f(i.photos[m]))return i.photos[m];m+=p}return null}return m>=0&&m<i.photos.length?i.photos[m]:null}function kh(a){const{selectedPhotos:u,focusedPhoto:i,filteredPhotos:f,orderingResult:d,fullscreenPhoto:p,showHelp:m,showExportScript:y,showWelcome:v,showOnboarding:S,coverSelectionMode:k,hideAssigned:P,MECE_BUCKETS:R,onAssignBucket:$,onToggleFavorite:B,onUndo:z,onRedo:U,onSetFocusedPhoto:V,onSetSelectedPhotos:W,onSetLastSelectedIndex:le,onSetFullscreenPhoto:O,onSetShowHelp:w,onSetCoverSelectionMode:J,onSetHideAssigned:D,onToggleDebugOverlay:ee,onShowToast:Q,lastSelectedIndexRef:M}=a;b.useEffect(()=>{const oe=L=>{const ae=L.target;if(v||S||y||ae&&(ae.tagName==="INPUT"||ae.tagName==="TEXTAREA"||ae.tagName==="SELECT"||ae.isContentEditable))return;if(m){(L.key==="Escape"||L.key==="?")&&w(!1);return}if(k&&L.key==="Escape"){J(!1),Q?.("Cover selection cancelled.");return}if(L.key==="?"){w(!0);return}if(L.key==="H"&&L.shiftKey){L.preventDefault();const h=!P;D(h),Q?.(h?"Hiding assigned photos":"Showing all photos","info");return}if(L.key.toLowerCase()==="d"&&L.shiftKey&&(L.ctrlKey||L.metaKey)){L.preventDefault(),ee?.();return}if(L.key==="z"&&(L.metaKey||L.ctrlKey)){L.preventDefault(),L.shiftKey?U():z();return}const I=i||(u.size>0?Array.from(u)[0]:null);if(!I)return;const X=h=>{const E=Wn(h,d.indexMap);V(h),W(new Set([h])),le(E===-1?null:E),M&&(M.current=E===-1?null:E)};if(L.key.toLowerCase()==="f"&&!L.shiftKey&&!L.metaKey&&!L.ctrlKey&&!L.altKey){const h=u.size>0?Array.from(u):[I];B(h);return}const re=["A","B","C","D","E","M","X"],H=L.key.toUpperCase(),C=re.includes(H),A=H==="F",j=R.some(h=>h.key===H);if(C||j&&!A){L.preventDefault();const h=H;if(u.size>1){const ie=Array.from(u);$(ie,h),Q?.(`Assigned ${ie.length} photos to bucket ${h}`,"info"),W(new Set),V(null),le(null),M&&(M.current=null);return}const E=Wn(I,d.indexMap);if(E===-1)return;const Y=d.photos[E];if(!Y)return;const te=Y.bucket===h?"":h;if($([I],te),te&&!L.shiftKey){const ie=Ft(I,"next",d);ie&&X(ie.id)}return}if(L.key==="ArrowRight"){const h=Ft(I,"next",d);h&&X(h.id)}else if(L.key==="ArrowLeft"){const h=Ft(I,"prev",d);h&&X(h.id)}else if(L.key==="j"||L.key==="J"){L.preventDefault();const h=L.shiftKey?Y=>!Y.bucket:void 0,E=Ft(I,"next",d,h);E&&X(E.id)}else if(L.key==="k"||L.key==="K"){L.preventDefault();const h=L.shiftKey?Y=>!Y.bucket:void 0,E=Ft(I,"prev",d,h);E&&X(E.id)}else L.key==="Enter"||L.key===" "?(L.preventDefault(),O(I)):L.key==="Escape"&&(p?O(null):(W(new Set),V(null),le(null),M&&(M.current=null)))};return window.addEventListener("keydown",oe),()=>window.removeEventListener("keydown",oe)},[u,i,d,$,B,z,U,m,p,v,S,y,k,P,R,V,W,le,O,w,J,D,ee,Q,M])}function Nh({photos:a,persistState:u,setDayLabels:i}){const[f,d]=b.useState(null),[p,m]=b.useState(""),y=b.useCallback((k,P)=>{d(k),m(P)},[]),v=b.useCallback(k=>{i(P=>({...P,[k]:p})),u(a),d(null)},[p,u,a,i]),S=b.useCallback(()=>{d(null)},[]);return{editingDay:f,editingDayName:p,setEditingDayName:m,startEditingDay:y,saveDayName:v,cancelEditingDay:S}}function Sh({photos:a,dayLabels:u,dayContainers:i,projectSettings:f,debugEnabled:d,currentView:p,selectedDay:m,selectedRootFolder:y,hideAssigned:v}){const S=b.useMemo(()=>{const O=new Map;return a.forEach(w=>{w.day&&(O.has(w.day)||O.set(w.day,[]),O.get(w.day).push(w))}),Array.from(O.entries()).sort((w,J)=>w[0]-J[0])},[a]),k=b.useMemo(()=>S.filter(([O])=>u[O]!=null),[S,u]),P=b.useCallback(O=>O.split(/[\\/]/).filter(Boolean).join("/"),[]),R=/^(?:day|d)[\s_-]?(\d{1,2})/i,$=b.useCallback((O,w)=>{const J=(i||[]).includes(O),D=w.some(X=>X.day!==null),ee=w.some(X=>{const re=(X.filePath||X.originalName||"").split("/");return re.length>1&&/^D\d{1,2}/i.test(re[1])}),Q=S.some(([X])=>(u[X]||`Day ${String(X).padStart(2,"0")}`)===O),M=O===f?.folderStructure?.daysFolder,oe=R.test(O)||O.toLowerCase().startsWith("day"),L=D||ee||Q||M||oe;let ae=null;if(D){const X={};w.forEach(re=>{re.day!=null&&(X[re.day]=(X[re.day]||0)+1)}),Object.keys(X).length&&(ae=Number(Object.entries(X).sort((re,H)=>H[1]-re[1])[0][0]))}if(ae==null){const X=O.match(R);if(X){const re=parseInt(X[1],10);Number.isNaN(re)||(ae=re)}}const I=ae!=null?u[ae]||`Day ${String(ae).padStart(2,"0")}`:O;return{isSelected:J,isDayLike:L,dayNumber:ae,displayName:I}},[i,u,S,f]),B=b.useCallback(O=>{const w=O.map(([Q,M])=>{const oe=$(Q,M);return{folder:Q,items:M,...oe}}),J=w.filter(Q=>Q.isSelected),D=w.filter(Q=>!Q.isSelected&&!Q.isDayLike),ee=w.filter(Q=>!Q.isSelected&&Q.isDayLike);return J.sort((Q,M)=>(Q.dayNumber??999)-(M.dayNumber??999)),D.sort((Q,M)=>Q.folder.localeCompare(M.folder)),ee.sort((Q,M)=>Q.folder.localeCompare(M.folder)),{selected:J,nonDay:D,dayLike:ee}},[$]),z=b.useCallback((O,w)=>{if(w==null)return"Day Root";const D=P(O.filePath||O.originalName||"").split("/").slice(0,-1),ee=f?.folderStructure?.daysFolder;let Q=-1;if(ee){const M=P(ee),oe=D.findIndex(L=>L.toLowerCase()===M.toLowerCase());if(oe!==-1&&oe+1<D.length){const L=D[oe+1];Nr(L)===w&&(Q=oe+1)}}return Q===-1&&(Q=D.findIndex(M=>ee&&M.toLowerCase()===ee.toLowerCase()?!1:Nr(M)===w)),Q!==-1&&Q+1<D.length?D[Q+1]:"Day Root"},[P,f]),U=b.useCallback((O,w)=>O.subfolderOverride!==void 0?O.subfolderOverride??"Day Root":z(O,w),[z]),V=b.useMemo(()=>{const O=new Map;for(const w of a){if(w.archived)continue;const J=(w.filePath||w.originalName||"").split(/[\\/]/),D=J.length>1?J[0]:"(root)";O.has(D)||O.set(D,[]),O.get(D).push(w)}return Array.from(O.entries()).sort((w,J)=>w[0].localeCompare(J[0]))},[a]),W=b.useMemo(()=>{const O=new Map(V);return(i||[]).forEach(w=>{const J=P(w).split("/")[0];O.has(J)||O.set(J,[])}),Array.from(O.entries())},[V,i,P]);b.useEffect(()=>{},[d,S,u,a,i,f,V,$]);const le=b.useMemo(()=>{const O=D=>!!D.bucket||D.isPreOrganized&&!!D.detectedBucket,w=D=>!v||!O(D)&&!D.archived;let J=[];switch(p){case"days":if(m!==null){J=a.filter(D=>!D.archived&&D.day===m).filter(w);break}J=a.filter(D=>D.day!==null&&!D.archived).filter(w);break;case"folders":if(y!==null){J=a.filter(D=>{if(D.archived)return!1;const ee=P(D.filePath||D.originalName||""),Q=P(y),M=ee.split("/")[0]||"(root)";return(Q.includes("/")?ee===Q||ee.startsWith(`${Q}/`):M===Q)&&w(D)});break}if(m!==null){J=a.filter(D=>!D.archived&&D.day===m).filter(w);break}J=[];break;case"root":if(y!==null){J=a.filter(D=>!D.archived&&(P(D.filePath||D.originalName||"").split("/")[0]||"(root)")===P(y)&&w(D));break}J=[];break;case"favorites":J=a.filter(D=>D.favorite&&!D.archived).filter(w);break;case"archive":J=a.filter(D=>D.archived).filter(w);break;case"review":J=a.filter(D=>D.bucket&&!D.archived).filter(w);break;default:J=a.filter(w);break}return na(J).photos},[a,v,p,m,y,P]);return{days:S,visibleDays:k,normalizePath:P,categorizeFolder:$,sortFolders:B,getDerivedSubfolderGroup:z,getSubfolderGroup:U,rootGroups:V,displayRootGroups:W,filteredPhotos:le}}function jh({photos:a,projectRootPath:u,projectName:i,projectFolderLabel:f,setRecentProjects:d,showToast:p}){return{setCoverForPhotoId:b.useCallback(async y=>{if(!u)return;const v=a.find(S=>S.id===y);if(!v){p("Selected photo is no longer available.","error");return}try{let S;if(v.fileHandle)S=await v.fileHandle.getFile();else if(v.thumbnail)S=await(await fetch(v.thumbnail)).blob();else{p("Cannot create cover from this photo.","error");return}const k=`original (${(S.size/1024).toFixed(1)}KB)`;await Op(10);const P=await Ep(u,S,0,0),R=ze.get(Nt),B=(R?JSON.parse(R):[]).map(V=>({...V,projectId:V.projectId||V.rootPath}));let z=B.findIndex(V=>V.projectId===u);z===-1&&(z=B.findIndex(V=>V.rootPath===u));const U=B.map((V,W)=>W===z?{...V,coverKey:P,lastOpened:Date.now()}:V);z===-1&&U.unshift({projectName:i||"Untitled Project",projectId:u,rootPath:f||u,lastOpened:Date.now(),totalPhotos:a.length,coverKey:P}),ze.set(Nt,JSON.stringify(U.slice(0,20))),d(U.slice(0,20)),console.log(`Cover saved to IndexedDB (${k}):`,u),p("Cover photo updated.")}catch(S){console.error("Failed to set cover photo:",S),p("Failed to set cover photo.","error")}},[a,u,i,f,d,p])}}function Ch({photos:a,saveToHistory:u,selectedDay:i}){const f=b.useCallback((m,y,v=null)=>{const S=Array.isArray(m)?m:[m],k={},P=a.map(R=>{if(!S.includes(R.id))return R;if(!y)return{...R,bucket:null,sequence:null,archived:!1,currentName:R.originalName};const $=v||R.day||i||Math.ceil(new Date(R.timestamp).getDate()/1),B=`${$}_${y}`,z=a.filter(W=>W.day===$&&W.bucket===y).length,U=(k[B]||z)+1;k[B]=U;const V=y==="X"?R.originalName:`D${String($).padStart(2,"0")}_${y}_${String(U).padStart(3,"0")}__${R.originalName}`;return{...R,bucket:y,day:$,sequence:U,currentName:V,archived:y==="X"}});u(P)},[a,u,i]),d=b.useCallback(m=>{const y=Array.isArray(m)?m:[m],v=a.map(S=>y.includes(S.id)?{...S,day:null}:S);u(v)},[a,u]),p=b.useCallback(m=>{const y=Array.isArray(m)?m:[m],v=a.map(S=>y.includes(S.id)?{...S,favorite:!S.favorite}:S);u(v)},[a,u]);return{assignBucket:f,removeDayAssignment:d,toggleFavorite:p}}function Eh({projectRootPath:a,photosLength:u,selectedRootFolder:i,selectedDay:f,currentView:d,days:p,rootGroups:m,setSelectedDay:y,setSelectedRootFolder:v}){b.useEffect(()=>{if(!a||u===0||i!==null||f!==null||d!=="folders")return;const S=p[0]?.[0]??null;if(S!==null){y(S);return}const k=m[0]?.[0];k&&v(k)},[a,u,i,f,d,m,p,y,v])}function bh({projectRootPath:a,selectedPhotos:u,showToast:i,setCoverForPhotoId:f}){return{setCoverFromSelection:b.useCallback(async()=>{if(!a)return;if(u.size===0){i("Select a photo to set as cover.");return}if(u.size>1){i("Select a single photo to set as cover.");return}const p=Array.from(u)[0];await f(p)},[a,u,i,f])}}function Ph({handleOnboardingCompleteInternal:a,setHistory:u,setHistoryIndex:i,resetSelection:f,setSelectedDay:d,setSelectedRootFolder:p,setCurrentView:m}){return{handleOnboardingComplete:b.useCallback(async(v,S)=>{await a(v,S)&&(u([]),i(-1),f(),d(null),p(null),m("folders"))},[a,f,m,u,i,d,p])}}function _h({showWelcome:a,projectName:u,stats:i,currentVersion:f,coverSelectionMode:d,selectedPhotosCount:p,projectRootPath:m,currentView:y,hideAssigned:v,recentProjects:S,projectError:k,permissionRetryProjectId:P,loadingProject:R,onMainMenu:$,onStartCoverSelection:B,onUseCoverSelection:z,onCancelCoverSelection:U,onSelectRecentProject:V,onOpenProject:W,onDeleteProject:le,onImportTrip:O,onExportScript:w,onShowHelp:J,onRetryPermission:D,onChangeView:ee,onToggleHideAssigned:Q,onRememberFoldersViewState:M,onRestoreFoldersViewState:oe,onClearDaySelection:L}){const[ae,I]=b.useState(!1);return a?null:o.jsxs("header",{className:"border-b border-gray-800 bg-gray-900",children:[o.jsxs("div",{className:"flex items-center justify-between px-6 py-3",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("img",{src:"/Narrative/assets/Narrative_icon.png",alt:"Narrative",className:"w-8 h-8 rounded"}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-lg font-semibold text-gray-100",children:u}),o.jsxs("p",{className:"text-xs text-gray-400",children:[i.sorted," sorted  ",i.root," root  ",i.favorites," favorites"]})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-xs text-gray-500",children:f}),o.jsx("button",{onClick:()=>{I(!1),$()},className:"px-3 py-1 bg-gray-800 hover:bg-gray-700 rounded text-sm font-medium",title:"Back to the main menu",children:"Main Menu"}),m&&o.jsx("button",{onClick:B,className:`px-3 py-1 rounded text-sm font-medium ${d?"bg-yellow-200 text-yellow-900":"bg-gray-800 hover:bg-gray-700 text-gray-100"}`,title:"Set cover from selected photo",children:d?"Selecting":"Set Cover"}),d&&o.jsxs("div",{className:"px-3 py-1 bg-yellow-50 text-yellow-900 rounded text-sm flex items-center gap-3",children:[o.jsx("span",{children:"Select a photo to set as cover"}),p===1&&o.jsx("button",{onClick:z,className:"underline",children:"Use selection"}),o.jsx("button",{onClick:U,className:"underline",children:"Cancel"})]}),o.jsxs("div",{className:"relative",children:[o.jsxs("button",{onClick:()=>I(X=>!X),className:"px-3 py-1 bg-gray-800 hover:bg-gray-700 rounded text-sm font-medium flex items-center gap-1",title:"Open recent projects","aria-expanded":ae,children:["Projects",o.jsx(Xc,{className:"w-4 h-4"})]}),ae&&o.jsxs("div",{className:"absolute right-0 mt-2 w-72 rounded-lg border border-gray-800 bg-gray-900 shadow-xl z-20",children:[o.jsx("div",{className:"px-3 py-2 text-xs uppercase tracking-wide text-gray-400 border-b border-gray-800",children:"Recent Projects"}),S.length===0?o.jsx("div",{className:"px-3 py-3 text-sm text-gray-400",children:"No recent projects yet."}):o.jsx("div",{className:"max-h-64 overflow-y-auto",children:S.map(X=>o.jsxs("button",{onClick:()=>{I(!1),V(X.projectId)},className:"w-full text-left px-3 py-2 hover:bg-gray-800",children:[o.jsx("div",{className:"text-sm text-gray-100",children:X.projectName}),o.jsx("div",{className:"text-xs text-gray-500 truncate",children:X.rootPath})]},X.projectId))}),o.jsx("div",{className:"border-t border-gray-800",children:o.jsx("button",{onClick:()=>{I(!1),W()},className:"w-full text-left px-3 py-2 text-sm text-blue-300 hover:bg-gray-800",children:"Open Project"})})]})]}),m&&o.jsx("button",{onClick:le,className:"px-3 py-1 bg-red-700 hover:bg-red-800 rounded text-sm font-medium",title:"Delete project",children:"Delete"}),o.jsxs("button",{onClick:O,className:"px-3 py-1 bg-blue-600 hover:bg-blue-700 rounded text-sm font-medium flex items-center gap-1",title:"Import existing trip folder",disabled:R,children:[R?o.jsx(Vs,{className:"w-4 h-4 animate-spin"}):o.jsx(Zc,{className:"w-4 h-4"}),"Import Trip"]}),o.jsx("button",{onClick:w,className:"px-3 py-1 bg-gray-800 hover:bg-gray-700 rounded text-sm font-medium",title:"Export rename script",disabled:i.total===0,children:"Export Script"}),o.jsx("button",{onClick:J,className:"p-2 hover:bg-gray-800 rounded",title:"Show shortcuts (?)",children:"?"})]})]}),o.jsx("div",{className:"flex gap-1 px-6 pb-2",children:[{id:"folders",label:"Folders",count:i.root},{id:"favorites",label:"Favorites",count:i.favorites},{id:"archive",label:"Archive",count:i.archived},{id:"review",label:"Review",count:i.sorted}].map(X=>o.jsxs("button",{onClick:()=>{y==="folders"&&M(),ee(X.id),X.id==="folders"?oe():L()},className:`px-4 py-2 rounded-t text-sm font-medium transition-colors ${y===X.id?"bg-gray-950 text-blue-400":"text-gray-400 hover:text-gray-200"}`,children:[X.label," ",X.count>0&&o.jsxs("span",{className:"text-xs opacity-60",children:["(",X.count,")"]})]},X.id))}),o.jsxs("div",{className:"flex flex-wrap items-center gap-2 px-6 pb-3",children:[v&&o.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-blue-600/20 border border-blue-500/30 rounded-lg",children:[o.jsx("span",{className:"text-xs text-blue-300",children:"Skip Assigned: ON"}),o.jsx("kbd",{className:"text-xs text-blue-200",children:"Shift+H to toggle"})]}),o.jsx("button",{onClick:Q,className:`px-3 py-1.5 rounded text-sm font-medium transition-colors ${v?"bg-blue-600 text-white":"bg-gray-800 text-gray-300 hover:bg-gray-700"}`,children:v?"Show All":"Hide Assigned"})]}),k&&o.jsx("div",{className:"mx-6 mb-3 rounded-lg border border-red-800 bg-red-950/60 px-4 py-3",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-red-200",children:k}),P&&o.jsx("button",{onClick:D,className:"ml-3 px-3 py-1 bg-red-700 hover:bg-red-600 text-white text-xs rounded transition-colors",children:"Try Again"})]})})]})}function Dh({currentView:a,sidebarCollapsed:u,onCollapseSidebar:i,onExpandSidebar:f,visibleDays:d,selectedDay:p,selectedRootFolder:m,onSelectDay:y,onSelectRootFolder:v,editingDay:S,editingDayName:k,onChangeEditingDayName:P,onStartEditingDay:R,onSaveDayName:$,onCancelEditingDay:B,onClearSelectedDay:z,days:U,dayLabels:V,dayContainers:W,photos:le,normalizePath:O,rootGroups:w,displayRootGroups:J,sortFolders:D,projectSettings:ee,debugEnabled:Q}){return a==="days"&&u?o.jsx("button",{onClick:f,className:"w-12 border-r border-gray-800 bg-gray-900 flex items-center justify-center hover:bg-gray-800 transition-colors","aria-label":"Expand sidebar",title:"Expand sidebar",children:o.jsx(Is,{className:"w-4 h-4 text-gray-400 rotate-180"})}):a==="days"?o.jsx("aside",{className:"w-48 border-r border-gray-800 bg-gray-900 overflow-y-auto",children:o.jsxs("div",{className:"p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h3",{className:"text-xs font-semibold text-gray-400 uppercase",children:"Days"}),o.jsx("button",{onClick:i,className:"p-1 hover:bg-gray-800 rounded","aria-label":"Collapse sidebar",title:"Collapse sidebar",children:o.jsx(Is,{className:"w-4 h-4 text-gray-400"})})]}),o.jsx("div",{className:"space-y-1",children:d.map(([M,oe])=>o.jsxs("div",{role:"button",tabIndex:0,onClick:()=>{v(null),y(M)},onKeyDown:L=>{L.key==="Enter"&&(v(null),y(M))},className:`w-full text-left px-3 py-2 rounded text-sm transition-colors ${p===M?"bg-blue-600 text-white":"hover:bg-gray-800 text-gray-300"}`,children:[o.jsx("div",{className:"flex items-center justify-between",children:S===M?o.jsxs("div",{className:"flex items-center gap-2 w-full",children:[o.jsx("input",{value:k,onChange:L=>P(L.target.value),className:"w-full px-2 py-1 rounded bg-gray-800 text-sm text-gray-100"}),o.jsx("button",{onClick:L=>{L.stopPropagation(),$(M)},className:"p-1 bg-green-600 rounded","aria-label":"Save day name",children:o.jsx(Ki,{className:"w-4 h-4"})}),o.jsx("button",{onClick:L=>{L.stopPropagation(),B()},className:"p-1 bg-gray-800 rounded","aria-label":"Cancel",children:o.jsx(rn,{className:"w-4 h-4"})})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"font-medium",children:V[M]||`Day ${String(M).padStart(2,"0")}`}),o.jsxs("div",{className:"flex items-center gap-2",children:[p===M&&o.jsx("button",{onClick:L=>{L.stopPropagation(),z()},className:"px-2 py-0.5 rounded bg-gray-800 text-xs text-gray-300 hover:text-white","aria-label":"Clear day selection",title:"Clear day selection",children:"Clear"}),o.jsx("button",{onClick:L=>{L.stopPropagation(),R(M,V[M]||`Day ${String(M).padStart(2,"0")}`)},className:"p-1","aria-label":`Edit day ${M}`,children:o.jsx(Wi,{className:"w-4 h-4 text-gray-400"})})]})]})}),o.jsxs("div",{className:"text-xs opacity-70",children:[oe.length," photos"]})]},M))})]})}):a!=="folders"?null:o.jsx("aside",{className:"w-48 border-r border-gray-800 bg-gray-900 overflow-y-auto",children:o.jsxs("div",{className:"p-4",children:[o.jsx("h3",{className:"text-xs font-semibold text-gray-400 uppercase mb-3",children:"Days"}),o.jsx("div",{className:"space-y-1 mb-4",children:(()=>{const M=new Map,oe=W||[],L=[],ae=[];oe.forEach(j=>{const h=O(j);h.includes("/")?ae.push(h):L.push(h)});const I=j=>{const h=O(j);return le.filter(E=>{const Y=O(E.filePath||E.originalName||"");return Y===h||Y.startsWith(`${h}/`)})};U.forEach(([j,h])=>{M.has(j)||M.set(j,{dayNumber:j,photos:h,folderName:null})}),ae.forEach(j=>{const h=j.split("/").slice(-1)[0],E=Nr(h);E==null||M.has(E)||M.set(E,{dayNumber:E,photos:I(j),folderName:j})});const X=ee?.folderStructure?.daysFolder;if(X){const j=O(X),h=new Map;le.forEach(E=>{const te=O(E.filePath||E.originalName||"").split("/");if(te.length<2||te[0]!==j)return;const ie=Nr(te[1]);ie!=null&&(h.has(ie)||h.set(ie,[]),h.get(ie).push(E))}),h.forEach((E,Y)=>{M.has(Y)||M.set(Y,{dayNumber:Y,photos:E,folderName:`${j}/${V[Y]||`Day ${String(Y).padStart(2,"0")}`}`})})}const re=D(J),H=[...re.selected,...re.nonDay,...re.dayLike];Q&&console.debug("[PhotoOrganizer] Folder categorization:",{selected:re.selected.map(j=>j.folder),nonDay:re.nonDay.map(j=>j.folder),dayLike:re.dayLike.map(j=>j.folder)}),w.forEach(([j,h])=>{const E=H.find(Y=>Y.folder===j);if(E&&E.isDayLike&&E.dayNumber!==null&&!M.has(E.dayNumber)){const Y=h.filter(te=>te.day===E.dayNumber||te.day===null);M.set(E.dayNumber,{dayNumber:E.dayNumber,photos:Y,folderName:j})}});const C=Array.from(M.values()).sort((j,h)=>j.dayNumber-h.dayNumber),A=L.filter(j=>H.find(E=>E.folder===j)?.dayNumber===null);return o.jsxs(o.Fragment,{children:[C.map(j=>o.jsxs("div",{role:"button",tabIndex:0,onClick:()=>{v(null),y(j.dayNumber)},onKeyDown:h=>{h.key==="Enter"&&(v(null),y(j.dayNumber))},className:`w-full text-left px-3 py-2 rounded text-sm transition-colors ${p===j.dayNumber?"bg-blue-600 text-white":"hover:bg-gray-800 text-gray-300"}`,children:[o.jsx("div",{className:"flex items-center justify-between",children:S===j.dayNumber?o.jsxs("div",{className:"flex items-center gap-2 w-full",children:[o.jsx("input",{value:k,onChange:h=>P(h.target.value),className:"w-full px-2 py-1 rounded bg-gray-800 text-sm text-gray-100"}),o.jsx("button",{onClick:h=>{h.stopPropagation(),$(j.dayNumber)},className:"p-1 bg-green-600 rounded","aria-label":"Save day name",children:o.jsx(Ki,{className:"w-4 h-4"})}),o.jsx("button",{onClick:h=>{h.stopPropagation(),B()},className:"p-1 bg-gray-800 rounded","aria-label":"Cancel",children:o.jsx(rn,{className:"w-4 h-4"})})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"font-medium",children:V[j.dayNumber]||`Day ${String(j.dayNumber).padStart(2,"0")}`}),o.jsx("div",{className:"flex items-center gap-2",children:o.jsx("button",{onClick:h=>{h.stopPropagation(),R(j.dayNumber,V[j.dayNumber]||`Day ${String(j.dayNumber).padStart(2,"0")}`)},className:"p-1","aria-label":`Edit day ${j.dayNumber}`,children:o.jsx(Wi,{className:"w-4 h-4 text-gray-400"})})})]})}),o.jsxs("div",{className:"text-xs opacity-70",children:[j.photos.length," photos"]})]},`day-${j.dayNumber}`)),A.map(j=>o.jsxs("div",{role:"button",tabIndex:0,onClick:()=>{v(j),y(null)},className:`w-full text-left px-3 py-2 rounded text-sm transition-colors ${m===j?"bg-blue-600 text-white":"hover:bg-gray-800 text-gray-300"}`,children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("div",{className:"font-medium",children:j}),o.jsx("div",{className:"text-xs px-2 py-0.5 rounded bg-gray-700 text-gray-300",children:"Container"})]}),o.jsxs("div",{className:"text-xs opacity-70",children:[w.find(([h])=>h===j)?.[1].length||0," photos"]})]},`container-${j}`))]})})()}),o.jsx("h3",{className:"text-xs font-semibold text-gray-400 uppercase mb-3",children:"Other"}),o.jsx("div",{className:"space-y-1",children:(()=>{const{selected:M,nonDay:oe}=D(J),L=ee?.folderStructure?.daysFolder,ae=[];if(L){const X=O(L),re=new Map;le.forEach(H=>{if(H.archived)return;const A=O(H.filePath||H.originalName||"").split("/");if(A.length<3||A[0]!==X||Nr(A[1])!=null)return;const h=A[1],E=`${X}/${h}`;re.has(E)||re.set(E,[]),re.get(E).push(H)}),re.forEach((H,C)=>{ae.push({key:C,label:C,items:H})})}const I=[...oe.map(X=>({key:X.folder,label:X.folder,items:X.items})),...ae];return o.jsxs(o.Fragment,{children:[I.map(X=>o.jsxs("div",{role:"button",tabIndex:0,onClick:()=>{v(X.key),y(null)},className:`w-full text-left px-3 py-2 rounded text-sm transition-colors ${m===X.key?"bg-blue-600 text-white":"hover:bg-gray-800 text-gray-300"}`,children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("div",{className:"font-medium",children:X.label}),o.jsx("div",{className:"flex gap-2"})]}),o.jsxs("div",{className:"text-xs opacity-70",children:[X.items.length," photos (",X.items.filter(re=>re.day===null).length," ","unsorted)"]})]},X.key)),I.length===0&&o.jsx("div",{className:"text-xs text-gray-400",children:"No other folders"})]})})()})]})})}const Oh=async a=>{try{const u=await a.getFile();return new Promise(i=>{const f=document.createElement("video"),d=document.createElement("canvas"),p=d.getContext("2d"),m=()=>{d.width=f.videoWidth,d.height=f.videoHeight,f.currentTime=0},y=()=>{if(p){p.drawImage(f,0,0);const v=d.toDataURL("image/jpeg",.8);f.removeEventListener("loadedmetadata",m),f.removeEventListener("seeked",y),i(v)}};f.addEventListener("loadedmetadata",m),f.addEventListener("seeked",y),f.src=URL.createObjectURL(u),f.load(),setTimeout(()=>{f.removeEventListener("loadedmetadata",m),f.removeEventListener("seeked",y),i(null)},2e3)})}catch(u){return console.error("Failed to generate video thumbnail:",u),null}},Rh=({photos:a,currentPhotoId:u,onSelectPhoto:i,visibleCount:f=7})=>{const d=b.useRef(null),p=b.useRef(null),[m,y]=b.useState({});b.useEffect(()=>{(async()=>{const U=a.filter(V=>V.mimeType?.startsWith("video/")&&!m[V.id]);for(const V of U)if(V.fileHandle){const W=await Oh(V.fileHandle);y(le=>({...le,[V.id]:W}))}})()},[a]),b.useEffect(()=>{if(p.current&&d.current){const z=d.current,U=p.current,V=z.getBoundingClientRect(),W=U.getBoundingClientRect();(W.left<V.left||W.right>V.right)&&U.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})}},[u]);const v=z=>{if(d.current){const U=d.current.clientWidth*.7;d.current.scrollBy({left:z==="right"?U:-U,behavior:"smooth"})}},S=a.findIndex(z=>z.id===u),k=S>0,P=S<a.length-1,R=a.filter(z=>!z.mimeType?.startsWith("video/")),$=a.filter(z=>z.mimeType?.startsWith("video/")),B=(z,U)=>{const V=z.id===u,W=z.bucket?{A:"bg-blue-500",B:"bg-purple-500",C:"bg-green-500",D:"bg-orange-500",E:"bg-yellow-500",M:"bg-indigo-500",X:"bg-gray-500"}[z.bucket]||"bg-gray-500":null,le=z.mimeType?.startsWith("video/")&&m[z.id]||z.thumbnail;return o.jsxs("button",{ref:V?p:null,onClick:()=>i(z.id),className:`relative flex-shrink-0 group ${V?"ring-4 ring-blue-500 shadow-xl scale-110":"hover:ring-2 hover:ring-gray-600"} transition-all duration-200 rounded-lg overflow-hidden`,style:{width:"120px",height:"90px"},"aria-label":`${z.currentName}${V?" (current)":""}`,"aria-current":V?"true":void 0,children:[le?o.jsx("img",{src:le,alt:z.currentName,className:"w-full h-full object-cover"}):o.jsx("div",{className:"w-full h-full bg-gray-800 flex items-center justify-center",children:o.jsx("span",{className:"text-xs text-gray-500 text-center px-2 break-words",children:z.currentName})}),z.mimeType?.startsWith("video/")&&o.jsx("div",{className:"absolute top-1 left-1 bg-black/70 rounded p-1",children:o.jsx(pp,{className:"w-3 h-3 text-white"})}),W&&o.jsx("div",{className:`absolute top-1 right-1 ${W} text-white text-xs font-bold rounded px-1.5 py-0.5 shadow-lg`,children:z.bucket}),z.favorite&&o.jsx("div",{className:"absolute bottom-1 right-1 bg-yellow-500 text-white text-xs rounded-full p-1",children:o.jsx("svg",{className:"w-3 h-3 fill-current",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:o.jsx("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})})}),!V&&o.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:o.jsxs("span",{className:"text-white text-xs font-medium",children:["#",U+1]})}),V&&o.jsx("div",{className:"absolute inset-0 pointer-events-none",children:o.jsx("div",{className:"absolute inset-0 bg-blue-500/10"})})]},z.id)};return o.jsxs("div",{className:"relative bg-gray-900 border-t border-gray-800",children:[k&&o.jsx("button",{onClick:()=>v("left"),className:"absolute left-2 top-1/2 -translate-y-1/2 z-10 p-2 bg-gray-950/80 hover:bg-gray-800 rounded-lg text-gray-300 hover:text-white transition-colors shadow-lg","aria-label":"Scroll left",children:o.jsx(Is,{className:"w-5 h-5"})}),o.jsxs("div",{ref:d,className:"flex items-center gap-3 px-12 py-4 overflow-x-auto scrollbar-thin scrollbar-thumb-gray-700 scrollbar-track-gray-900",style:{scrollbarWidth:"thin"},children:[R.length>0&&o.jsxs(o.Fragment,{children:[R.map((z,U)=>B(z,U)),$.length>0&&o.jsx("div",{className:"h-20 border-l border-gray-700 mx-2"})]}),$.length>0&&o.jsx("div",{className:"flex gap-3",children:$.map((z,U)=>{const V=a.findIndex(W=>W.id===z.id);return B(z,V)})})]}),P&&o.jsx("button",{onClick:()=>v("right"),className:"absolute right-2 top-1/2 -translate-y-1/2 z-10 p-2 bg-gray-950/80 hover:bg-gray-800 rounded-lg text-gray-300 hover:text-white transition-colors shadow-lg","aria-label":"Scroll right",children:o.jsx(qc,{className:"w-5 h-5"})}),o.jsxs("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 bg-gray-950/80 px-3 py-1 rounded-full text-xs text-gray-300",children:[S+1," / ",a.length]})]})},Th=({photo:a,filteredPhotos:u,orderingResult:i,onClose:f,onNavigate:d,onToggleFavorite:p,onAssignBucket:m,onAssignDay:y,selectedBucket:v,selectedDay:S,buckets:k,dayLabels:P={},onShowToast:R})=>{const[$,B]=b.useState(Wn(a.id,i.indexMap)),[z,U]=b.useState(null),[V,W]=b.useState(!1),[le,O]=b.useState(null),[w,J]=b.useState(!0),[D,ee]=b.useState(!0),Q=b.useRef(null);b.useEffect(()=>{const C=Wn(a.id,i.indexMap);C!==-1&&C!==$&&B(C)},[i.indexMap,a.id,$]);const M=i.photos[$]||a,oe=b.useCallback(C=>!C.bucket&&!C.archived,[]),L=i.photos.filter(oe).length,ae=L;b.useEffect(()=>(O(null),(async()=>{z&&(M.fileHandle&&Q.current===z||!M.fileHandle&&M.thumbnail===z)||(W(!0),Q.current=null);try{if(M.fileHandle){const j=await M.fileHandle.getFile(),h=URL.createObjectURL(j);Q.current=h,U(h)}else M.thumbnail?U(M.thumbnail):O("No image data available")}catch(j){console.error("Failed to load full resolution image:",j),M.thumbnail?U(M.thumbnail):O("Failed to load image")}finally{W(!1)}})(),()=>{if(Q.current&&Q.current.startsWith("blob:"))try{URL.revokeObjectURL(Q.current)}catch{}}),[M.id,M.fileHandle,M.thumbnail]),b.useEffect(()=>{const A=setTimeout(async()=>{const j=Math.min($+1,i.photos.length-1),h=Math.max($-1,0),E=[j,h].filter(Y=>Y!==$);for(const Y of E){const te=i.photos[Y];if(te?.fileHandle)try{await te.fileHandle.getFile()}catch{}}},100);return()=>clearTimeout(A)},[$,u]);const I=b.useCallback(C=>{const A=Ft(M.id,C,i);if(!A)return;const j=Wn(A.id,i.indexMap);j!==-1&&(B(j),d(A.id))},[M.id,i,d]),X=b.useCallback(C=>{const A=Wn(C,i.indexMap);A!==-1&&A!==$&&(B(A),d(C))},[i.indexMap,$,d]),re=b.useCallback(C=>{const A=i.photos[$];if(A)if(C.key==="Escape")C.preventDefault(),f();else if(C.key==="ArrowRight")C.preventDefault(),I("next");else if(C.key==="ArrowLeft")C.preventDefault(),I("prev");else if(C.key===" "||C.key.toLowerCase()==="n"){C.preventDefault();const j=Ft(A.id,"next",i,oe);j?(d(j.id),R?.(`${Math.max(ae-1,0)} unassigned remaining`,"info",{durationMs:1e3})):R?.("No more unassigned photos","info")}else if(C.key==="f"||C.key==="F")C.preventDefault(),p(A.id);else if(C.key.toLowerCase()==="x")C.preventDefault(),m(A.id,"X");else{const j=C.key.toUpperCase();if(["A","B","C","D","E","M"].includes(j)){C.preventDefault();const E=A.bucket===j?"":j;if(m(A.id,E),E){const Y=Ft(A.id,"next",i,oe);Y&&d(Y.id)}}}},[$,i,f,I,p,m,ae,oe,d,R]);b.useEffect(()=>(window.addEventListener("keydown",re),()=>window.removeEventListener("keydown",re)),[re]);const H=k.find(C=>C.key===M.bucket);return o.jsxs("div",{className:"fixed inset-0 bg-black z-40 flex flex-col",children:[o.jsxs("div",{className:"flex items-center justify-between px-6 py-3 border-b border-gray-800 bg-gray-900/95 backdrop-blur",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-100",children:"Gallery View"}),o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("div",{className:"text-sm text-gray-400 text-right",children:[o.jsxs("div",{children:[$+1," / ",i.photos.length]}),L>0&&o.jsxs("div",{className:"text-xs text-blue-300",children:["(",L," unassigned)"]})]}),o.jsx("button",{onClick:f,className:"p-2 hover:bg-gray-800 rounded-lg transition-colors","aria-label":"Close gallery view",children:o.jsx(rn,{className:"w-5 h-5"})})]})]}),o.jsxs("div",{className:"flex-1 flex items-center justify-center bg-gray-950 overflow-hidden relative",children:[V&&o.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-900/50 z-10",children:o.jsxs("div",{className:"text-center",children:[o.jsx(Vs,{className:"w-12 h-12 animate-spin text-blue-400 mx-auto mb-3"}),o.jsx("p",{className:"text-sm text-gray-400",children:"Loading image..."})]})}),le&&o.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-900/50 z-10",children:o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-sm text-red-400 mb-2",children:le}),o.jsxs("p",{className:"text-xs text-gray-500",children:["File: ",M.currentName]})]})}),z&&o.jsx("div",{className:"relative w-full h-full flex items-center justify-center p-4",children:M.mimeType?.startsWith("video/")?o.jsx("video",{src:z,className:"max-w-full max-h-full object-contain rounded-lg shadow-2xl",controls:!0,autoPlay:!0,muted:!0}):o.jsx("img",{src:z,alt:M.currentName,className:"max-w-full max-h-full object-contain rounded-lg shadow-2xl"})}),o.jsxs("div",{className:"absolute bottom-4 right-4 flex flex-col items-end gap-2",children:[H&&o.jsxs("div",{className:`${H.color} text-white px-4 py-2 rounded-lg shadow-xl flex items-center gap-2`,children:[o.jsx("span",{className:"text-xl font-bold",children:H.key}),o.jsxs("div",{className:"text-left",children:[o.jsx("div",{className:"text-sm font-semibold",children:H.label}),o.jsx("div",{className:"text-xs opacity-90",children:H.description})]})]}),M.day&&o.jsxs("div",{className:"bg-gray-900/90 backdrop-blur text-white px-4 py-2 rounded-lg shadow-xl",children:[o.jsx("div",{className:"text-xs text-gray-400",children:"Day"}),o.jsx("div",{className:"text-sm font-semibold",children:P[M.day]||`Day ${String(M.day).padStart(2,"0")}`})]}),M.favorite&&o.jsxs("div",{className:"bg-yellow-500 text-white px-3 py-2 rounded-lg shadow-xl flex items-center gap-2",children:[o.jsx(Ms,{className:"w-4 h-4 fill-current"}),o.jsx("span",{className:"text-sm font-semibold",children:"Favorite"})]})]}),o.jsxs("div",{className:"absolute top-4 left-4 bg-gray-900/80 backdrop-blur rounded-lg shadow-lg overflow-hidden flex flex-col",children:[o.jsxs("button",{onClick:()=>J(!w),className:"flex items-center justify-between px-3 py-2 text-xs text-gray-300 hover:bg-gray-800 transition-colors border-b border-gray-700",children:[o.jsx("span",{className:"font-semibold",children:"Quick Actions"}),w?o.jsx(dp,{className:"w-4 h-4"}):o.jsx(Xc,{className:"w-4 h-4"})]}),w&&o.jsxs("div",{className:"px-3 py-2 space-y-1",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-800 rounded text-[10px]",children:""}),o.jsx("span",{children:"Navigate"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-800 rounded text-[10px]",children:"A-E,M,X"}),o.jsx("span",{children:"Assign"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-800 rounded text-[10px]",children:"F"}),o.jsx("span",{children:"Favorite"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-800 rounded text-[10px]",children:"Esc"}),o.jsx("span",{children:"Exit"})]})]})]}),o.jsxs("div",{className:`absolute top-4 bottom-4 right-0 bg-gray-900/90 backdrop-blur rounded-l-lg shadow-2xl overflow-hidden flex transition-all duration-300 ${D?"w-72":"w-10"}`,children:[o.jsx("button",{onClick:()=>ee(!D),className:"flex-shrink-0 w-10 flex items-center justify-center text-gray-300 hover:bg-gray-800 transition-colors border-r border-gray-700",title:D?"Hide categories":"Show categories",children:o.jsxs("div",{className:"flex flex-col items-center gap-1",children:[D?o.jsx(qc,{className:"w-5 h-5"}):o.jsx(Is,{className:"w-5 h-5"}),!D&&o.jsx("div",{className:"transform -rotate-90 text-[10px] font-semibold whitespace-nowrap mt-2",children:"MECE"})]})}),D&&o.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[o.jsxs("div",{className:"px-4 py-3 border-b border-gray-700",children:[o.jsx("h3",{className:"text-sm font-semibold text-gray-200",children:"MECE Categories"}),o.jsx("p",{className:"text-[10px] text-gray-400 mt-0.5",children:"Press key to assign bucket"})]}),o.jsx("div",{className:"flex-1 px-3 py-3 space-y-2.5 overflow-y-auto",children:k.map(C=>o.jsxs("div",{className:`${C.color} text-white px-3 py-2.5 rounded-lg text-xs shadow-md hover:shadow-lg transition-shadow cursor-pointer`,onClick:()=>{const A=M.bucket===C.key?"":C.key;m(M.id,A)},children:[o.jsxs("div",{className:"font-bold text-sm flex items-center justify-between",children:[o.jsxs("span",{children:[C.key," - ",C.label]}),M.bucket===C.key&&o.jsx("span",{className:"text-xs bg-white/20 px-2 py-0.5 rounded",children:"Active"})]}),o.jsx("div",{className:"opacity-90 text-[11px] mt-1",children:C.description})]},C.key))})]})]})]}),o.jsx(Rh,{photos:i.photos,currentPhotoId:M.id,onSelectPhoto:X})]})};function Lh(a){let u=a;for(;u;){if(u.dir)return u.dir==="rtl";u=u.parentElement}return!1}function zh(a,u){const[i,f]=b.useState(u==="rtl");return b.useLayoutEffect(()=>{a&&(u||f(Lh(a)))},[u,a]),i}const Hs=typeof window<"u"?b.useLayoutEffect:b.useEffect;function Gc(a){if(a!==void 0)switch(typeof a){case"number":return a;case"string":{if(a.endsWith("px"))return parseFloat(a);break}}}function Ih({box:a,defaultHeight:u,defaultWidth:i,disabled:f,element:d,mode:p,style:m}){const{styleHeight:y,styleWidth:v}=b.useMemo(()=>({styleHeight:Gc(m?.height),styleWidth:Gc(m?.width)}),[m?.height,m?.width]),[S,k]=b.useState({height:u,width:i}),P=f||p==="only-height"&&y!==void 0||p==="only-width"&&v!==void 0||y!==void 0&&v!==void 0;return Hs(()=>{if(d===null||P)return;const R=new ResizeObserver($=>{for(const B of $){const{contentRect:z,target:U}=B;d===U&&k(V=>V.height===z.height&&V.width===z.width?V:{height:z.height,width:z.width})}});return R.observe(d,{box:a}),()=>{R?.unobserve(d)}},[a,P,d,y,v]),b.useMemo(()=>({height:y??S.height,width:v??S.width}),[S,y,v])}function Mh(a){const u=b.useRef(()=>{throw new Error("Cannot call during render.")});return Hs(()=>{u.current=a},[a]),b.useCallback(i=>u.current?.(i),[u])}let wr=null;function Fh(a=!1){if(wr===null||a){const u=document.createElement("div"),i=u.style;i.width="50px",i.height="50px",i.overflow="scroll",i.direction="rtl";const f=document.createElement("div"),d=f.style;return d.width="100px",d.height="100px",u.appendChild(f),document.body.appendChild(u),u.scrollLeft>0?wr="positive-descending":(u.scrollLeft=1,u.scrollLeft===0?wr="negative":wr="positive-ascending"),document.body.removeChild(u),wr}return wr}function Bi({containerElement:a,direction:u,isRtl:i,scrollOffset:f}){if(u==="horizontal"&&i)switch(Fh()){case"negative":return-f;case"positive-descending":{if(a){const{clientWidth:d,scrollLeft:p,scrollWidth:m}=a;return m-d-p}break}}return f}function En(a,u="Assertion error"){if(!a)throw console.error(u),Error(u)}function gl(a,u){if(a===u)return!0;if(!!a!=!!u||(En(a!==void 0),En(u!==void 0),Object.keys(a).length!==Object.keys(u).length))return!1;for(const i in a)if(!Object.is(u[i],a[i]))return!1;return!0}function ad({cachedBounds:a,itemCount:u,itemSize:i}){if(u===0)return 0;if(typeof i=="number")return u*i;{const f=a.get(a.size===0?0:a.size-1);En(f!==void 0,"Unexpected bounds cache miss");const d=(f.scrollOffset+f.size)/a.size;return u*d}}function $h({align:a,cachedBounds:u,index:i,itemCount:f,itemSize:d,containerScrollOffset:p,containerSize:m}){if(i<0||i>=f)throw RangeError(`Invalid index specified: ${i}`,{cause:`Index ${i} is not within the range of 0 - ${f-1}`});const y=ad({cachedBounds:u,itemCount:f,itemSize:d}),v=u.get(i),S=Math.max(0,Math.min(y-m,v.scrollOffset)),k=Math.max(0,v.scrollOffset-m+v.size);switch(a==="smart"&&(p>=k&&p<=S?a="auto":a="center"),a){case"start":return S;case"end":return k;case"center":return v.scrollOffset<=m/2?0:v.scrollOffset+v.size/2>=y-m/2?y-m:v.scrollOffset+v.size/2-m/2;default:return p>=k&&p<=S?p:p<k?k:S}}function Hi({cachedBounds:a,containerScrollOffset:u,containerSize:i,itemCount:f,overscanCount:d}){const p=f-1;let m=0,y=-1,v=0,S=-1,k=0;for(;k<p;){const P=a.get(k);if(P.scrollOffset+P.size>u)break;k++}for(m=k,v=Math.max(0,m-d);k<p;){const P=a.get(k);if(P.scrollOffset+P.size>=u+i)break;k++}return y=Math.min(p,k),S=Math.min(f-1,y+d),m<0&&(m=0,y=-1,v=0,S=-1),{startIndexVisible:m,stopIndexVisible:y,startIndexOverscan:v,stopIndexOverscan:S}}function Ah({itemCount:a,itemProps:u,itemSize:i}){const f=new Map;return{get(d){for(En(d<a,`Invalid index ${d}`);f.size-1<d;){const m=f.size;let y;switch(typeof i){case"function":{y=i(m,u);break}case"number":{y=i;break}}if(m===0)f.set(m,{size:y,scrollOffset:0});else{const v=f.get(m-1);En(v!==void 0,`Unexpected bounds cache miss for index ${d}`),f.set(m,{scrollOffset:v.scrollOffset+v.size,size:y})}}const p=f.get(d);return En(p!==void 0,`Unexpected bounds cache miss for index ${d}`),p},set(d,p){f.set(d,p)},get size(){return f.size}}}function Uh({itemCount:a,itemProps:u,itemSize:i}){return b.useMemo(()=>Ah({itemCount:a,itemProps:u,itemSize:i}),[a,u,i])}function Bh({containerSize:a,itemSize:u}){let i;return typeof u==="string"?(En(u.endsWith("%"),`Invalid item size: "${u}"; string values must be percentages (e.g. "100%")`),En(a!==void 0,"Container size must be defined if a percentage item size is specified"),i=a*parseInt(u)/100):i=u,i}function Jc({containerElement:a,containerStyle:u,defaultContainerSize:i=0,direction:f,isRtl:d=!1,itemCount:p,itemProps:m,itemSize:y,onResize:v,overscanCount:S}){const{height:k=i,width:P=i}=Ih({defaultHeight:f==="vertical"?i:void 0,defaultWidth:f==="horizontal"?i:void 0,element:a,mode:f==="vertical"?"only-height":"only-width",style:u}),R=b.useRef({height:0,width:0}),$=f==="vertical"?k:P,B=Bh({containerSize:$,itemSize:y});b.useLayoutEffect(()=>{if(typeof v=="function"){const M=R.current;(M.height!==k||M.width!==P)&&(v({height:k,width:P},{...M}),M.height=k,M.width=P)}},[k,v,P]);const z=Uh({itemCount:p,itemProps:m,itemSize:B}),U=b.useCallback(M=>z.get(M),[z]),[V,W]=b.useState(()=>Hi({cachedBounds:z,containerScrollOffset:0,containerSize:$,itemCount:p,overscanCount:S})),{startIndexVisible:le,startIndexOverscan:O,stopIndexVisible:w,stopIndexOverscan:J}={startIndexVisible:Math.min(p-1,V.startIndexVisible),startIndexOverscan:Math.min(p-1,V.startIndexOverscan),stopIndexVisible:Math.min(p-1,V.stopIndexVisible),stopIndexOverscan:Math.min(p-1,V.stopIndexOverscan)},D=b.useCallback(()=>ad({cachedBounds:z,itemCount:p,itemSize:B}),[z,p,B]),ee=b.useCallback(M=>{const oe=Bi({containerElement:a,direction:f,isRtl:d,scrollOffset:M});return Hi({cachedBounds:z,containerScrollOffset:oe,containerSize:$,itemCount:p,overscanCount:S})},[z,a,$,f,d,p,S]);Hs(()=>{const M=(f==="vertical"?a?.scrollTop:a?.scrollLeft)??0;W(ee(M))},[a,f,ee]),Hs(()=>{if(!a)return;const M=()=>{W(oe=>{const{scrollLeft:L,scrollTop:ae}=a,I=Bi({containerElement:a,direction:f,isRtl:d,scrollOffset:f==="vertical"?ae:L}),X=Hi({cachedBounds:z,containerScrollOffset:I,containerSize:$,itemCount:p,overscanCount:S});return gl(X,oe)?oe:X})};return a.addEventListener("scroll",M),()=>{a.removeEventListener("scroll",M)}},[z,a,$,f,p,S]);const Q=Mh(({align:M="auto",containerScrollOffset:oe,index:L})=>{let ae=$h({align:M,cachedBounds:z,containerScrollOffset:oe,containerSize:$,index:L,itemCount:p,itemSize:B});if(a){if(ae=Bi({containerElement:a,direction:f,isRtl:d,scrollOffset:ae}),typeof a.scrollTo!="function"){const I=ee(ae);gl(V,I)||W(I)}return ae}});return{getCellBounds:U,getEstimatedSize:D,scrollToIndex:Q,startIndexOverscan:O,startIndexVisible:le,stopIndexOverscan:J,stopIndexVisible:w}}function Hh(a){return b.useMemo(()=>a,Object.values(a))}function Vh(a,u){const{ariaAttributes:i,style:f,...d}=a,{ariaAttributes:p,style:m,...y}=u;return gl(i,p)&&gl(f,m)&&gl(d,y)}function Wh({cellComponent:a,cellProps:u,children:i,className:f,columnCount:d,columnWidth:p,defaultHeight:m=0,defaultWidth:y=0,dir:v,gridRef:S,onCellsRendered:k,onResize:P,overscanCount:R=3,rowCount:$,rowHeight:B,style:z,tagName:U="div",...V}){const W=Hh(u),le=b.useMemo(()=>b.memo(a,Vh),[a]),[O,w]=b.useState(null),J=zh(O,v),{getCellBounds:D,getEstimatedSize:ee,startIndexOverscan:Q,startIndexVisible:M,scrollToIndex:oe,stopIndexOverscan:L,stopIndexVisible:ae}=Jc({containerElement:O,containerStyle:z,defaultContainerSize:y,direction:"horizontal",isRtl:J,itemCount:d,itemProps:W,itemSize:p,onResize:P,overscanCount:R}),{getCellBounds:I,getEstimatedSize:X,startIndexOverscan:re,startIndexVisible:H,scrollToIndex:C,stopIndexOverscan:A,stopIndexVisible:j}=Jc({containerElement:O,containerStyle:z,defaultContainerSize:m,direction:"vertical",itemCount:$,itemProps:W,itemSize:B,onResize:P,overscanCount:R});b.useImperativeHandle(S,()=>({get element(){return O},scrollToCell({behavior:Y="auto",columnAlign:te="auto",columnIndex:ie,rowAlign:me="auto",rowIndex:ge}){const ve=oe({align:te,containerScrollOffset:O?.scrollLeft??0,index:ie}),q=C({align:me,containerScrollOffset:O?.scrollTop??0,index:ge});typeof O?.scrollTo=="function"&&O.scrollTo({behavior:Y,left:ve,top:q})},scrollToColumn({align:Y="auto",behavior:te="auto",index:ie}){const me=oe({align:Y,containerScrollOffset:O?.scrollLeft??0,index:ie});typeof O?.scrollTo=="function"&&O.scrollTo({behavior:te,left:me})},scrollToRow({align:Y="auto",behavior:te="auto",index:ie}){const me=C({align:Y,containerScrollOffset:O?.scrollTop??0,index:ie});typeof O?.scrollTo=="function"&&O.scrollTo({behavior:te,top:me})}}),[O,oe,C]),b.useEffect(()=>{Q>=0&&L>=0&&re>=0&&A>=0&&k&&k({columnStartIndex:M,columnStopIndex:ae,rowStartIndex:H,rowStopIndex:j},{columnStartIndex:Q,columnStopIndex:L,rowStartIndex:re,rowStopIndex:A})},[k,Q,M,L,ae,re,H,A,j]);const h=b.useMemo(()=>{const Y=[];if(d>0&&$>0)for(let te=re;te<=A;te++){const ie=I(te),me=[];for(let ge=Q;ge<=L;ge++){const ve=D(ge);me.push(b.createElement(le,{...W,ariaAttributes:{"aria-colindex":ge+1,role:"gridcell"},columnIndex:ge,key:ge,rowIndex:te,style:{position:"absolute",left:J?void 0:0,right:J?0:void 0,transform:`translate(${J?-ve.scrollOffset:ve.scrollOffset}px, ${ie.scrollOffset}px)`,height:ie.size,width:ve.size}}))}Y.push(o.jsx("div",{role:"row","aria-rowindex":te+1,children:me},te))}return Y},[le,W,d,Q,L,D,I,J,$,re,A]),E=o.jsx("div",{"aria-hidden":!0,style:{height:X(),width:ee(),zIndex:-1}});return b.createElement(U,{"aria-colcount":d,"aria-rowcount":$,role:"grid",...V,className:f,dir:v,ref:w,style:{position:"relative",maxHeight:"100%",maxWidth:"100%",flexGrow:1,overflow:"auto",...z}},h,i,E)}const Kh=5,Qh=200,Yh=12;function Gh({photos:a,selectedPhotos:u,onSelectPhoto:i,onOpenViewer:f,height:d=800,width:p,columnCount:m=Kh,cellSize:y=Qh,gap:v=Yh}){const S=p??m*y,k=b.useMemo(()=>Math.ceil(a.length/m),[a.length,m]),P=b.useCallback(({columnIndex:R,rowIndex:$,style:B})=>{const z=$*m+R;if(z>=a.length)return null;const U=a[z],V=u.has(U.id),W={...B,left:B.left+v,top:B.top+v,width:B.width-v,height:B.height-v};return o.jsx("div",{style:W,onClick:()=>i(U.id),onDoubleClick:()=>f(U.id),className:`cursor-pointer rounded-lg overflow-hidden ${V?"ring-2 ring-blue-500":""}`,children:U.thumbnail?o.jsx("img",{src:U.thumbnail,alt:U.currentName,className:"w-full h-full object-cover",loading:"lazy"}):o.jsx("div",{className:"w-full h-full bg-gray-900 flex items-center justify-center",children:o.jsx("span",{className:"text-xs text-gray-400",children:U.currentName})})})},[m,v,f,i,a,u]);return o.jsx(Wh,{columnCount:m,columnWidth:y,height:d,rowCount:k,rowHeight:y,width:S,children:P})}const Jh=600,Xh=300;function qh({loadingProject:a,currentView:u,selectedDay:i,selectedRootFolder:f,photos:d,rootGroups:p,filteredPhotos:m,selectedPhotos:y,galleryViewPhoto:v,dayLabels:S,buckets:k,onSelectPhoto:P,onOpenViewer:R,onCloseViewer:$,onNavigateViewer:B,onToggleFavorite:z,onAssignBucket:U,onAssignDay:V,onSaveToHistory:W,onShowToast:le,getSubfolderGroup:O,getDerivedSubfolderGroup:w,isVideoPhoto:J,isMeceBucketLabel:D}){const ee=b.useRef({}),Q=(H,C)=>{C.stopPropagation(),ee.current[H]?(clearTimeout(ee.current[H]),delete ee.current[H],R(H)):ee.current[H]=setTimeout(()=>{delete ee.current[H],P(H)},Xh)},M=(H,C,A)=>o.jsx("div",{className:"grid grid-cols-5 gap-3",children:H.map(j=>o.jsxs("div",{onClick:h=>Q(j.id,h),"data-testid":`photo-${j.id}`,className:`relative group cursor-pointer rounded-lg overflow-hidden transition-all shadow-lg hover:shadow-xl ${j.bucket||j.archived?"opacity-70 saturate-75":"hover:scale-105"} ${y.has(j.id)?"ring-2 ring-blue-500":""}`,children:[j.thumbnail?j.mimeType?.startsWith("video/")?o.jsx("video",{src:j.thumbnail,className:"w-full aspect-square object-cover",muted:!0,preload:"metadata"}):o.jsx("img",{src:j.thumbnail,alt:j.currentName,className:"w-full aspect-square object-cover"}):o.jsx("div",{className:"w-full aspect-square bg-gray-900 flex items-center justify-center text-xs text-gray-400 px-2 text-center",children:j.currentName}),j.mimeType?.startsWith("video/")&&o.jsx("div",{className:"absolute top-2 left-2 bg-black/70 backdrop-blur-sm rounded-full p-1.5",children:o.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{d:"M6.3 2.84A1.5 1.5 0 004 4.11v11.78a1.5 1.5 0 002.3 1.27l9.344-5.891a1.5 1.5 0 000-2.538L6.3 2.841z"})})}),o.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/90 via-black/30 to-transparent opacity-0 group-hover:opacity-100 transition-opacity z-5",children:o.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-2",children:o.jsx("p",{className:"text-xs font-medium text-white truncate",children:j.currentName})})}),j.isPreOrganized&&o.jsx("div",{className:"absolute top-2 right-2 z-10",children:o.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold bg-blue-600 text-white shadow-lg",title:`Auto-assigned: Day ${j.detectedDay??""}, Bucket ${j.detectedBucket??""}`,children:"Organized"})}),j.bucket&&(()=>{const h=k.find(ie=>ie.key===j.bucket),E=h?.color||"bg-gray-500",te={"bg-blue-500":"rgb(59, 130, 246)","bg-purple-500":"rgb(168, 85, 247)","bg-green-500":"rgb(34, 197, 94)","bg-orange-500":"rgb(249, 115, 22)","bg-yellow-500":"rgb(234, 179, 8)","bg-indigo-500":"rgb(99, 102, 241)","bg-gray-500":"rgb(107, 114, 128)"}[E];return o.jsx("div",{className:"absolute bottom-2 left-2 px-2 py-1 rounded text-xs font-bold text-white shadow-lg z-10",style:{backgroundColor:te||"rgb(107, 114, 128)"},title:`Bucket: ${j.bucket}${h?` (${h.label})`:""}`,children:o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("span",{children:j.bucket}),j.favorite&&o.jsx(Ms,{className:"w-3 h-3 fill-current"})]})})})(),!j.bucket&&j.favorite&&o.jsx("div",{className:"absolute bottom-2 left-2 bg-yellow-500 text-white rounded-full p-1.5 shadow-lg z-10",children:o.jsx(Ms,{className:"w-3.5 h-3.5 fill-current"})})]},j.id))});if(a)return o.jsx("div",{className:"flex items-center justify-center h-96",children:o.jsxs("div",{className:"text-center",children:[o.jsx(Vs,{className:"w-12 h-12 mx-auto mb-4 animate-spin text-blue-400"}),o.jsx("p",{className:"text-gray-400",children:"Loading project..."})]})});if(u==="days"&&i===null)return o.jsx("div",{className:"flex items-center justify-center h-96 text-gray-500",children:o.jsxs("div",{className:"text-center",children:[o.jsx(cp,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),o.jsx("p",{children:"Select a day to view photos"})]})});if(u==="folders"&&f===null&&i===null)return o.jsx("div",{className:"flex items-center justify-center h-96 text-gray-500",children:o.jsxs("div",{className:"text-center",children:[o.jsx(Vi,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),o.jsx("p",{children:"Select a folder to view photos"})]})});const oe=u==="folders"&&f?(p.find(H=>H[0]===f)?.[1]||[]).filter(H=>!H.archived):null,L=oe!==null?oe:m,ae=na(L,{groupBy:i!==null?"subfolder":null,separateVideos:!0,selectedDay:i,getSubfolderGroup:O,isVideo:J}),I=ae.photos;ae.indexMap;const X=i!==null?ae.groups??null:null;if(L.length===0)return o.jsx("div",{className:"flex items-center justify-center h-96 text-gray-500",children:o.jsxs("div",{className:"text-center",children:[o.jsx(Vi,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),o.jsx("p",{children:"No photos in this view"})]})});if(v){const H=I.find(C=>C.id===v);if(H)return o.jsx(Th,{photo:H,filteredPhotos:I,orderingResult:ae,onClose:$,onNavigate:B,onToggleFavorite:C=>z(C),onAssignBucket:(C,A)=>{if(U(C,A),A){const h=Ft(C,"next",ae,te=>!te.bucket&&!te.archived);if(h){B(h.id);return}const E=Ft(C,"next",ae);if(E){B(E.id);return}const Y=Ft(C,"prev",ae);if(Y){B(Y.id);return}$()}},onAssignDay:(C,A)=>V(C,A),selectedBucket:H.bucket||void 0,selectedDay:H.day,buckets:k,dayLabels:S,onShowToast:le})}return i!==null&&X?o.jsx("div",{className:"space-y-8",children:X.map(H=>{const C=H.photos,A=C.filter(J),j=C.filter(ge=>!J(ge)),h=A.length>0&&j.length>0,E=H.photos.filter(ge=>ge.day!==i?!1:w(ge,i)===H.label),Y=E.some(ge=>ge.subfolderOverride!==void 0),te=H.label==="Day Root",ie=D(H.label),me=!te&&!ie;return o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h3",{className:"text-sm font-semibold text-gray-200",children:H.label}),o.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-400",children:[o.jsxs("span",{children:[H.photos.length," items"]}),me&&o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{className:"text-xs text-blue-300 hover:text-blue-200",title:"Move photos in this subfolder to the day root",onClick:()=>{const ge=d,ve=d.map(pe=>pe.day!==i||w(pe,i)!==H.label?pe:{...pe,subfolderOverride:null});W(ve);const q=S[i]||`Day ${String(i).padStart(2,"0")}`;le(`Photos moved to ${q}.`,"info",{durationMs:5e3,actionLabel:"Undo",onAction:()=>{W(ge)}})},children:"Ingest to Day"}),o.jsx("button",{className:"text-xs text-gray-300 hover:text-gray-100",onClick:()=>{const ge=d.map(ve=>{if(ve.day!==i)return ve;const q=w(ve,i);return q!==H.label?ve:{...ve,subfolderOverride:q}});W(ge)},children:"Keep Subfolder"}),Y&&o.jsx("button",{className:"text-xs text-red-300 hover:text-red-200",onClick:()=>{const ge=d.map(ve=>ve.day!==i?ve:E.find(q=>q.id===ve.id)?{...ve,subfolderOverride:void 0}:ve);W(ge)},children:"Undo Ingest"})]})]})]}),h&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"mb-2 text-xs uppercase tracking-wider text-gray-500",children:"Photos"}),M(j),o.jsx("div",{className:"mt-6 mb-2 text-xs uppercase tracking-wider text-gray-500",children:"Videos"}),M(A)]}),!h&&M(C)]},H.label)})}):i===null&&I.length>=Jh?o.jsx(Gh,{photos:I,selectedPhotos:y,onSelectPhoto:P,onOpenViewer:R}):M(I)}function Zh({selectedPhotos:a,photos:u,days:i,buckets:f,onSaveToHistory:d,onPersistState:p,onSetDayLabels:m,onSetSelectedDay:y,onSetCurrentView:v,onSetSelectedPhotos:S,onRemoveDayAssignment:k,onAssignBucket:P,onToggleFavorite:R}){const[$,B]=b.useState(!1),[z,U]=b.useState("");if(b.useEffect(()=>{B(!1)},[a]),a.size===0)return null;const V=a.size===1?Array.from(a)[0]:null,W=V?u.find(le=>le.id===V):null;return o.jsx("aside",{className:"w-80 border-l border-gray-800 bg-gray-900 overflow-y-auto",children:o.jsxs("div",{className:"p-6",children:[o.jsx("div",{className:"mb-6",children:a.size===1&&W?o.jsxs(o.Fragment,{children:[W.mimeType?.startsWith("video/")?o.jsx("video",{src:W.thumbnail,className:"w-full rounded-lg",controls:!0}):o.jsx("img",{src:W.thumbnail,alt:"Selected",className:"w-full rounded-lg"}),o.jsx("div",{className:"mt-2 text-xs text-gray-400 font-mono break-all",children:$?o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{value:z,onChange:le=>U(le.target.value),className:"w-full px-2 py-1 rounded bg-gray-800 text-sm text-gray-100"}),o.jsx("button",{onClick:()=>{const le=u.map(O=>O.id===V?{...O,currentName:z}:O);d(le),B(!1)},className:"p-1 bg-green-600 rounded","aria-label":"Save name",children:o.jsx(Ki,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>B(!1),className:"p-1 bg-gray-800 rounded","aria-label":"Cancel edit name",children:o.jsx(rn,{className:"w-4 h-4"})})]}):o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("div",{children:W.currentName}),o.jsx("button",{onClick:()=>{U(W.currentName||W.originalName||""),B(!0)},className:"p-1 ml-2","aria-label":"Edit name",children:o.jsx(Wi,{className:"w-4 h-4 text-gray-400"})})]})})]}):o.jsxs("div",{className:"text-sm text-gray-300",children:[a.size," selected"]})}),o.jsxs("div",{className:"space-y-4 mb-6",children:[o.jsx("h3",{className:"text-sm font-semibold text-gray-300 mb-3",children:"Assign Day"}),o.jsxs("div",{className:"flex gap-2 items-center",children:[o.jsxs("select",{"aria-label":"Assign to...",onChange:le=>{const O=le.target.value;if(!O)return;const w=O==="new"?Math.max(0,...i.map(ee=>ee[0]))+1:Number(O),J=Array.from(a),D=u.map(ee=>J.includes(ee.id)?{...ee,day:w}:ee);d(D),O==="new"&&(m(ee=>({...ee,[w]:`Day ${String(w).padStart(2,"0")}`})),p(D)),y(w),v("days"),S(new Set)},className:"px-3 py-2 rounded bg-gray-800",defaultValue:"",children:[o.jsx("option",{value:"",children:"Assign to..."}),i.map(([le])=>o.jsx("option",{value:le,children:`Day ${String(le).padStart(2,"0")}`},le)),o.jsx("option",{value:"new",children:"Create new day"})]}),o.jsx("div",{className:"text-xs text-gray-400",children:"Assign selected photos to a day folder"})]}),o.jsx("button",{onClick:()=>{k(Array.from(a)),S(new Set)},className:"w-full px-3 py-2 bg-gray-700 hover:bg-gray-600 rounded text-sm font-medium transition-colors",children:"Remove Day Assignment"})]}),o.jsxs("div",{className:"space-y-2 mb-6",children:[o.jsx("h3",{className:"text-sm font-semibold text-gray-300 mb-3",children:"Assign Category"}),f.map(le=>o.jsxs("button",{onClick:()=>P(Array.from(a),le.key),className:`w-full text-left px-4 py-3 rounded-lg transition-all ${le.color} hover:brightness-110 text-white`,children:[o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{children:[o.jsx("span",{className:"font-bold text-lg",children:le.key}),o.jsx("span",{className:"ml-3 font-medium",children:le.label})]})}),o.jsx("p",{className:"text-xs mt-1 opacity-80",children:le.description})]},le.key))]}),o.jsx("div",{className:"space-y-3 pt-6 border-t border-gray-800",children:o.jsxs("button",{onClick:()=>R(Array.from(a)),className:`w-full px-4 py-2 rounded-lg flex items-center gap-2 transition-colors ${a.size===1&&W?.favorite?"bg-yellow-600 hover:bg-yellow-700":"bg-gray-800 hover:bg-gray-700"}`,children:[o.jsx(Ms,{className:`w-4 h-4 ${a.size===1&&W?.favorite?"fill-current":""}`}),"Toggle Favorite (F)"]})})]})})}function em({isOpen:a,buckets:u,onClose:i}){return a?o.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-6",children:o.jsx("div",{className:"bg-gray-900 rounded-lg max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsx("h2",{className:"text-xl font-bold",children:"Keyboard Shortcuts"}),o.jsx("button",{onClick:i,className:"p-2 hover:bg-gray-800 rounded",children:o.jsx(rn,{className:"w-5 h-5"})})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-blue-400 mb-3",children:"MECE Categories"}),o.jsx("div",{className:"grid grid-cols-2 gap-2",children:u.map(f=>o.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[o.jsx("kbd",{className:`px-2 py-1 rounded ${f.color} text-white font-bold`,children:f.key==="F"?"M":f.key}),o.jsx("span",{children:f.label})]},f.key))}),o.jsx("p",{className:"text-xs text-gray-400 mt-3",children:"Keyboard shortcuts: AE, X, M (Mood/Food). F is reserved for Favorite."})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-blue-400 mb-3",children:"Navigation"}),o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:""}),o.jsx("span",{children:"Previous / Next photo"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"J / K"}),o.jsx("span",{children:"Next / Previous (grid)"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"Shift+J / Shift+K"}),o.jsx("span",{children:"Next / Previous unassigned"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"Enter"}),o.jsx("span",{children:"Fullscreen view"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"Esc"}),o.jsx("span",{children:"Close / Deselect"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"Space / N"}),o.jsx("span",{children:"Next unassigned (viewer)"})]})]})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-blue-400 mb-3",children:"Actions"}),o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"F"}),o.jsx("span",{children:"Toggle favorite"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"Shift+H"}),o.jsx("span",{children:"Toggle Skip Assigned"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"AE, M, X"}),o.jsx("span",{children:"Assign bucket (multi-select supported)"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"Z"}),o.jsx("span",{children:"Undo (keyboard)"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"Z"}),o.jsx("span",{children:"Redo (keyboard)"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"Ctrl+Shift+D"}),o.jsx("span",{children:"Toggle debug overlay"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"?"}),o.jsx("span",{children:"Show this help"})]})]})]})]})]})})}):null}function tm({isOpen:a,scriptText:u,copyStatus:i,detectedProjectPath:f,onClose:d,onCopyScript:p,onDownloadScript:m,onRegenerateScript:y}){const[v,S]=b.useState(f);b.useEffect(()=>{S(f)},[f]);const k=P=>{const R=P.target.value;S(R),y(R)};return a?o.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-6",children:o.jsxs("div",{className:"bg-gray-900 rounded-lg max-w-2xl w-full overflow-hidden border border-gray-800",children:[o.jsxs("div",{className:"px-5 py-4 border-b border-gray-800 flex items-center justify-between",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-100",children:"Export Script"}),o.jsx("button",{onClick:d,className:"p-2 hover:bg-gray-800 rounded","aria-label":"Close export script dialog",children:o.jsx(rn,{className:"w-5 h-5"})})]}),o.jsxs("div",{className:"px-5 py-4 space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1.5",children:"Project Directory Path"}),o.jsx("input",{type:"text",value:v,onChange:k,placeholder:"/Users/you/Photos/Trip-to-Japan",className:"w-full px-3 py-2 rounded-lg border border-gray-700 bg-gray-950 text-gray-100 text-sm font-mono focus:outline-none focus:ring-2 focus:ring-blue-500"}),o.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Enter the full path to your photo project folder"})]}),o.jsxs("p",{className:"text-sm text-gray-400",children:["Download the script and run it:"," ",o.jsx("code",{className:"bg-gray-800 px-1.5 py-0.5 rounded text-xs",children:"bash narrative-export.sh"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("button",{onClick:m,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium flex items-center gap-2",children:[o.jsx(Zc,{className:"w-4 h-4"}),"Download Script"]}),o.jsx("button",{onClick:p,className:"px-3 py-2 rounded-lg bg-gray-800 text-gray-100 hover:bg-gray-700 text-sm",children:"Copy to Clipboard"}),i==="copied"&&o.jsx("span",{className:"text-xs text-green-400",children:"Copied!"}),i==="failed"&&o.jsx("span",{className:"text-xs text-red-400",children:"Copy failed. Use download instead."})]}),o.jsx("textarea",{readOnly:!0,value:u,className:"w-full h-48 rounded-lg border border-gray-800 bg-gray-950 px-3 py-2 text-xs text-gray-100 font-mono"})]})]})}):null}function nm({toast:a,onDismiss:u}){return a?o.jsx("div",{className:"fixed bottom-6 right-6 z-50",children:o.jsxs("div",{className:`flex items-center gap-3 px-4 py-2 rounded-lg text-sm shadow-lg ${a.tone==="error"?"bg-red-600 text-white":"bg-gray-800 text-gray-100"}`,role:"status","aria-live":"polite",children:[o.jsx("span",{children:a.message}),o.jsxs("div",{className:"flex items-center gap-2",children:[a.actionLabel&&o.jsx("button",{onClick:()=>{a.onAction?.(),u()},className:"px-2 py-0.5 rounded bg-white/10 text-xs text-white hover:bg-white/20",children:a.actionLabel}),o.jsx("button",{onClick:u,className:"p-1 rounded hover:bg-white/10","aria-label":"Dismiss toast",children:o.jsx(rn,{className:"w-4 h-4"})})]})]})}):null}function rm({photoId:a,photos:u,onClose:i}){if(!a)return null;const f=u.find(d=>d.id===a);return f?o.jsxs("div",{className:"fixed inset-0 bg-black z-50 flex items-center justify-center",children:[o.jsx("button",{onClick:i,className:"absolute top-4 right-4 p-2 bg-black/50 hover:bg-black/70 rounded-full transition-colors",children:o.jsx(rn,{className:"w-6 h-6"})}),f.mimeType?.startsWith("video/")?o.jsx("video",{src:f.thumbnail,controls:!0,className:"max-w-full max-h-full object-contain",autoPlay:!1}):o.jsx("img",{src:f.thumbnail,alt:"Fullscreen",className:"max-w-full max-h-full object-contain"}),o.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/90 to-transparent p-6",children:[o.jsx("p",{className:"text-center text-sm font-mono",children:f.currentName}),o.jsx("p",{className:"text-center text-xs text-gray-400 mt-2",children:"Press ESC to close  Arrow keys to navigate"})]})]}):null}function lm({enabled:a,photos:u,filteredPhotos:i,selectedPhotos:f,currentView:d}){const p=b.useRef(performance.now()),[m,y]=b.useState(0);return b.useEffect(()=>{const v=performance.now(),S=v-p.current;p.current=v,a&&y(S)},[a,u,i,f,d]),a?o.jsxs("div",{className:"fixed bottom-4 left-4 bg-black/90 text-white text-xs p-3 rounded-lg font-mono z-50",children:[o.jsx("div",{className:"font-bold mb-2",children:"Debug Info"}),o.jsxs("div",{children:["Total Photos: ",u]}),o.jsxs("div",{children:["Filtered: ",i]}),o.jsxs("div",{children:["Selected: ",f]}),o.jsxs("div",{children:["View: ",d]}),o.jsxs("div",{children:["Last Render: ",m.toFixed(2),"ms"]}),o.jsx("div",{className:"mt-2 text-gray-400",children:"Press Ctrl+Shift+D to toggle"})]}):null}const ml=[{key:"A",label:"Establishing",color:"bg-blue-500",description:"Wide shots, landscapes"},{key:"B",label:"People",color:"bg-purple-500",description:"Portraits, groups"},{key:"C",label:"Culture/Detail",color:"bg-green-500",description:"Local life, close-ups"},{key:"D",label:"Action/Moment",color:"bg-orange-500",description:"Events, activities"},{key:"E",label:"Transition",color:"bg-yellow-500",description:"Travel, movement"},{key:"M",label:"Mood/Food",color:"bg-indigo-500",description:"Food, mood"},{key:"X",label:"Archive",color:"bg-gray-500",description:"Unwanted shots"}],sm=new Set(ml.map(a=>a.key)),om=a=>{const i=a.trim().split(/[\s_-]+/)[0]||"";return sm.has(i.toUpperCase())};function im(){const a=b.useRef([]),[u,i]=b.useState($s.getDisplayVersion()),f=!1,[d,p]=b.useState(!1),[m,y]=b.useState(!1),{toast:v,showToast:S,clearToast:k}=mh(),{currentView:P,setCurrentView:R,sidebarCollapsed:$,setSidebarCollapsed:B,hideAssigned:z,setHideAssigned:U,showHelp:V,setShowHelp:W,galleryViewPhoto:le,setGalleryViewPhoto:O,fullscreenPhoto:w,setFullscreenPhoto:J,selectedDay:D,setSelectedDay:ee,selectedRootFolder:Q,setSelectedRootFolder:M,foldersViewStateRef:oe}=hh(),{photos:L,setPhotos:ae,projectName:I,setProjectName:X,projectRootPath:re,setProjectRootPath:H,projectFolderLabel:C,projectSettings:A,recentProjects:j,setRecentProjects:h,showOnboarding:E,setShowOnboarding:Y,showWelcome:te,setShowWelcome:ie,projectError:me,setProjectError:ge,permissionRetryProjectId:ve,projectNeedingReselection:q,setProjectNeedingReselection:pe,loadingProject:Ne,loadingProgress:se,loadingMessage:ke,dayLabels:Ee,setDayLabels:De,dayContainers:je,loadProject:be,retryProjectPermission:Oe,handleOnboardingComplete:Ye}=ph({debugEnabled:f,showToast:S,prevThumbnailsRef:a}),{setHistory:yt,setHistoryIndex:ot,persistState:We,saveToHistory:$e,undo:yl,redo:vl}=ch({photos:L,setPhotos:ae,projectRootPath:re,projectName:I,projectFolderLabel:C,projectSettings:A,dayLabels:Ee,prevThumbnailsRef:a}),{showExportScript:Sr,exportScriptText:jr,exportCopyStatus:Qn,openExportScriptModal:xl,closeExportScriptModal:Pn,copyExportScript:_n,downloadExportScript:Gs,regenerateScript:wl,getDetectedProjectPath:kl}=gh(L,Ee,A,re),{setCoverForPhotoId:Nl}=jh({photos:L,projectRootPath:re,projectName:I,projectFolderLabel:C,setRecentProjects:h,showToast:S});b.useEffect(()=>{(async()=>{try{const Re=await $s.getCurrentVersion();i(`v${Re}`)}catch{}})()},[f]);const{days:Dn,visibleDays:Cr,normalizePath:Er,sortFolders:br,getDerivedSubfolderGroup:Pr,getSubfolderGroup:$t,rootGroups:St,displayRootGroups:Sl,filteredPhotos:ln}=Sh({photos:L,dayLabels:Ee,dayContainers:je,projectSettings:A,debugEnabled:f,currentView:P,selectedDay:D,selectedRootFolder:Q,hideAssigned:z}),Yn=b.useCallback(ye=>{if(ye.mimeType?.startsWith("video/"))return!0;const Re=ye.originalName.split(".").pop()?.toLowerCase()||"";return["mp4","mov","webm","avi","mkv"].includes(Re)},[]),_r=zs.useMemo(()=>{const Re=(P==="folders"&&Q?(St.find(Ke=>Ke[0]===Q)?.[1]||[]).filter(Ke=>!Ke.archived):null)??ln;return na(Re,{groupBy:D!==null?"subfolder":null,separateVideos:!0,selectedDay:D,getSubfolderGroup:$t,isVideo:Yn})},[P,Q,St,ln,D,$t,Yn]),{editingDay:jl,editingDayName:Dr,setEditingDayName:Cl,startEditingDay:On,saveDayName:Or,cancelEditingDay:Rn}=Nh({photos:L,persistState:We,setDayLabels:De}),{selectedPhotos:Qt,setSelectedPhotos:Yt,focusedPhoto:Gn,setFocusedPhoto:Jn,setLastSelectedIndex:Rr,lastSelectedIndexRef:Js,resetSelection:Xs}=dh({filteredPhotos:ln,coverSelectionMode:d,setCoverForPhotoId:Nl,setCoverSelectionMode:p}),{setCoverFromSelection:qs}=bh({projectRootPath:re,selectedPhotos:Qt,showToast:S,setCoverForPhotoId:Nl}),{handleOnboardingComplete:At}=Ph({handleOnboardingCompleteInternal:Ye,setHistory:yt,setHistoryIndex:ot,resetSelection:Xs,setSelectedDay:ee,setSelectedRootFolder:M,setCurrentView:R}),El=b.useCallback(()=>{ee(null),M(null)},[ee,M]);Eh({projectRootPath:re,photosLength:L.length,selectedRootFolder:Q,selectedDay:D,currentView:P,days:Dn,rootGroups:St,setSelectedDay:ee,setSelectedRootFolder:M});const{assignBucket:Xn,removeDayAssignment:Zs,toggleFavorite:Tr}=Ch({photos:L,saveToHistory:$e,selectedDay:D});kh({selectedPhotos:Qt,focusedPhoto:Gn,filteredPhotos:ln,orderingResult:_r,fullscreenPhoto:w,showHelp:V,showExportScript:Sr,showWelcome:te,showOnboarding:E,coverSelectionMode:d,hideAssigned:z,MECE_BUCKETS:ml,onAssignBucket:Xn,onToggleFavorite:Tr,onUndo:yl,onRedo:vl,onSetFocusedPhoto:Jn,onSetSelectedPhotos:Yt,onSetLastSelectedIndex:Rr,onSetFullscreenPhoto:J,onSetShowHelp:W,onSetCoverSelectionMode:p,onSetHideAssigned:U,onToggleDebugOverlay:()=>y(ye=>!ye),onShowToast:S,lastSelectedIndexRef:Js});const bl=zs.useMemo(()=>({total:L.length,sorted:L.filter(ye=>ye.bucket&&!ye.archived).length,unsorted:L.filter(ye=>!ye.bucket&&!ye.archived).length,archived:L.filter(ye=>ye.archived).length,favorites:L.filter(ye=>ye.favorite).length,root:L.filter(ye=>ye.day===null&&!ye.archived).length}),[L]);return o.jsxs("div",{className:"h-screen flex flex-col bg-gray-950 text-gray-100",children:[o.jsx(_h,{showWelcome:te,projectName:I,stats:bl,currentVersion:u,coverSelectionMode:d,selectedPhotosCount:Qt.size,projectRootPath:re,currentView:P,hideAssigned:z,recentProjects:j,projectError:me,permissionRetryProjectId:ve,loadingProject:Ne,onMainMenu:()=>{Y(!1),ge(null),ie(!0),ze.remove(Cn)},onStartCoverSelection:()=>{p(!0),S("Select a photo to set as cover. Click a photo to set, or press Esc to cancel.","info")},onUseCoverSelection:async()=>{await qs(),p(!1)},onCancelCoverSelection:()=>{p(!1),S("Cover selection cancelled.")},onSelectRecentProject:ye=>{be(ye)},onOpenProject:()=>{Y(!0)},onDeleteProject:async()=>{if(!(!re||!window.confirm(`Delete project '${I}'? This will remove local state and stored folder access. This cannot be undone.`))){try{await uh(re)}catch{S("Failed to delete project.","error");return}try{const Re=ze.get(Nt),jt=(Re?JSON.parse(Re):[]).filter(Ae=>Ae.projectId!==re);ze.set(Nt,JSON.stringify(jt)),h(jt)}catch{}ze.remove(Cn),ae([]),H(null),X("No Project"),ie(!0),S("Project deleted.")}},onImportTrip:()=>{ge(null),Y(!0)},onExportScript:xl,onShowHelp:()=>W(!0),onRetryPermission:Oe,onChangeView:ye=>R(ye),onToggleHideAssigned:()=>U(ye=>!ye),onRememberFoldersViewState:()=>{oe.current={selectedRootFolder:Q,selectedDay:D}},onRestoreFoldersViewState:()=>{M(oe.current.selectedRootFolder),ee(oe.current.selectedDay)},onClearDaySelection:()=>{ee(null)}}),o.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[o.jsx(Dh,{currentView:P,sidebarCollapsed:$,onCollapseSidebar:()=>B(!0),onExpandSidebar:()=>B(!1),visibleDays:Cr,selectedDay:D,selectedRootFolder:Q,onSelectDay:ee,onSelectRootFolder:M,editingDay:jl,editingDayName:Dr,onChangeEditingDayName:Cl,onStartEditingDay:On,onSaveDayName:Or,onCancelEditingDay:Rn,onClearSelectedDay:El,days:Dn,dayLabels:Ee,dayContainers:je,photos:L,normalizePath:Er,rootGroups:St,displayRootGroups:Sl,sortFolders:br,projectSettings:A,debugEnabled:f}),o.jsx("main",{className:"flex-1 overflow-y-auto",children:o.jsx("div",{className:"p-6",children:o.jsx(qh,{loadingProject:Ne,currentView:P,selectedDay:D,selectedRootFolder:Q,photos:L,rootGroups:St,filteredPhotos:ln,selectedPhotos:Qt,galleryViewPhoto:le,dayLabels:Ee,buckets:ml,onSelectPhoto:ye=>Yt(new Set([ye])),onOpenViewer:ye=>O(ye),onCloseViewer:()=>O(null),onNavigateViewer:ye=>O(ye),onToggleFavorite:ye=>{ae(Re=>Re.map(Ke=>Ke.id===ye?{...Ke,favorite:!Ke.favorite}:Ke)),We(L.map(Re=>Re.id===ye?{...Re,favorite:!Re.favorite}:Re))},onAssignBucket:(ye,Re)=>Xn(ye,Re),onAssignDay:(ye,Re)=>{ae(Ke=>Ke.map(jt=>jt.id===ye?{...jt,day:Re}:jt)),We(L.map(Ke=>Ke.id===ye?{...Ke,day:Re}:Ke))},onSaveToHistory:$e,onShowToast:S,getSubfolderGroup:$t,getDerivedSubfolderGroup:Pr,isVideoPhoto:Yn,isMeceBucketLabel:om})})}),Qt.size>0&&!w&&o.jsx(Zh,{selectedPhotos:Qt,photos:L,days:Dn,buckets:ml,onSaveToHistory:$e,onPersistState:We,onSetDayLabels:De,onSetSelectedDay:ee,onSetCurrentView:R,onSetSelectedPhotos:Yt,onRemoveDayAssignment:Zs,onAssignBucket:Xn,onToggleFavorite:Tr})]}),o.jsx(rm,{photoId:w,photos:L,onClose:()=>J(null)}),o.jsx(tm,{isOpen:Sr,scriptText:jr,copyStatus:Qn,detectedProjectPath:kl(),onClose:Pn,onCopyScript:_n,onDownloadScript:Gs,onRegenerateScript:wl}),o.jsx(em,{isOpen:V,buckets:ml,onClose:()=>W(!1)}),o.jsx(nm,{toast:v,onDismiss:k}),o.jsx(lm,{enabled:m,photos:L.length,filteredPhotos:_r.photos.length,selectedPhotos:Qt.size,currentView:P}),te&&o.jsx(Lp,{isOpen:te,onClose:()=>{re&&(ie(!1),ze.set(Cn,re))},onCreateComplete:At,onOpenProject:async ye=>{ge(null);const Re=typeof globalThis<"u"&&(globalThis.vitest||globalThis.__APP_VERSION__==="0.0.0");if(!Re&&!("showDirectoryPicker"in window)){ge("This app requires the File System Access API, which is not available in this browser environment. Please use a compatible browser like Chrome or Edge.");return}if(Re){be(ye);return}try{if(!await Us(ye))try{const jt=await window.showDirectoryPicker();await ea(ye,jt),be(ye);return}catch(jt){console.warn("Folder re-selection cancelled or failed:",jt),pe(ye),Y(!0);return}be(ye)}catch(Ke){console.warn("Error checking stored handle on project open:",Ke),pe(ye),Y(!0)}},recentProjects:j,canClose:!!re,errorMessage:me}),o.jsx(ed,{isOpen:E,onClose:()=>{Y(!1),pe(null)},onComplete:ye=>At(ye,q),recentProjects:j,onSelectRecent:ye=>{ge(null),pe(null),Y(!1),be(ye)}}),o.jsx(zp,{isOpen:Ne,title:"Loading Project",message:ke,progress:se,showProgressBar:!0})]})}function am(){return o.jsx(im,{})}const ud=document.getElementById("root");if(!ud)throw new Error('Root element not found. Make sure index.html contains a div with id="root"');ip.createRoot(ud).render(o.jsx(zs.StrictMode,{children:o.jsx(am,{})}));export{qf as g};
