(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))d(f);new MutationObserver(f=>{for(const h of f)if(h.type==="childList")for(const p of h.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&d(p)}).observe(document,{childList:!0,subtree:!0});function u(f){const h={};return f.integrity&&(h.integrity=f.integrity),f.referrerPolicy&&(h.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?h.credentials="include":f.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function d(f){if(f.ep)return;f.ep=!0;const h=u(f);fetch(f.href,h)}})();function th(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Fi={exports:{}},fl={},Ai={exports:{}},Ee={};var Oc;function nh(){if(Oc)return Ee;Oc=1;var i=Symbol.for("react.element"),a=Symbol.for("react.portal"),u=Symbol.for("react.fragment"),d=Symbol.for("react.strict_mode"),f=Symbol.for("react.profiler"),h=Symbol.for("react.provider"),p=Symbol.for("react.context"),y=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),k=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),E=Symbol.iterator;function D(g){return g===null||typeof g!="object"?null:(g=E&&g[E]||g["@@iterator"],typeof g=="function"?g:null)}var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},U=Object.assign,O={};function B(g,P,W){this.props=g,this.context=P,this.refs=O,this.updater=W||A}B.prototype.isReactComponent={},B.prototype.setState=function(g,P){if(typeof g!="object"&&typeof g!="function"&&g!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,g,P,"setState")},B.prototype.forceUpdate=function(g){this.updater.enqueueForceUpdate(this,g,"forceUpdate")};function H(){}H.prototype=B.prototype;function V(g,P,W){this.props=g,this.context=P,this.refs=O,this.updater=W||A}var re=V.prototype=new H;re.constructor=V,U(re,B.prototype),re.isPureReactComponent=!0;var T=Array.isArray,Q=Object.prototype.hasOwnProperty,q={current:null},L={key:!0,ref:!0,__self:!0,__source:!0};function Z(g,P,W){var Y,te={},de=null,Ne=null;if(P!=null)for(Y in P.ref!==void 0&&(Ne=P.ref),P.key!==void 0&&(de=""+P.key),P)Q.call(P,Y)&&!L.hasOwnProperty(Y)&&(te[Y]=P[Y]);var ye=arguments.length-2;if(ye===1)te.children=W;else if(1<ye){for(var b=Array(ye),le=0;le<ye;le++)b[le]=arguments[le+2];te.children=b}if(g&&g.defaultProps)for(Y in ye=g.defaultProps,ye)te[Y]===void 0&&(te[Y]=ye[Y]);return{$$typeof:i,type:g,key:de,ref:Ne,props:te,_owner:q.current}}function J(g,P){return{$$typeof:i,type:g.type,key:P,ref:g.ref,props:g.props,_owner:g._owner}}function F(g){return typeof g=="object"&&g!==null&&g.$$typeof===i}function ce(g){var P={"=":"=0",":":"=2"};return"$"+g.replace(/[=:]/g,function(W){return P[W]})}var I=/\/+/g;function ae(g,P){return typeof g=="object"&&g!==null&&g.key!=null?ce(""+g.key):P.toString(36)}function oe(g,P,W,Y,te){var de=typeof g;(de==="undefined"||de==="boolean")&&(g=null);var Ne=!1;if(g===null)Ne=!0;else switch(de){case"string":case"number":Ne=!0;break;case"object":switch(g.$$typeof){case i:case a:Ne=!0}}if(Ne)return Ne=g,te=te(Ne),g=Y===""?"."+ae(Ne,0):Y,T(te)?(W="",g!=null&&(W=g.replace(I,"$&/")+"/"),oe(te,P,W,"",function(le){return le})):te!=null&&(F(te)&&(te=J(te,W+(!te.key||Ne&&Ne.key===te.key?"":(""+te.key).replace(I,"$&/")+"/")+g)),P.push(te)),1;if(Ne=0,Y=Y===""?".":Y+":",T(g))for(var ye=0;ye<g.length;ye++){de=g[ye];var b=Y+ae(de,ye);Ne+=oe(de,P,W,b,te)}else if(b=D(g),typeof b=="function")for(g=b.call(g),ye=0;!(de=g.next()).done;)de=de.value,b=Y+ae(de,ye++),Ne+=oe(de,P,W,b,te);else if(de==="object")throw P=String(g),Error("Objects are not valid as a React child (found: "+(P==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":P)+"). If you meant to render a collection of children, use an array instead.");return Ne}function ue(g,P,W){if(g==null)return g;var Y=[],te=0;return oe(g,Y,"","",function(de){return P.call(W,de,te++)}),Y}function se(g){if(g._status===-1){var P=g._result;P=P(),P.then(function(W){(g._status===0||g._status===-1)&&(g._status=1,g._result=W)},function(W){(g._status===0||g._status===-1)&&(g._status=2,g._result=W)}),g._status===-1&&(g._status=0,g._result=P)}if(g._status===1)return g._result.default;throw g._result}var z={current:null},m={transition:null},$={ReactCurrentDispatcher:z,ReactCurrentBatchConfig:m,ReactCurrentOwner:q};function S(){throw Error("act(...) is not supported in production builds of React.")}return Ee.Children={map:ue,forEach:function(g,P,W){ue(g,function(){P.apply(this,arguments)},W)},count:function(g){var P=0;return ue(g,function(){P++}),P},toArray:function(g){return ue(g,function(P){return P})||[]},only:function(g){if(!F(g))throw Error("React.Children.only expected to receive a single React element child.");return g}},Ee.Component=B,Ee.Fragment=u,Ee.Profiler=f,Ee.PureComponent=V,Ee.StrictMode=d,Ee.Suspense=x,Ee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$,Ee.act=S,Ee.cloneElement=function(g,P,W){if(g==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+g+".");var Y=U({},g.props),te=g.key,de=g.ref,Ne=g._owner;if(P!=null){if(P.ref!==void 0&&(de=P.ref,Ne=q.current),P.key!==void 0&&(te=""+P.key),g.type&&g.type.defaultProps)var ye=g.type.defaultProps;for(b in P)Q.call(P,b)&&!L.hasOwnProperty(b)&&(Y[b]=P[b]===void 0&&ye!==void 0?ye[b]:P[b])}var b=arguments.length-2;if(b===1)Y.children=W;else if(1<b){ye=Array(b);for(var le=0;le<b;le++)ye[le]=arguments[le+2];Y.children=ye}return{$$typeof:i,type:g.type,key:te,ref:de,props:Y,_owner:Ne}},Ee.createContext=function(g){return g={$$typeof:p,_currentValue:g,_currentValue2:g,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},g.Provider={$$typeof:h,_context:g},g.Consumer=g},Ee.createElement=Z,Ee.createFactory=function(g){var P=Z.bind(null,g);return P.type=g,P},Ee.createRef=function(){return{current:null}},Ee.forwardRef=function(g){return{$$typeof:y,render:g}},Ee.isValidElement=F,Ee.lazy=function(g){return{$$typeof:w,_payload:{_status:-1,_result:g},_init:se}},Ee.memo=function(g,P){return{$$typeof:k,type:g,compare:P===void 0?null:P}},Ee.startTransition=function(g){var P=m.transition;m.transition={};try{g()}finally{m.transition=P}},Ee.unstable_act=S,Ee.useCallback=function(g,P){return z.current.useCallback(g,P)},Ee.useContext=function(g){return z.current.useContext(g)},Ee.useDebugValue=function(){},Ee.useDeferredValue=function(g){return z.current.useDeferredValue(g)},Ee.useEffect=function(g,P){return z.current.useEffect(g,P)},Ee.useId=function(){return z.current.useId()},Ee.useImperativeHandle=function(g,P,W){return z.current.useImperativeHandle(g,P,W)},Ee.useInsertionEffect=function(g,P){return z.current.useInsertionEffect(g,P)},Ee.useLayoutEffect=function(g,P){return z.current.useLayoutEffect(g,P)},Ee.useMemo=function(g,P){return z.current.useMemo(g,P)},Ee.useReducer=function(g,P,W){return z.current.useReducer(g,P,W)},Ee.useRef=function(g){return z.current.useRef(g)},Ee.useState=function(g){return z.current.useState(g)},Ee.useSyncExternalStore=function(g,P,W){return z.current.useSyncExternalStore(g,P,W)},Ee.useTransition=function(){return z.current.useTransition()},Ee.version="18.3.1",Ee}var Tc;function la(){return Tc||(Tc=1,Ai.exports=nh()),Ai.exports}var Lc;function rh(){if(Lc)return fl;Lc=1;var i=la(),a=Symbol.for("react.element"),u=Symbol.for("react.fragment"),d=Object.prototype.hasOwnProperty,f=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,h={key:!0,ref:!0,__self:!0,__source:!0};function p(y,x,k){var w,E={},D=null,A=null;k!==void 0&&(D=""+k),x.key!==void 0&&(D=""+x.key),x.ref!==void 0&&(A=x.ref);for(w in x)d.call(x,w)&&!h.hasOwnProperty(w)&&(E[w]=x[w]);if(y&&y.defaultProps)for(w in x=y.defaultProps,x)E[w]===void 0&&(E[w]=x[w]);return{$$typeof:a,type:y,key:D,ref:A,props:E,_owner:f.current}}return fl.Fragment=u,fl.jsx=p,fl.jsxs=p,fl}var zc;function lh(){return zc||(zc=1,Fi.exports=rh()),Fi.exports}var o=lh(),C=la();const $s=th(C);var Is={},Ui={exports:{}},mt={},Bi={exports:{}},Hi={};var Ic;function sh(){return Ic||(Ic=1,(function(i){function a(m,$){var S=m.length;m.push($);e:for(;0<S;){var g=S-1>>>1,P=m[g];if(0<f(P,$))m[g]=$,m[S]=P,S=g;else break e}}function u(m){return m.length===0?null:m[0]}function d(m){if(m.length===0)return null;var $=m[0],S=m.pop();if(S!==$){m[0]=S;e:for(var g=0,P=m.length,W=P>>>1;g<W;){var Y=2*(g+1)-1,te=m[Y],de=Y+1,Ne=m[de];if(0>f(te,S))de<P&&0>f(Ne,te)?(m[g]=Ne,m[de]=S,g=de):(m[g]=te,m[Y]=S,g=Y);else if(de<P&&0>f(Ne,S))m[g]=Ne,m[de]=S,g=de;else break e}}return $}function f(m,$){var S=m.sortIndex-$.sortIndex;return S!==0?S:m.id-$.id}if(typeof performance=="object"&&typeof performance.now=="function"){var h=performance;i.unstable_now=function(){return h.now()}}else{var p=Date,y=p.now();i.unstable_now=function(){return p.now()-y}}var x=[],k=[],w=1,E=null,D=3,A=!1,U=!1,O=!1,B=typeof setTimeout=="function"?setTimeout:null,H=typeof clearTimeout=="function"?clearTimeout:null,V=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function re(m){for(var $=u(k);$!==null;){if($.callback===null)d(k);else if($.startTime<=m)d(k),$.sortIndex=$.expirationTime,a(x,$);else break;$=u(k)}}function T(m){if(O=!1,re(m),!U)if(u(x)!==null)U=!0,se(Q);else{var $=u(k);$!==null&&z(T,$.startTime-m)}}function Q(m,$){U=!1,O&&(O=!1,H(Z),Z=-1),A=!0;var S=D;try{for(re($),E=u(x);E!==null&&(!(E.expirationTime>$)||m&&!ce());){var g=E.callback;if(typeof g=="function"){E.callback=null,D=E.priorityLevel;var P=g(E.expirationTime<=$);$=i.unstable_now(),typeof P=="function"?E.callback=P:E===u(x)&&d(x),re($)}else d(x);E=u(x)}if(E!==null)var W=!0;else{var Y=u(k);Y!==null&&z(T,Y.startTime-$),W=!1}return W}finally{E=null,D=S,A=!1}}var q=!1,L=null,Z=-1,J=5,F=-1;function ce(){return!(i.unstable_now()-F<J)}function I(){if(L!==null){var m=i.unstable_now();F=m;var $=!0;try{$=L(!0,m)}finally{$?ae():(q=!1,L=null)}}else q=!1}var ae;if(typeof V=="function")ae=function(){V(I)};else if(typeof MessageChannel<"u"){var oe=new MessageChannel,ue=oe.port2;oe.port1.onmessage=I,ae=function(){ue.postMessage(null)}}else ae=function(){B(I,0)};function se(m){L=m,q||(q=!0,ae())}function z(m,$){Z=B(function(){m(i.unstable_now())},$)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(m){m.callback=null},i.unstable_continueExecution=function(){U||A||(U=!0,se(Q))},i.unstable_forceFrameRate=function(m){0>m||125<m?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):J=0<m?Math.floor(1e3/m):5},i.unstable_getCurrentPriorityLevel=function(){return D},i.unstable_getFirstCallbackNode=function(){return u(x)},i.unstable_next=function(m){switch(D){case 1:case 2:case 3:var $=3;break;default:$=D}var S=D;D=$;try{return m()}finally{D=S}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(m,$){switch(m){case 1:case 2:case 3:case 4:case 5:break;default:m=3}var S=D;D=m;try{return $()}finally{D=S}},i.unstable_scheduleCallback=function(m,$,S){var g=i.unstable_now();switch(typeof S=="object"&&S!==null?(S=S.delay,S=typeof S=="number"&&0<S?g+S:g):S=g,m){case 1:var P=-1;break;case 2:P=250;break;case 5:P=1073741823;break;case 4:P=1e4;break;default:P=5e3}return P=S+P,m={id:w++,callback:$,priorityLevel:m,startTime:S,expirationTime:P,sortIndex:-1},S>g?(m.sortIndex=S,a(k,m),u(x)===null&&m===u(k)&&(O?(H(Z),Z=-1):O=!0,z(T,S-g))):(m.sortIndex=P,a(x,m),U||A||(U=!0,se(Q))),m},i.unstable_shouldYield=ce,i.unstable_wrapCallback=function(m){var $=D;return function(){var S=D;D=$;try{return m.apply(this,arguments)}finally{D=S}}}})(Hi)),Hi}var Mc;function oh(){return Mc||(Mc=1,Bi.exports=sh()),Bi.exports}var $c;function ih(){if($c)return mt;$c=1;var i=la(),a=oh();function u(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var d=new Set,f={};function h(e,t){p(e,t),p(e+"Capture",t)}function p(e,t){for(f[e]=t,e=0;e<t.length;e++)d.add(t[e])}var y=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),x=Object.prototype.hasOwnProperty,k=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,w={},E={};function D(e){return x.call(E,e)?!0:x.call(w,e)?!1:k.test(e)?E[e]=!0:(w[e]=!0,!1)}function A(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function U(e,t,n,r){if(t===null||typeof t>"u"||A(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function O(e,t,n,r,l,s,c){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=l,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=c}var B={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){B[e]=new O(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];B[t]=new O(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){B[e]=new O(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){B[e]=new O(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){B[e]=new O(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){B[e]=new O(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){B[e]=new O(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){B[e]=new O(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){B[e]=new O(e,5,!1,e.toLowerCase(),null,!1,!1)});var H=/[\-:]([a-z])/g;function V(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(H,V);B[t]=new O(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(H,V);B[t]=new O(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(H,V);B[t]=new O(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){B[e]=new O(e,1,!1,e.toLowerCase(),null,!1,!1)}),B.xlinkHref=new O("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){B[e]=new O(e,1,!1,e.toLowerCase(),null,!0,!0)});function re(e,t,n,r){var l=B.hasOwnProperty(t)?B[t]:null;(l!==null?l.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(U(t,n,l,r)&&(n=null),r||l===null?D(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):l.mustUseProperty?e[l.propertyName]=n===null?l.type===3?!1:"":n:(t=l.attributeName,r=l.attributeNamespace,n===null?e.removeAttribute(t):(l=l.type,n=l===3||l===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var T=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Q=Symbol.for("react.element"),q=Symbol.for("react.portal"),L=Symbol.for("react.fragment"),Z=Symbol.for("react.strict_mode"),J=Symbol.for("react.profiler"),F=Symbol.for("react.provider"),ce=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),ae=Symbol.for("react.suspense"),oe=Symbol.for("react.suspense_list"),ue=Symbol.for("react.memo"),se=Symbol.for("react.lazy"),z=Symbol.for("react.offscreen"),m=Symbol.iterator;function $(e){return e===null||typeof e!="object"?null:(e=m&&e[m]||e["@@iterator"],typeof e=="function"?e:null)}var S=Object.assign,g;function P(e){if(g===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);g=t&&t[1]||""}return`
`+g+e}var W=!1;function Y(e,t){if(!e||W)return"";W=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(M){var r=M}Reflect.construct(e,[],t)}else{try{t.call()}catch(M){r=M}e.call(t.prototype)}else{try{throw Error()}catch(M){r=M}e()}}catch(M){if(M&&r&&typeof M.stack=="string"){for(var l=M.stack.split(`
`),s=r.stack.split(`
`),c=l.length-1,v=s.length-1;1<=c&&0<=v&&l[c]!==s[v];)v--;for(;1<=c&&0<=v;c--,v--)if(l[c]!==s[v]){if(c!==1||v!==1)do if(c--,v--,0>v||l[c]!==s[v]){var N=`
`+l[c].replace(" at new "," at ");return e.displayName&&N.includes("<anonymous>")&&(N=N.replace("<anonymous>",e.displayName)),N}while(1<=c&&0<=v);break}}}finally{W=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?P(e):""}function te(e){switch(e.tag){case 5:return P(e.type);case 16:return P("Lazy");case 13:return P("Suspense");case 19:return P("SuspenseList");case 0:case 2:case 15:return e=Y(e.type,!1),e;case 11:return e=Y(e.type.render,!1),e;case 1:return e=Y(e.type,!0),e;default:return""}}function de(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case L:return"Fragment";case q:return"Portal";case J:return"Profiler";case Z:return"StrictMode";case ae:return"Suspense";case oe:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case ce:return(e.displayName||"Context")+".Consumer";case F:return(e._context.displayName||"Context")+".Provider";case I:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case ue:return t=e.displayName||null,t!==null?t:de(e.type)||"Memo";case se:t=e._payload,e=e._init;try{return de(e(t))}catch{}}return null}function Ne(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return de(t);case 8:return t===Z?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ye(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function b(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function le(e){var t=b(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var l=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return l.call(this)},set:function(c){r=""+c,s.call(this,c)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(c){r=""+c},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ve(e){e._valueTracker||(e._valueTracker=le(e))}function ne(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=b(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function me(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function je(e,t){var n=t.checked;return S({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Pe(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=ye(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function xe(e,t){t=t.checked,t!=null&&re(e,"checked",t,!1)}function be(e,t){xe(e,t);var n=ye(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Ge(e,t.type,n):t.hasOwnProperty("defaultValue")&&Ge(e,t.type,ye(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function _e(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Ge(e,t,n){(t!=="number"||me(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var yt=Array.isArray;function ot(e,t,n,r){if(e=e.options,t){t={};for(var l=0;l<n.length;l++)t["$"+n[l]]=!0;for(n=0;n<e.length;n++)l=t.hasOwnProperty("$"+e[n].value),e[n].selected!==l&&(e[n].selected=l),l&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ye(n),t=null,l=0;l<e.length;l++){if(e[l].value===n){e[l].selected=!0,r&&(e[l].defaultSelected=!0);return}t!==null||e[l].disabled||(t=e[l])}t!==null&&(t.selected=!0)}}function Ke(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(u(91));return S({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ae(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(u(92));if(yt(n)){if(1<n.length)throw Error(u(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:ye(n)}}function gl(e,t){var n=ye(t.value),r=ye(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function yl(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function kr(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Sr(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?kr(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Qn,vl=(function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,l){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,l)})}:e})(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Qn=Qn||document.createElement("div"),Qn.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Qn.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function _n(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Dn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qs=["Webkit","ms","Moz","O"];Object.keys(Dn).forEach(function(e){qs.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Dn[t]=Dn[e]})});function xl(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Dn.hasOwnProperty(e)&&Dn[e]?(""+t).trim():t+"px"}function wl(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,l=xl(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,l):e[n]=l}}var Zs=S({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function jr(e,t){if(t){if(Zs[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(u(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(u(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(u(61))}if(t.style!=null&&typeof t.style!="object")throw Error(u(62))}}function Cr(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Er=null;function br(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Pr=null,Qt=null,Ft=null;function Nl(e){if(e=Xr(e)){if(typeof Pr!="function")throw Error(u(280));var t=e.stateNode;t&&(t=Xl(t),Pr(e.stateNode,e.type,t))}}function kl(e){Qt?Ft?Ft.push(e):Ft=[e]:Qt=e}function Sl(){if(Qt){var e=Qt,t=Ft;if(Ft=Qt=null,Nl(e),t)for(e=0;e<t.length;e++)Nl(t[e])}}function jl(e,t){return e(t)}function Gn(){}var Gt=!1;function Cl(e,t,n){if(Gt)return e(t,n);Gt=!0;try{return jl(e,t,n)}finally{Gt=!1,(Qt!==null||Ft!==null)&&(Gn(),Sl())}}function Dt(e,t){var n=e.stateNode;if(n===null)return null;var r=Xl(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(u(231,t,typeof n));return n}var Rn=!1;if(y)try{var sn={};Object.defineProperty(sn,"passive",{get:function(){Rn=!0}}),window.addEventListener("test",sn,sn),window.removeEventListener("test",sn,sn)}catch{Rn=!1}function eo(e,t,n,r,l,s,c,v,N){var M=Array.prototype.slice.call(arguments,3);try{t.apply(n,M)}catch(G){this.onError(G)}}var On=!1,Yn=null,Jn=!1,_r=null,to={onError:function(e){On=!0,Yn=e}};function Yt(e,t,n,r,l,s,c,v,N){On=!1,Yn=null,eo.apply(to,arguments)}function Dr(e,t,n,r,l,s,c,v,N){if(Yt.apply(this,arguments),On){if(On){var M=Yn;On=!1,Yn=null}else throw Error(u(198));Jn||(Jn=!0,_r=M)}}function Jt(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function El(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function bl(e){if(Jt(e)!==e)throw Error(u(188))}function no(e){var t=e.alternate;if(!t){if(t=Jt(e),t===null)throw Error(u(188));return t!==e?null:e}for(var n=e,r=t;;){var l=n.return;if(l===null)break;var s=l.alternate;if(s===null){if(r=l.return,r!==null){n=r;continue}break}if(l.child===s.child){for(s=l.child;s;){if(s===n)return bl(l),e;if(s===r)return bl(l),t;s=s.sibling}throw Error(u(188))}if(n.return!==r.return)n=l,r=s;else{for(var c=!1,v=l.child;v;){if(v===n){c=!0,n=l,r=s;break}if(v===r){c=!0,r=l,n=s;break}v=v.sibling}if(!c){for(v=s.child;v;){if(v===n){c=!0,n=s,r=l;break}if(v===r){c=!0,r=s,n=l;break}v=v.sibling}if(!c)throw Error(u(189))}}if(n.alternate!==r)throw Error(u(190))}if(n.tag!==3)throw Error(u(188));return n.stateNode.current===n?e:t}function Pl(e){return e=no(e),e!==null?_l(e):null}function _l(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=_l(e);if(t!==null)return t;e=e.sibling}return null}var Rr=a.unstable_scheduleCallback,Dl=a.unstable_cancelCallback,Or=a.unstable_shouldYield,ro=a.unstable_requestPaint,$e=a.unstable_now,lo=a.unstable_getCurrentPriorityLevel,we=a.unstable_ImmediatePriority,Oe=a.unstable_UserBlockingPriority,Ue=a.unstable_NormalPriority,St=a.unstable_LowPriority,Rl=a.unstable_IdlePriority,Ol=null,At=null;function md(e){if(At&&typeof At.onCommitFiberRoot=="function")try{At.onCommitFiberRoot(Ol,e,void 0,(e.current.flags&128)===128)}catch{}}var Rt=Math.clz32?Math.clz32:vd,gd=Math.log,yd=Math.LN2;function vd(e){return e>>>=0,e===0?32:31-(gd(e)/yd|0)|0}var Tl=64,Ll=4194304;function Tr(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function zl(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,l=e.suspendedLanes,s=e.pingedLanes,c=n&268435455;if(c!==0){var v=c&~l;v!==0?r=Tr(v):(s&=c,s!==0&&(r=Tr(s)))}else c=n&~l,c!==0?r=Tr(c):s!==0&&(r=Tr(s));if(r===0)return 0;if(t!==0&&t!==r&&(t&l)===0&&(l=r&-r,s=t&-t,l>=s||l===16&&(s&4194240)!==0))return t;if((r&4)!==0&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Rt(t),l=1<<n,r|=e[n],t&=~l;return r}function xd(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wd(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,l=e.expirationTimes,s=e.pendingLanes;0<s;){var c=31-Rt(s),v=1<<c,N=l[c];N===-1?((v&n)===0||(v&r)!==0)&&(l[c]=xd(v,t)):N<=t&&(e.expiredLanes|=v),s&=~v}}function so(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function ua(){var e=Tl;return Tl<<=1,(Tl&4194240)===0&&(Tl=64),e}function oo(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Lr(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Rt(t),e[t]=n}function Nd(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var l=31-Rt(n),s=1<<l;t[l]=0,r[l]=-1,e[l]=-1,n&=~s}}function io(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Rt(n),l=1<<r;l&t|e[r]&t&&(e[r]|=t),n&=~l}}var Te=0;function ca(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var da,ao,fa,ha,pa,uo=!1,Il=[],on=null,an=null,un=null,zr=new Map,Ir=new Map,cn=[],kd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ma(e,t){switch(e){case"focusin":case"focusout":on=null;break;case"dragenter":case"dragleave":an=null;break;case"mouseover":case"mouseout":un=null;break;case"pointerover":case"pointerout":zr.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ir.delete(t.pointerId)}}function Mr(e,t,n,r,l,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[l]},t!==null&&(t=Xr(t),t!==null&&ao(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,l!==null&&t.indexOf(l)===-1&&t.push(l),e)}function Sd(e,t,n,r,l){switch(t){case"focusin":return on=Mr(on,e,t,n,r,l),!0;case"dragenter":return an=Mr(an,e,t,n,r,l),!0;case"mouseover":return un=Mr(un,e,t,n,r,l),!0;case"pointerover":var s=l.pointerId;return zr.set(s,Mr(zr.get(s)||null,e,t,n,r,l)),!0;case"gotpointercapture":return s=l.pointerId,Ir.set(s,Mr(Ir.get(s)||null,e,t,n,r,l)),!0}return!1}function ga(e){var t=Tn(e.target);if(t!==null){var n=Jt(t);if(n!==null){if(t=n.tag,t===13){if(t=El(n),t!==null){e.blockedOn=t,pa(e.priority,function(){fa(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ml(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=fo(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Er=r,n.target.dispatchEvent(r),Er=null}else return t=Xr(n),t!==null&&ao(t),e.blockedOn=n,!1;t.shift()}return!0}function ya(e,t,n){Ml(e)&&n.delete(t)}function jd(){uo=!1,on!==null&&Ml(on)&&(on=null),an!==null&&Ml(an)&&(an=null),un!==null&&Ml(un)&&(un=null),zr.forEach(ya),Ir.forEach(ya)}function $r(e,t){e.blockedOn===t&&(e.blockedOn=null,uo||(uo=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,jd)))}function Fr(e){function t(l){return $r(l,e)}if(0<Il.length){$r(Il[0],e);for(var n=1;n<Il.length;n++){var r=Il[n];r.blockedOn===e&&(r.blockedOn=null)}}for(on!==null&&$r(on,e),an!==null&&$r(an,e),un!==null&&$r(un,e),zr.forEach(t),Ir.forEach(t),n=0;n<cn.length;n++)r=cn[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<cn.length&&(n=cn[0],n.blockedOn===null);)ga(n),n.blockedOn===null&&cn.shift()}var Xn=T.ReactCurrentBatchConfig,$l=!0;function Cd(e,t,n,r){var l=Te,s=Xn.transition;Xn.transition=null;try{Te=1,co(e,t,n,r)}finally{Te=l,Xn.transition=s}}function Ed(e,t,n,r){var l=Te,s=Xn.transition;Xn.transition=null;try{Te=4,co(e,t,n,r)}finally{Te=l,Xn.transition=s}}function co(e,t,n,r){if($l){var l=fo(e,t,n,r);if(l===null)_o(e,t,r,Fl,n),ma(e,r);else if(Sd(l,e,t,n,r))r.stopPropagation();else if(ma(e,r),t&4&&-1<kd.indexOf(e)){for(;l!==null;){var s=Xr(l);if(s!==null&&da(s),s=fo(e,t,n,r),s===null&&_o(e,t,r,Fl,n),s===l)break;l=s}l!==null&&r.stopPropagation()}else _o(e,t,r,null,n)}}var Fl=null;function fo(e,t,n,r){if(Fl=null,e=br(r),e=Tn(e),e!==null)if(t=Jt(e),t===null)e=null;else if(n=t.tag,n===13){if(e=El(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Fl=e,null}function va(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(lo()){case we:return 1;case Oe:return 4;case Ue:case St:return 16;case Rl:return 536870912;default:return 16}default:return 16}}var dn=null,ho=null,Al=null;function xa(){if(Al)return Al;var e,t=ho,n=t.length,r,l="value"in dn?dn.value:dn.textContent,s=l.length;for(e=0;e<n&&t[e]===l[e];e++);var c=n-e;for(r=1;r<=c&&t[n-r]===l[s-r];r++);return Al=l.slice(e,1<r?1-r:void 0)}function Ul(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Bl(){return!0}function wa(){return!1}function vt(e){function t(n,r,l,s,c){this._reactName=n,this._targetInst=l,this.type=r,this.nativeEvent=s,this.target=c,this.currentTarget=null;for(var v in e)e.hasOwnProperty(v)&&(n=e[v],this[v]=n?n(s):s[v]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Bl:wa,this.isPropagationStopped=wa,this}return S(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Bl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Bl)},persist:function(){},isPersistent:Bl}),t}var qn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},po=vt(qn),Ar=S({},qn,{view:0,detail:0}),bd=vt(Ar),mo,go,Ur,Hl=S({},Ar,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vo,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ur&&(Ur&&e.type==="mousemove"?(mo=e.screenX-Ur.screenX,go=e.screenY-Ur.screenY):go=mo=0,Ur=e),mo)},movementY:function(e){return"movementY"in e?e.movementY:go}}),Na=vt(Hl),Pd=S({},Hl,{dataTransfer:0}),_d=vt(Pd),Dd=S({},Ar,{relatedTarget:0}),yo=vt(Dd),Rd=S({},qn,{animationName:0,elapsedTime:0,pseudoElement:0}),Od=vt(Rd),Td=S({},qn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Ld=vt(Td),zd=S({},qn,{data:0}),ka=vt(zd),Id={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Md={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$d={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Fd(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=$d[e])?!!t[e]:!1}function vo(){return Fd}var Ad=S({},Ar,{key:function(e){if(e.key){var t=Id[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ul(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Md[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vo,charCode:function(e){return e.type==="keypress"?Ul(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ul(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Ud=vt(Ad),Bd=S({},Hl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Sa=vt(Bd),Hd=S({},Ar,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vo}),Vd=vt(Hd),Wd=S({},qn,{propertyName:0,elapsedTime:0,pseudoElement:0}),Kd=vt(Wd),Qd=S({},Hl,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Gd=vt(Qd),Yd=[9,13,27,32],xo=y&&"CompositionEvent"in window,Br=null;y&&"documentMode"in document&&(Br=document.documentMode);var Jd=y&&"TextEvent"in window&&!Br,ja=y&&(!xo||Br&&8<Br&&11>=Br),Ca=" ",Ea=!1;function ba(e,t){switch(e){case"keyup":return Yd.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Pa(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Zn=!1;function Xd(e,t){switch(e){case"compositionend":return Pa(t);case"keypress":return t.which!==32?null:(Ea=!0,Ca);case"textInput":return e=t.data,e===Ca&&Ea?null:e;default:return null}}function qd(e,t){if(Zn)return e==="compositionend"||!xo&&ba(e,t)?(e=xa(),Al=ho=dn=null,Zn=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return ja&&t.locale!=="ko"?null:t.data;default:return null}}var Zd={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _a(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Zd[e.type]:t==="textarea"}function Da(e,t,n,r){kl(r),t=Gl(t,"onChange"),0<t.length&&(n=new po("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Hr=null,Vr=null;function ef(e){Ga(e,0)}function Vl(e){var t=lr(e);if(ne(t))return e}function tf(e,t){if(e==="change")return t}var Ra=!1;if(y){var wo;if(y){var No="oninput"in document;if(!No){var Oa=document.createElement("div");Oa.setAttribute("oninput","return;"),No=typeof Oa.oninput=="function"}wo=No}else wo=!1;Ra=wo&&(!document.documentMode||9<document.documentMode)}function Ta(){Hr&&(Hr.detachEvent("onpropertychange",La),Vr=Hr=null)}function La(e){if(e.propertyName==="value"&&Vl(Vr)){var t=[];Da(t,Vr,e,br(e)),Cl(ef,t)}}function nf(e,t,n){e==="focusin"?(Ta(),Hr=t,Vr=n,Hr.attachEvent("onpropertychange",La)):e==="focusout"&&Ta()}function rf(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Vl(Vr)}function lf(e,t){if(e==="click")return Vl(t)}function sf(e,t){if(e==="input"||e==="change")return Vl(t)}function of(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ot=typeof Object.is=="function"?Object.is:of;function Wr(e,t){if(Ot(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var l=n[r];if(!x.call(t,l)||!Ot(e[l],t[l]))return!1}return!0}function za(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ia(e,t){var n=za(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=za(n)}}function Ma(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Ma(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function $a(){for(var e=window,t=me();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=me(e.document)}return t}function ko(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function af(e){var t=$a(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Ma(n.ownerDocument.documentElement,n)){if(r!==null&&ko(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var l=n.textContent.length,s=Math.min(r.start,l);r=r.end===void 0?s:Math.min(r.end,l),!e.extend&&s>r&&(l=r,r=s,s=l),l=Ia(n,s);var c=Ia(n,r);l&&c&&(e.rangeCount!==1||e.anchorNode!==l.node||e.anchorOffset!==l.offset||e.focusNode!==c.node||e.focusOffset!==c.offset)&&(t=t.createRange(),t.setStart(l.node,l.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(c.node,c.offset)):(t.setEnd(c.node,c.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var uf=y&&"documentMode"in document&&11>=document.documentMode,er=null,So=null,Kr=null,jo=!1;function Fa(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;jo||er==null||er!==me(r)||(r=er,"selectionStart"in r&&ko(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Kr&&Wr(Kr,r)||(Kr=r,r=Gl(So,"onSelect"),0<r.length&&(t=new po("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=er)))}function Wl(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var tr={animationend:Wl("Animation","AnimationEnd"),animationiteration:Wl("Animation","AnimationIteration"),animationstart:Wl("Animation","AnimationStart"),transitionend:Wl("Transition","TransitionEnd")},Co={},Aa={};y&&(Aa=document.createElement("div").style,"AnimationEvent"in window||(delete tr.animationend.animation,delete tr.animationiteration.animation,delete tr.animationstart.animation),"TransitionEvent"in window||delete tr.transitionend.transition);function Kl(e){if(Co[e])return Co[e];if(!tr[e])return e;var t=tr[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Aa)return Co[e]=t[n];return e}var Ua=Kl("animationend"),Ba=Kl("animationiteration"),Ha=Kl("animationstart"),Va=Kl("transitionend"),Wa=new Map,Ka="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function fn(e,t){Wa.set(e,t),h(t,[e])}for(var Eo=0;Eo<Ka.length;Eo++){var bo=Ka[Eo],cf=bo.toLowerCase(),df=bo[0].toUpperCase()+bo.slice(1);fn(cf,"on"+df)}fn(Ua,"onAnimationEnd"),fn(Ba,"onAnimationIteration"),fn(Ha,"onAnimationStart"),fn("dblclick","onDoubleClick"),fn("focusin","onFocus"),fn("focusout","onBlur"),fn(Va,"onTransitionEnd"),p("onMouseEnter",["mouseout","mouseover"]),p("onMouseLeave",["mouseout","mouseover"]),p("onPointerEnter",["pointerout","pointerover"]),p("onPointerLeave",["pointerout","pointerover"]),h("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),h("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),h("onBeforeInput",["compositionend","keypress","textInput","paste"]),h("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),h("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),h("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Qr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ff=new Set("cancel close invalid load scroll toggle".split(" ").concat(Qr));function Qa(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Dr(r,t,void 0,e),e.currentTarget=null}function Ga(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],l=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var c=r.length-1;0<=c;c--){var v=r[c],N=v.instance,M=v.currentTarget;if(v=v.listener,N!==s&&l.isPropagationStopped())break e;Qa(l,v,M),s=N}else for(c=0;c<r.length;c++){if(v=r[c],N=v.instance,M=v.currentTarget,v=v.listener,N!==s&&l.isPropagationStopped())break e;Qa(l,v,M),s=N}}}if(Jn)throw e=_r,Jn=!1,_r=null,e}function Ie(e,t){var n=t[zo];n===void 0&&(n=t[zo]=new Set);var r=e+"__bubble";n.has(r)||(Ya(t,e,2,!1),n.add(r))}function Po(e,t,n){var r=0;t&&(r|=4),Ya(n,e,r,t)}var Ql="_reactListening"+Math.random().toString(36).slice(2);function Gr(e){if(!e[Ql]){e[Ql]=!0,d.forEach(function(n){n!=="selectionchange"&&(ff.has(n)||Po(n,!1,e),Po(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ql]||(t[Ql]=!0,Po("selectionchange",!1,t))}}function Ya(e,t,n,r){switch(va(t)){case 1:var l=Cd;break;case 4:l=Ed;break;default:l=co}n=l.bind(null,t,n,e),l=void 0,!Rn||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(l=!0),r?l!==void 0?e.addEventListener(t,n,{capture:!0,passive:l}):e.addEventListener(t,n,!0):l!==void 0?e.addEventListener(t,n,{passive:l}):e.addEventListener(t,n,!1)}function _o(e,t,n,r,l){var s=r;if((t&1)===0&&(t&2)===0&&r!==null)e:for(;;){if(r===null)return;var c=r.tag;if(c===3||c===4){var v=r.stateNode.containerInfo;if(v===l||v.nodeType===8&&v.parentNode===l)break;if(c===4)for(c=r.return;c!==null;){var N=c.tag;if((N===3||N===4)&&(N=c.stateNode.containerInfo,N===l||N.nodeType===8&&N.parentNode===l))return;c=c.return}for(;v!==null;){if(c=Tn(v),c===null)return;if(N=c.tag,N===5||N===6){r=s=c;continue e}v=v.parentNode}}r=r.return}Cl(function(){var M=s,G=br(n),X=[];e:{var K=Wa.get(e);if(K!==void 0){var ie=po,he=e;switch(e){case"keypress":if(Ul(n)===0)break e;case"keydown":case"keyup":ie=Ud;break;case"focusin":he="focus",ie=yo;break;case"focusout":he="blur",ie=yo;break;case"beforeblur":case"afterblur":ie=yo;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ie=Na;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ie=_d;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ie=Vd;break;case Ua:case Ba:case Ha:ie=Od;break;case Va:ie=Kd;break;case"scroll":ie=bd;break;case"wheel":ie=Gd;break;case"copy":case"cut":case"paste":ie=Ld;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ie=Sa}var pe=(t&4)!==0,We=!pe&&e==="scroll",_=pe?K!==null?K+"Capture":null:K;pe=[];for(var j=M,R;j!==null;){R=j;var ee=R.stateNode;if(R.tag===5&&ee!==null&&(R=ee,_!==null&&(ee=Dt(j,_),ee!=null&&pe.push(Yr(j,ee,R)))),We)break;j=j.return}0<pe.length&&(K=new ie(K,he,null,n,G),X.push({event:K,listeners:pe}))}}if((t&7)===0){e:{if(K=e==="mouseover"||e==="pointerover",ie=e==="mouseout"||e==="pointerout",K&&n!==Er&&(he=n.relatedTarget||n.fromElement)&&(Tn(he)||he[Xt]))break e;if((ie||K)&&(K=G.window===G?G:(K=G.ownerDocument)?K.defaultView||K.parentWindow:window,ie?(he=n.relatedTarget||n.toElement,ie=M,he=he?Tn(he):null,he!==null&&(We=Jt(he),he!==We||he.tag!==5&&he.tag!==6)&&(he=null)):(ie=null,he=M),ie!==he)){if(pe=Na,ee="onMouseLeave",_="onMouseEnter",j="mouse",(e==="pointerout"||e==="pointerover")&&(pe=Sa,ee="onPointerLeave",_="onPointerEnter",j="pointer"),We=ie==null?K:lr(ie),R=he==null?K:lr(he),K=new pe(ee,j+"leave",ie,n,G),K.target=We,K.relatedTarget=R,ee=null,Tn(G)===M&&(pe=new pe(_,j+"enter",he,n,G),pe.target=R,pe.relatedTarget=We,ee=pe),We=ee,ie&&he)t:{for(pe=ie,_=he,j=0,R=pe;R;R=nr(R))j++;for(R=0,ee=_;ee;ee=nr(ee))R++;for(;0<j-R;)pe=nr(pe),j--;for(;0<R-j;)_=nr(_),R--;for(;j--;){if(pe===_||_!==null&&pe===_.alternate)break t;pe=nr(pe),_=nr(_)}pe=null}else pe=null;ie!==null&&Ja(X,K,ie,pe,!1),he!==null&&We!==null&&Ja(X,We,he,pe,!0)}}e:{if(K=M?lr(M):window,ie=K.nodeName&&K.nodeName.toLowerCase(),ie==="select"||ie==="input"&&K.type==="file")var ge=tf;else if(_a(K))if(Ra)ge=sf;else{ge=rf;var ke=nf}else(ie=K.nodeName)&&ie.toLowerCase()==="input"&&(K.type==="checkbox"||K.type==="radio")&&(ge=lf);if(ge&&(ge=ge(e,M))){Da(X,ge,n,G);break e}ke&&ke(e,K,M),e==="focusout"&&(ke=K._wrapperState)&&ke.controlled&&K.type==="number"&&Ge(K,"number",K.value)}switch(ke=M?lr(M):window,e){case"focusin":(_a(ke)||ke.contentEditable==="true")&&(er=ke,So=M,Kr=null);break;case"focusout":Kr=So=er=null;break;case"mousedown":jo=!0;break;case"contextmenu":case"mouseup":case"dragend":jo=!1,Fa(X,n,G);break;case"selectionchange":if(uf)break;case"keydown":case"keyup":Fa(X,n,G)}var Se;if(xo)e:{switch(e){case"compositionstart":var Ce="onCompositionStart";break e;case"compositionend":Ce="onCompositionEnd";break e;case"compositionupdate":Ce="onCompositionUpdate";break e}Ce=void 0}else Zn?ba(e,n)&&(Ce="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(Ce="onCompositionStart");Ce&&(ja&&n.locale!=="ko"&&(Zn||Ce!=="onCompositionStart"?Ce==="onCompositionEnd"&&Zn&&(Se=xa()):(dn=G,ho="value"in dn?dn.value:dn.textContent,Zn=!0)),ke=Gl(M,Ce),0<ke.length&&(Ce=new ka(Ce,e,null,n,G),X.push({event:Ce,listeners:ke}),Se?Ce.data=Se:(Se=Pa(n),Se!==null&&(Ce.data=Se)))),(Se=Jd?Xd(e,n):qd(e,n))&&(M=Gl(M,"onBeforeInput"),0<M.length&&(G=new ka("onBeforeInput","beforeinput",null,n,G),X.push({event:G,listeners:M}),G.data=Se))}Ga(X,t)})}function Yr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Gl(e,t){for(var n=t+"Capture",r=[];e!==null;){var l=e,s=l.stateNode;l.tag===5&&s!==null&&(l=s,s=Dt(e,n),s!=null&&r.unshift(Yr(e,s,l)),s=Dt(e,t),s!=null&&r.push(Yr(e,s,l))),e=e.return}return r}function nr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Ja(e,t,n,r,l){for(var s=t._reactName,c=[];n!==null&&n!==r;){var v=n,N=v.alternate,M=v.stateNode;if(N!==null&&N===r)break;v.tag===5&&M!==null&&(v=M,l?(N=Dt(n,s),N!=null&&c.unshift(Yr(n,N,v))):l||(N=Dt(n,s),N!=null&&c.push(Yr(n,N,v)))),n=n.return}c.length!==0&&e.push({event:t,listeners:c})}var hf=/\r\n?/g,pf=/\u0000|\uFFFD/g;function Xa(e){return(typeof e=="string"?e:""+e).replace(hf,`
`).replace(pf,"")}function Yl(e,t,n){if(t=Xa(t),Xa(e)!==t&&n)throw Error(u(425))}function Jl(){}var Do=null,Ro=null;function Oo(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var To=typeof setTimeout=="function"?setTimeout:void 0,mf=typeof clearTimeout=="function"?clearTimeout:void 0,qa=typeof Promise=="function"?Promise:void 0,gf=typeof queueMicrotask=="function"?queueMicrotask:typeof qa<"u"?function(e){return qa.resolve(null).then(e).catch(yf)}:To;function yf(e){setTimeout(function(){throw e})}function Lo(e,t){var n=t,r=0;do{var l=n.nextSibling;if(e.removeChild(n),l&&l.nodeType===8)if(n=l.data,n==="/$"){if(r===0){e.removeChild(l),Fr(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=l}while(n);Fr(t)}function hn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Za(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var rr=Math.random().toString(36).slice(2),Ut="__reactFiber$"+rr,Jr="__reactProps$"+rr,Xt="__reactContainer$"+rr,zo="__reactEvents$"+rr,vf="__reactListeners$"+rr,xf="__reactHandles$"+rr;function Tn(e){var t=e[Ut];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Xt]||n[Ut]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Za(e);e!==null;){if(n=e[Ut])return n;e=Za(e)}return t}e=n,n=e.parentNode}return null}function Xr(e){return e=e[Ut]||e[Xt],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function lr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(u(33))}function Xl(e){return e[Jr]||null}var Io=[],sr=-1;function pn(e){return{current:e}}function Me(e){0>sr||(e.current=Io[sr],Io[sr]=null,sr--)}function Le(e,t){sr++,Io[sr]=e.current,e.current=t}var mn={},nt=pn(mn),ct=pn(!1),Ln=mn;function or(e,t){var n=e.type.contextTypes;if(!n)return mn;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var l={},s;for(s in n)l[s]=t[s];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=l),l}function dt(e){return e=e.childContextTypes,e!=null}function ql(){Me(ct),Me(nt)}function eu(e,t,n){if(nt.current!==mn)throw Error(u(168));Le(nt,t),Le(ct,n)}function tu(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var l in r)if(!(l in t))throw Error(u(108,Ne(e)||"Unknown",l));return S({},n,r)}function Zl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||mn,Ln=nt.current,Le(nt,e),Le(ct,ct.current),!0}function nu(e,t,n){var r=e.stateNode;if(!r)throw Error(u(169));n?(e=tu(e,t,Ln),r.__reactInternalMemoizedMergedChildContext=e,Me(ct),Me(nt),Le(nt,e)):Me(ct),Le(ct,n)}var qt=null,es=!1,Mo=!1;function ru(e){qt===null?qt=[e]:qt.push(e)}function wf(e){es=!0,ru(e)}function gn(){if(!Mo&&qt!==null){Mo=!0;var e=0,t=Te;try{var n=qt;for(Te=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}qt=null,es=!1}catch(l){throw qt!==null&&(qt=qt.slice(e+1)),Rr(we,gn),l}finally{Te=t,Mo=!1}}return null}var ir=[],ar=0,ts=null,ns=0,jt=[],Ct=0,zn=null,Zt=1,en="";function In(e,t){ir[ar++]=ns,ir[ar++]=ts,ts=e,ns=t}function lu(e,t,n){jt[Ct++]=Zt,jt[Ct++]=en,jt[Ct++]=zn,zn=e;var r=Zt;e=en;var l=32-Rt(r)-1;r&=~(1<<l),n+=1;var s=32-Rt(t)+l;if(30<s){var c=l-l%5;s=(r&(1<<c)-1).toString(32),r>>=c,l-=c,Zt=1<<32-Rt(t)+l|n<<l|r,en=s+e}else Zt=1<<s|n<<l|r,en=e}function $o(e){e.return!==null&&(In(e,1),lu(e,1,0))}function Fo(e){for(;e===ts;)ts=ir[--ar],ir[ar]=null,ns=ir[--ar],ir[ar]=null;for(;e===zn;)zn=jt[--Ct],jt[Ct]=null,en=jt[--Ct],jt[Ct]=null,Zt=jt[--Ct],jt[Ct]=null}var xt=null,wt=null,Fe=!1,Tt=null;function su(e,t){var n=_t(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function ou(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,xt=e,wt=hn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,xt=e,wt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=zn!==null?{id:Zt,overflow:en}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=_t(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,xt=e,wt=null,!0):!1;default:return!1}}function Ao(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Uo(e){if(Fe){var t=wt;if(t){var n=t;if(!ou(e,t)){if(Ao(e))throw Error(u(418));t=hn(n.nextSibling);var r=xt;t&&ou(e,t)?su(r,n):(e.flags=e.flags&-4097|2,Fe=!1,xt=e)}}else{if(Ao(e))throw Error(u(418));e.flags=e.flags&-4097|2,Fe=!1,xt=e}}}function iu(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;xt=e}function rs(e){if(e!==xt)return!1;if(!Fe)return iu(e),Fe=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Oo(e.type,e.memoizedProps)),t&&(t=wt)){if(Ao(e))throw au(),Error(u(418));for(;t;)su(e,t),t=hn(t.nextSibling)}if(iu(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(u(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){wt=hn(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}wt=null}}else wt=xt?hn(e.stateNode.nextSibling):null;return!0}function au(){for(var e=wt;e;)e=hn(e.nextSibling)}function ur(){wt=xt=null,Fe=!1}function Bo(e){Tt===null?Tt=[e]:Tt.push(e)}var Nf=T.ReactCurrentBatchConfig;function qr(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(u(309));var r=n.stateNode}if(!r)throw Error(u(147,e));var l=r,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(c){var v=l.refs;c===null?delete v[s]:v[s]=c},t._stringRef=s,t)}if(typeof e!="string")throw Error(u(284));if(!n._owner)throw Error(u(290,e))}return e}function ls(e,t){throw e=Object.prototype.toString.call(t),Error(u(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function uu(e){var t=e._init;return t(e._payload)}function cu(e){function t(_,j){if(e){var R=_.deletions;R===null?(_.deletions=[j],_.flags|=16):R.push(j)}}function n(_,j){if(!e)return null;for(;j!==null;)t(_,j),j=j.sibling;return null}function r(_,j){for(_=new Map;j!==null;)j.key!==null?_.set(j.key,j):_.set(j.index,j),j=j.sibling;return _}function l(_,j){return _=jn(_,j),_.index=0,_.sibling=null,_}function s(_,j,R){return _.index=R,e?(R=_.alternate,R!==null?(R=R.index,R<j?(_.flags|=2,j):R):(_.flags|=2,j)):(_.flags|=1048576,j)}function c(_){return e&&_.alternate===null&&(_.flags|=2),_}function v(_,j,R,ee){return j===null||j.tag!==6?(j=Ti(R,_.mode,ee),j.return=_,j):(j=l(j,R),j.return=_,j)}function N(_,j,R,ee){var ge=R.type;return ge===L?G(_,j,R.props.children,ee,R.key):j!==null&&(j.elementType===ge||typeof ge=="object"&&ge!==null&&ge.$$typeof===se&&uu(ge)===j.type)?(ee=l(j,R.props),ee.ref=qr(_,j,R),ee.return=_,ee):(ee=Ps(R.type,R.key,R.props,null,_.mode,ee),ee.ref=qr(_,j,R),ee.return=_,ee)}function M(_,j,R,ee){return j===null||j.tag!==4||j.stateNode.containerInfo!==R.containerInfo||j.stateNode.implementation!==R.implementation?(j=Li(R,_.mode,ee),j.return=_,j):(j=l(j,R.children||[]),j.return=_,j)}function G(_,j,R,ee,ge){return j===null||j.tag!==7?(j=Vn(R,_.mode,ee,ge),j.return=_,j):(j=l(j,R),j.return=_,j)}function X(_,j,R){if(typeof j=="string"&&j!==""||typeof j=="number")return j=Ti(""+j,_.mode,R),j.return=_,j;if(typeof j=="object"&&j!==null){switch(j.$$typeof){case Q:return R=Ps(j.type,j.key,j.props,null,_.mode,R),R.ref=qr(_,null,j),R.return=_,R;case q:return j=Li(j,_.mode,R),j.return=_,j;case se:var ee=j._init;return X(_,ee(j._payload),R)}if(yt(j)||$(j))return j=Vn(j,_.mode,R,null),j.return=_,j;ls(_,j)}return null}function K(_,j,R,ee){var ge=j!==null?j.key:null;if(typeof R=="string"&&R!==""||typeof R=="number")return ge!==null?null:v(_,j,""+R,ee);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case Q:return R.key===ge?N(_,j,R,ee):null;case q:return R.key===ge?M(_,j,R,ee):null;case se:return ge=R._init,K(_,j,ge(R._payload),ee)}if(yt(R)||$(R))return ge!==null?null:G(_,j,R,ee,null);ls(_,R)}return null}function ie(_,j,R,ee,ge){if(typeof ee=="string"&&ee!==""||typeof ee=="number")return _=_.get(R)||null,v(j,_,""+ee,ge);if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case Q:return _=_.get(ee.key===null?R:ee.key)||null,N(j,_,ee,ge);case q:return _=_.get(ee.key===null?R:ee.key)||null,M(j,_,ee,ge);case se:var ke=ee._init;return ie(_,j,R,ke(ee._payload),ge)}if(yt(ee)||$(ee))return _=_.get(R)||null,G(j,_,ee,ge,null);ls(j,ee)}return null}function he(_,j,R,ee){for(var ge=null,ke=null,Se=j,Ce=j=0,Ze=null;Se!==null&&Ce<R.length;Ce++){Se.index>Ce?(Ze=Se,Se=null):Ze=Se.sibling;var Re=K(_,Se,R[Ce],ee);if(Re===null){Se===null&&(Se=Ze);break}e&&Se&&Re.alternate===null&&t(_,Se),j=s(Re,j,Ce),ke===null?ge=Re:ke.sibling=Re,ke=Re,Se=Ze}if(Ce===R.length)return n(_,Se),Fe&&In(_,Ce),ge;if(Se===null){for(;Ce<R.length;Ce++)Se=X(_,R[Ce],ee),Se!==null&&(j=s(Se,j,Ce),ke===null?ge=Se:ke.sibling=Se,ke=Se);return Fe&&In(_,Ce),ge}for(Se=r(_,Se);Ce<R.length;Ce++)Ze=ie(Se,_,Ce,R[Ce],ee),Ze!==null&&(e&&Ze.alternate!==null&&Se.delete(Ze.key===null?Ce:Ze.key),j=s(Ze,j,Ce),ke===null?ge=Ze:ke.sibling=Ze,ke=Ze);return e&&Se.forEach(function(Cn){return t(_,Cn)}),Fe&&In(_,Ce),ge}function pe(_,j,R,ee){var ge=$(R);if(typeof ge!="function")throw Error(u(150));if(R=ge.call(R),R==null)throw Error(u(151));for(var ke=ge=null,Se=j,Ce=j=0,Ze=null,Re=R.next();Se!==null&&!Re.done;Ce++,Re=R.next()){Se.index>Ce?(Ze=Se,Se=null):Ze=Se.sibling;var Cn=K(_,Se,Re.value,ee);if(Cn===null){Se===null&&(Se=Ze);break}e&&Se&&Cn.alternate===null&&t(_,Se),j=s(Cn,j,Ce),ke===null?ge=Cn:ke.sibling=Cn,ke=Cn,Se=Ze}if(Re.done)return n(_,Se),Fe&&In(_,Ce),ge;if(Se===null){for(;!Re.done;Ce++,Re=R.next())Re=X(_,Re.value,ee),Re!==null&&(j=s(Re,j,Ce),ke===null?ge=Re:ke.sibling=Re,ke=Re);return Fe&&In(_,Ce),ge}for(Se=r(_,Se);!Re.done;Ce++,Re=R.next())Re=ie(Se,_,Ce,Re.value,ee),Re!==null&&(e&&Re.alternate!==null&&Se.delete(Re.key===null?Ce:Re.key),j=s(Re,j,Ce),ke===null?ge=Re:ke.sibling=Re,ke=Re);return e&&Se.forEach(function(eh){return t(_,eh)}),Fe&&In(_,Ce),ge}function We(_,j,R,ee){if(typeof R=="object"&&R!==null&&R.type===L&&R.key===null&&(R=R.props.children),typeof R=="object"&&R!==null){switch(R.$$typeof){case Q:e:{for(var ge=R.key,ke=j;ke!==null;){if(ke.key===ge){if(ge=R.type,ge===L){if(ke.tag===7){n(_,ke.sibling),j=l(ke,R.props.children),j.return=_,_=j;break e}}else if(ke.elementType===ge||typeof ge=="object"&&ge!==null&&ge.$$typeof===se&&uu(ge)===ke.type){n(_,ke.sibling),j=l(ke,R.props),j.ref=qr(_,ke,R),j.return=_,_=j;break e}n(_,ke);break}else t(_,ke);ke=ke.sibling}R.type===L?(j=Vn(R.props.children,_.mode,ee,R.key),j.return=_,_=j):(ee=Ps(R.type,R.key,R.props,null,_.mode,ee),ee.ref=qr(_,j,R),ee.return=_,_=ee)}return c(_);case q:e:{for(ke=R.key;j!==null;){if(j.key===ke)if(j.tag===4&&j.stateNode.containerInfo===R.containerInfo&&j.stateNode.implementation===R.implementation){n(_,j.sibling),j=l(j,R.children||[]),j.return=_,_=j;break e}else{n(_,j);break}else t(_,j);j=j.sibling}j=Li(R,_.mode,ee),j.return=_,_=j}return c(_);case se:return ke=R._init,We(_,j,ke(R._payload),ee)}if(yt(R))return he(_,j,R,ee);if($(R))return pe(_,j,R,ee);ls(_,R)}return typeof R=="string"&&R!==""||typeof R=="number"?(R=""+R,j!==null&&j.tag===6?(n(_,j.sibling),j=l(j,R),j.return=_,_=j):(n(_,j),j=Ti(R,_.mode,ee),j.return=_,_=j),c(_)):n(_,j)}return We}var cr=cu(!0),du=cu(!1),ss=pn(null),os=null,dr=null,Ho=null;function Vo(){Ho=dr=os=null}function Wo(e){var t=ss.current;Me(ss),e._currentValue=t}function Ko(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function fr(e,t){os=e,Ho=dr=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&t)!==0&&(ft=!0),e.firstContext=null)}function Et(e){var t=e._currentValue;if(Ho!==e)if(e={context:e,memoizedValue:t,next:null},dr===null){if(os===null)throw Error(u(308));dr=e,os.dependencies={lanes:0,firstContext:e}}else dr=dr.next=e;return t}var Mn=null;function Qo(e){Mn===null?Mn=[e]:Mn.push(e)}function fu(e,t,n,r){var l=t.interleaved;return l===null?(n.next=n,Qo(t)):(n.next=l.next,l.next=n),t.interleaved=n,tn(e,r)}function tn(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var yn=!1;function Go(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function hu(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function nn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function vn(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,(De&2)!==0){var l=r.pending;return l===null?t.next=t:(t.next=l.next,l.next=t),r.pending=t,tn(e,n)}return l=r.interleaved,l===null?(t.next=t,Qo(r)):(t.next=l.next,l.next=t),r.interleaved=t,tn(e,n)}function is(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,io(e,n)}}function pu(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var l=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var c={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?l=s=c:s=s.next=c,n=n.next}while(n!==null);s===null?l=s=t:s=s.next=t}else l=s=t;n={baseState:r.baseState,firstBaseUpdate:l,lastBaseUpdate:s,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function as(e,t,n,r){var l=e.updateQueue;yn=!1;var s=l.firstBaseUpdate,c=l.lastBaseUpdate,v=l.shared.pending;if(v!==null){l.shared.pending=null;var N=v,M=N.next;N.next=null,c===null?s=M:c.next=M,c=N;var G=e.alternate;G!==null&&(G=G.updateQueue,v=G.lastBaseUpdate,v!==c&&(v===null?G.firstBaseUpdate=M:v.next=M,G.lastBaseUpdate=N))}if(s!==null){var X=l.baseState;c=0,G=M=N=null,v=s;do{var K=v.lane,ie=v.eventTime;if((r&K)===K){G!==null&&(G=G.next={eventTime:ie,lane:0,tag:v.tag,payload:v.payload,callback:v.callback,next:null});e:{var he=e,pe=v;switch(K=t,ie=n,pe.tag){case 1:if(he=pe.payload,typeof he=="function"){X=he.call(ie,X,K);break e}X=he;break e;case 3:he.flags=he.flags&-65537|128;case 0:if(he=pe.payload,K=typeof he=="function"?he.call(ie,X,K):he,K==null)break e;X=S({},X,K);break e;case 2:yn=!0}}v.callback!==null&&v.lane!==0&&(e.flags|=64,K=l.effects,K===null?l.effects=[v]:K.push(v))}else ie={eventTime:ie,lane:K,tag:v.tag,payload:v.payload,callback:v.callback,next:null},G===null?(M=G=ie,N=X):G=G.next=ie,c|=K;if(v=v.next,v===null){if(v=l.shared.pending,v===null)break;K=v,v=K.next,K.next=null,l.lastBaseUpdate=K,l.shared.pending=null}}while(!0);if(G===null&&(N=X),l.baseState=N,l.firstBaseUpdate=M,l.lastBaseUpdate=G,t=l.shared.interleaved,t!==null){l=t;do c|=l.lane,l=l.next;while(l!==t)}else s===null&&(l.shared.lanes=0);An|=c,e.lanes=c,e.memoizedState=X}}function mu(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],l=r.callback;if(l!==null){if(r.callback=null,r=n,typeof l!="function")throw Error(u(191,l));l.call(r)}}}var Zr={},Bt=pn(Zr),el=pn(Zr),tl=pn(Zr);function $n(e){if(e===Zr)throw Error(u(174));return e}function Yo(e,t){switch(Le(tl,t),Le(el,e),Le(Bt,Zr),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Sr(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Sr(t,e)}Me(Bt),Le(Bt,t)}function hr(){Me(Bt),Me(el),Me(tl)}function gu(e){$n(tl.current);var t=$n(Bt.current),n=Sr(t,e.type);t!==n&&(Le(el,e),Le(Bt,n))}function Jo(e){el.current===e&&(Me(Bt),Me(el))}var Be=pn(0);function us(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Xo=[];function qo(){for(var e=0;e<Xo.length;e++)Xo[e]._workInProgressVersionPrimary=null;Xo.length=0}var cs=T.ReactCurrentDispatcher,Zo=T.ReactCurrentBatchConfig,Fn=0,He=null,Ye=null,Xe=null,ds=!1,nl=!1,rl=0,kf=0;function rt(){throw Error(u(321))}function ei(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Ot(e[n],t[n]))return!1;return!0}function ti(e,t,n,r,l,s){if(Fn=s,He=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,cs.current=e===null||e.memoizedState===null?Ef:bf,e=n(r,l),nl){s=0;do{if(nl=!1,rl=0,25<=s)throw Error(u(301));s+=1,Xe=Ye=null,t.updateQueue=null,cs.current=Pf,e=n(r,l)}while(nl)}if(cs.current=ps,t=Ye!==null&&Ye.next!==null,Fn=0,Xe=Ye=He=null,ds=!1,t)throw Error(u(300));return e}function ni(){var e=rl!==0;return rl=0,e}function Ht(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xe===null?He.memoizedState=Xe=e:Xe=Xe.next=e,Xe}function bt(){if(Ye===null){var e=He.alternate;e=e!==null?e.memoizedState:null}else e=Ye.next;var t=Xe===null?He.memoizedState:Xe.next;if(t!==null)Xe=t,Ye=e;else{if(e===null)throw Error(u(310));Ye=e,e={memoizedState:Ye.memoizedState,baseState:Ye.baseState,baseQueue:Ye.baseQueue,queue:Ye.queue,next:null},Xe===null?He.memoizedState=Xe=e:Xe=Xe.next=e}return Xe}function ll(e,t){return typeof t=="function"?t(e):t}function ri(e){var t=bt(),n=t.queue;if(n===null)throw Error(u(311));n.lastRenderedReducer=e;var r=Ye,l=r.baseQueue,s=n.pending;if(s!==null){if(l!==null){var c=l.next;l.next=s.next,s.next=c}r.baseQueue=l=s,n.pending=null}if(l!==null){s=l.next,r=r.baseState;var v=c=null,N=null,M=s;do{var G=M.lane;if((Fn&G)===G)N!==null&&(N=N.next={lane:0,action:M.action,hasEagerState:M.hasEagerState,eagerState:M.eagerState,next:null}),r=M.hasEagerState?M.eagerState:e(r,M.action);else{var X={lane:G,action:M.action,hasEagerState:M.hasEagerState,eagerState:M.eagerState,next:null};N===null?(v=N=X,c=r):N=N.next=X,He.lanes|=G,An|=G}M=M.next}while(M!==null&&M!==s);N===null?c=r:N.next=v,Ot(r,t.memoizedState)||(ft=!0),t.memoizedState=r,t.baseState=c,t.baseQueue=N,n.lastRenderedState=r}if(e=n.interleaved,e!==null){l=e;do s=l.lane,He.lanes|=s,An|=s,l=l.next;while(l!==e)}else l===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function li(e){var t=bt(),n=t.queue;if(n===null)throw Error(u(311));n.lastRenderedReducer=e;var r=n.dispatch,l=n.pending,s=t.memoizedState;if(l!==null){n.pending=null;var c=l=l.next;do s=e(s,c.action),c=c.next;while(c!==l);Ot(s,t.memoizedState)||(ft=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function yu(){}function vu(e,t){var n=He,r=bt(),l=t(),s=!Ot(r.memoizedState,l);if(s&&(r.memoizedState=l,ft=!0),r=r.queue,si(Nu.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||Xe!==null&&Xe.memoizedState.tag&1){if(n.flags|=2048,sl(9,wu.bind(null,n,r,l,t),void 0,null),qe===null)throw Error(u(349));(Fn&30)!==0||xu(n,t,l)}return l}function xu(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=He.updateQueue,t===null?(t={lastEffect:null,stores:null},He.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function wu(e,t,n,r){t.value=n,t.getSnapshot=r,ku(t)&&Su(e)}function Nu(e,t,n){return n(function(){ku(t)&&Su(e)})}function ku(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Ot(e,n)}catch{return!0}}function Su(e){var t=tn(e,1);t!==null&&Mt(t,e,1,-1)}function ju(e){var t=Ht();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ll,lastRenderedState:e},t.queue=e,e=e.dispatch=Cf.bind(null,He,e),[t.memoizedState,e]}function sl(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=He.updateQueue,t===null?(t={lastEffect:null,stores:null},He.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function Cu(){return bt().memoizedState}function fs(e,t,n,r){var l=Ht();He.flags|=e,l.memoizedState=sl(1|t,n,void 0,r===void 0?null:r)}function hs(e,t,n,r){var l=bt();r=r===void 0?null:r;var s=void 0;if(Ye!==null){var c=Ye.memoizedState;if(s=c.destroy,r!==null&&ei(r,c.deps)){l.memoizedState=sl(t,n,s,r);return}}He.flags|=e,l.memoizedState=sl(1|t,n,s,r)}function Eu(e,t){return fs(8390656,8,e,t)}function si(e,t){return hs(2048,8,e,t)}function bu(e,t){return hs(4,2,e,t)}function Pu(e,t){return hs(4,4,e,t)}function _u(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Du(e,t,n){return n=n!=null?n.concat([e]):null,hs(4,4,_u.bind(null,t,e),n)}function oi(){}function Ru(e,t){var n=bt();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&ei(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ou(e,t){var n=bt();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&ei(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Tu(e,t,n){return(Fn&21)===0?(e.baseState&&(e.baseState=!1,ft=!0),e.memoizedState=n):(Ot(n,t)||(n=ua(),He.lanes|=n,An|=n,e.baseState=!0),t)}function Sf(e,t){var n=Te;Te=n!==0&&4>n?n:4,e(!0);var r=Zo.transition;Zo.transition={};try{e(!1),t()}finally{Te=n,Zo.transition=r}}function Lu(){return bt().memoizedState}function jf(e,t,n){var r=kn(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},zu(e))Iu(t,n);else if(n=fu(e,t,n,r),n!==null){var l=at();Mt(n,e,r,l),Mu(n,t,r)}}function Cf(e,t,n){var r=kn(e),l={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(zu(e))Iu(t,l);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var c=t.lastRenderedState,v=s(c,n);if(l.hasEagerState=!0,l.eagerState=v,Ot(v,c)){var N=t.interleaved;N===null?(l.next=l,Qo(t)):(l.next=N.next,N.next=l),t.interleaved=l;return}}catch{}n=fu(e,t,l,r),n!==null&&(l=at(),Mt(n,e,r,l),Mu(n,t,r))}}function zu(e){var t=e.alternate;return e===He||t!==null&&t===He}function Iu(e,t){nl=ds=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Mu(e,t,n){if((n&4194240)!==0){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,io(e,n)}}var ps={readContext:Et,useCallback:rt,useContext:rt,useEffect:rt,useImperativeHandle:rt,useInsertionEffect:rt,useLayoutEffect:rt,useMemo:rt,useReducer:rt,useRef:rt,useState:rt,useDebugValue:rt,useDeferredValue:rt,useTransition:rt,useMutableSource:rt,useSyncExternalStore:rt,useId:rt,unstable_isNewReconciler:!1},Ef={readContext:Et,useCallback:function(e,t){return Ht().memoizedState=[e,t===void 0?null:t],e},useContext:Et,useEffect:Eu,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,fs(4194308,4,_u.bind(null,t,e),n)},useLayoutEffect:function(e,t){return fs(4194308,4,e,t)},useInsertionEffect:function(e,t){return fs(4,2,e,t)},useMemo:function(e,t){var n=Ht();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Ht();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=jf.bind(null,He,e),[r.memoizedState,e]},useRef:function(e){var t=Ht();return e={current:e},t.memoizedState=e},useState:ju,useDebugValue:oi,useDeferredValue:function(e){return Ht().memoizedState=e},useTransition:function(){var e=ju(!1),t=e[0];return e=Sf.bind(null,e[1]),Ht().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=He,l=Ht();if(Fe){if(n===void 0)throw Error(u(407));n=n()}else{if(n=t(),qe===null)throw Error(u(349));(Fn&30)!==0||xu(r,t,n)}l.memoizedState=n;var s={value:n,getSnapshot:t};return l.queue=s,Eu(Nu.bind(null,r,s,e),[e]),r.flags|=2048,sl(9,wu.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=Ht(),t=qe.identifierPrefix;if(Fe){var n=en,r=Zt;n=(r&~(1<<32-Rt(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=rl++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=kf++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},bf={readContext:Et,useCallback:Ru,useContext:Et,useEffect:si,useImperativeHandle:Du,useInsertionEffect:bu,useLayoutEffect:Pu,useMemo:Ou,useReducer:ri,useRef:Cu,useState:function(){return ri(ll)},useDebugValue:oi,useDeferredValue:function(e){var t=bt();return Tu(t,Ye.memoizedState,e)},useTransition:function(){var e=ri(ll)[0],t=bt().memoizedState;return[e,t]},useMutableSource:yu,useSyncExternalStore:vu,useId:Lu,unstable_isNewReconciler:!1},Pf={readContext:Et,useCallback:Ru,useContext:Et,useEffect:si,useImperativeHandle:Du,useInsertionEffect:bu,useLayoutEffect:Pu,useMemo:Ou,useReducer:li,useRef:Cu,useState:function(){return li(ll)},useDebugValue:oi,useDeferredValue:function(e){var t=bt();return Ye===null?t.memoizedState=e:Tu(t,Ye.memoizedState,e)},useTransition:function(){var e=li(ll)[0],t=bt().memoizedState;return[e,t]},useMutableSource:yu,useSyncExternalStore:vu,useId:Lu,unstable_isNewReconciler:!1};function Lt(e,t){if(e&&e.defaultProps){t=S({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function ii(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:S({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var ms={isMounted:function(e){return(e=e._reactInternals)?Jt(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=at(),l=kn(e),s=nn(r,l);s.payload=t,n!=null&&(s.callback=n),t=vn(e,s,l),t!==null&&(Mt(t,e,l,r),is(t,e,l))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=at(),l=kn(e),s=nn(r,l);s.tag=1,s.payload=t,n!=null&&(s.callback=n),t=vn(e,s,l),t!==null&&(Mt(t,e,l,r),is(t,e,l))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=at(),r=kn(e),l=nn(n,r);l.tag=2,t!=null&&(l.callback=t),t=vn(e,l,r),t!==null&&(Mt(t,e,r,n),is(t,e,r))}};function $u(e,t,n,r,l,s,c){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,s,c):t.prototype&&t.prototype.isPureReactComponent?!Wr(n,r)||!Wr(l,s):!0}function Fu(e,t,n){var r=!1,l=mn,s=t.contextType;return typeof s=="object"&&s!==null?s=Et(s):(l=dt(t)?Ln:nt.current,r=t.contextTypes,s=(r=r!=null)?or(e,l):mn),t=new t(n,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ms,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=l,e.__reactInternalMemoizedMaskedChildContext=s),t}function Au(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ms.enqueueReplaceState(t,t.state,null)}function ai(e,t,n,r){var l=e.stateNode;l.props=n,l.state=e.memoizedState,l.refs={},Go(e);var s=t.contextType;typeof s=="object"&&s!==null?l.context=Et(s):(s=dt(t)?Ln:nt.current,l.context=or(e,s)),l.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(ii(e,t,s,n),l.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof l.getSnapshotBeforeUpdate=="function"||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(t=l.state,typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount(),t!==l.state&&ms.enqueueReplaceState(l,l.state,null),as(e,n,l,r),l.state=e.memoizedState),typeof l.componentDidMount=="function"&&(e.flags|=4194308)}function pr(e,t){try{var n="",r=t;do n+=te(r),r=r.return;while(r);var l=n}catch(s){l=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:l,digest:null}}function ui(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function ci(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var _f=typeof WeakMap=="function"?WeakMap:Map;function Uu(e,t,n){n=nn(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){ks||(ks=!0,Ci=r),ci(e,t)},n}function Bu(e,t,n){n=nn(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var l=t.value;n.payload=function(){return r(l)},n.callback=function(){ci(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){ci(e,t),typeof r!="function"&&(wn===null?wn=new Set([this]):wn.add(this));var c=t.stack;this.componentDidCatch(t.value,{componentStack:c!==null?c:""})}),n}function Hu(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new _f;var l=new Set;r.set(t,l)}else l=r.get(t),l===void 0&&(l=new Set,r.set(t,l));l.has(n)||(l.add(n),e=Hf.bind(null,e,t,n),t.then(e,e))}function Vu(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Wu(e,t,n,r,l){return(e.mode&1)===0?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=nn(-1,1),t.tag=2,vn(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=l,e)}var Df=T.ReactCurrentOwner,ft=!1;function it(e,t,n,r){t.child=e===null?du(t,null,n,r):cr(t,e.child,n,r)}function Ku(e,t,n,r,l){n=n.render;var s=t.ref;return fr(t,l),r=ti(e,t,n,r,s,l),n=ni(),e!==null&&!ft?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~l,rn(e,t,l)):(Fe&&n&&$o(t),t.flags|=1,it(e,t,r,l),t.child)}function Qu(e,t,n,r,l){if(e===null){var s=n.type;return typeof s=="function"&&!Oi(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=s,Gu(e,t,s,r,l)):(e=Ps(n.type,null,r,t,t.mode,l),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,(e.lanes&l)===0){var c=s.memoizedProps;if(n=n.compare,n=n!==null?n:Wr,n(c,r)&&e.ref===t.ref)return rn(e,t,l)}return t.flags|=1,e=jn(s,r),e.ref=t.ref,e.return=t,t.child=e}function Gu(e,t,n,r,l){if(e!==null){var s=e.memoizedProps;if(Wr(s,r)&&e.ref===t.ref)if(ft=!1,t.pendingProps=r=s,(e.lanes&l)!==0)(e.flags&131072)!==0&&(ft=!0);else return t.lanes=e.lanes,rn(e,t,l)}return di(e,t,n,r,l)}function Yu(e,t,n){var r=t.pendingProps,l=r.children,s=e!==null?e.memoizedState:null;if(r.mode==="hidden")if((t.mode&1)===0)t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Le(gr,Nt),Nt|=n;else{if((n&1073741824)===0)return e=s!==null?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Le(gr,Nt),Nt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Le(gr,Nt),Nt|=r}else s!==null?(r=s.baseLanes|n,t.memoizedState=null):r=n,Le(gr,Nt),Nt|=r;return it(e,t,l,n),t.child}function Ju(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function di(e,t,n,r,l){var s=dt(n)?Ln:nt.current;return s=or(t,s),fr(t,l),n=ti(e,t,n,r,s,l),r=ni(),e!==null&&!ft?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~l,rn(e,t,l)):(Fe&&r&&$o(t),t.flags|=1,it(e,t,n,l),t.child)}function Xu(e,t,n,r,l){if(dt(n)){var s=!0;Zl(t)}else s=!1;if(fr(t,l),t.stateNode===null)ys(e,t),Fu(t,n,r),ai(t,n,r,l),r=!0;else if(e===null){var c=t.stateNode,v=t.memoizedProps;c.props=v;var N=c.context,M=n.contextType;typeof M=="object"&&M!==null?M=Et(M):(M=dt(n)?Ln:nt.current,M=or(t,M));var G=n.getDerivedStateFromProps,X=typeof G=="function"||typeof c.getSnapshotBeforeUpdate=="function";X||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(v!==r||N!==M)&&Au(t,c,r,M),yn=!1;var K=t.memoizedState;c.state=K,as(t,r,c,l),N=t.memoizedState,v!==r||K!==N||ct.current||yn?(typeof G=="function"&&(ii(t,n,G,r),N=t.memoizedState),(v=yn||$u(t,n,v,r,K,N,M))?(X||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount()),typeof c.componentDidMount=="function"&&(t.flags|=4194308)):(typeof c.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=N),c.props=r,c.state=N,c.context=M,r=v):(typeof c.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{c=t.stateNode,hu(e,t),v=t.memoizedProps,M=t.type===t.elementType?v:Lt(t.type,v),c.props=M,X=t.pendingProps,K=c.context,N=n.contextType,typeof N=="object"&&N!==null?N=Et(N):(N=dt(n)?Ln:nt.current,N=or(t,N));var ie=n.getDerivedStateFromProps;(G=typeof ie=="function"||typeof c.getSnapshotBeforeUpdate=="function")||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(v!==X||K!==N)&&Au(t,c,r,N),yn=!1,K=t.memoizedState,c.state=K,as(t,r,c,l);var he=t.memoizedState;v!==X||K!==he||ct.current||yn?(typeof ie=="function"&&(ii(t,n,ie,r),he=t.memoizedState),(M=yn||$u(t,n,M,r,K,he,N)||!1)?(G||typeof c.UNSAFE_componentWillUpdate!="function"&&typeof c.componentWillUpdate!="function"||(typeof c.componentWillUpdate=="function"&&c.componentWillUpdate(r,he,N),typeof c.UNSAFE_componentWillUpdate=="function"&&c.UNSAFE_componentWillUpdate(r,he,N)),typeof c.componentDidUpdate=="function"&&(t.flags|=4),typeof c.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof c.componentDidUpdate!="function"||v===e.memoizedProps&&K===e.memoizedState||(t.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&K===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=he),c.props=r,c.state=he,c.context=N,r=M):(typeof c.componentDidUpdate!="function"||v===e.memoizedProps&&K===e.memoizedState||(t.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&K===e.memoizedState||(t.flags|=1024),r=!1)}return fi(e,t,n,r,s,l)}function fi(e,t,n,r,l,s){Ju(e,t);var c=(t.flags&128)!==0;if(!r&&!c)return l&&nu(t,n,!1),rn(e,t,s);r=t.stateNode,Df.current=t;var v=c&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&c?(t.child=cr(t,e.child,null,s),t.child=cr(t,null,v,s)):it(e,t,v,s),t.memoizedState=r.state,l&&nu(t,n,!0),t.child}function qu(e){var t=e.stateNode;t.pendingContext?eu(e,t.pendingContext,t.pendingContext!==t.context):t.context&&eu(e,t.context,!1),Yo(e,t.containerInfo)}function Zu(e,t,n,r,l){return ur(),Bo(l),t.flags|=256,it(e,t,n,r),t.child}var hi={dehydrated:null,treeContext:null,retryLane:0};function pi(e){return{baseLanes:e,cachePool:null,transitions:null}}function ec(e,t,n){var r=t.pendingProps,l=Be.current,s=!1,c=(t.flags&128)!==0,v;if((v=c)||(v=e!==null&&e.memoizedState===null?!1:(l&2)!==0),v?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(l|=1),Le(Be,l&1),e===null)return Uo(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((t.mode&1)===0?t.lanes=1:e.data==="$!"?t.lanes=8:t.lanes=1073741824,null):(c=r.children,e=r.fallback,s?(r=t.mode,s=t.child,c={mode:"hidden",children:c},(r&1)===0&&s!==null?(s.childLanes=0,s.pendingProps=c):s=_s(c,r,0,null),e=Vn(e,r,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=pi(n),t.memoizedState=hi,e):mi(t,c));if(l=e.memoizedState,l!==null&&(v=l.dehydrated,v!==null))return Rf(e,t,c,r,v,l,n);if(s){s=r.fallback,c=t.mode,l=e.child,v=l.sibling;var N={mode:"hidden",children:r.children};return(c&1)===0&&t.child!==l?(r=t.child,r.childLanes=0,r.pendingProps=N,t.deletions=null):(r=jn(l,N),r.subtreeFlags=l.subtreeFlags&14680064),v!==null?s=jn(v,s):(s=Vn(s,c,n,null),s.flags|=2),s.return=t,r.return=t,r.sibling=s,t.child=r,r=s,s=t.child,c=e.child.memoizedState,c=c===null?pi(n):{baseLanes:c.baseLanes|n,cachePool:null,transitions:c.transitions},s.memoizedState=c,s.childLanes=e.childLanes&~n,t.memoizedState=hi,r}return s=e.child,e=s.sibling,r=jn(s,{mode:"visible",children:r.children}),(t.mode&1)===0&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function mi(e,t){return t=_s({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function gs(e,t,n,r){return r!==null&&Bo(r),cr(t,e.child,null,n),e=mi(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Rf(e,t,n,r,l,s,c){if(n)return t.flags&256?(t.flags&=-257,r=ui(Error(u(422))),gs(e,t,c,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=r.fallback,l=t.mode,r=_s({mode:"visible",children:r.children},l,0,null),s=Vn(s,l,c,null),s.flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,(t.mode&1)!==0&&cr(t,e.child,null,c),t.child.memoizedState=pi(c),t.memoizedState=hi,s);if((t.mode&1)===0)return gs(e,t,c,null);if(l.data==="$!"){if(r=l.nextSibling&&l.nextSibling.dataset,r)var v=r.dgst;return r=v,s=Error(u(419)),r=ui(s,r,void 0),gs(e,t,c,r)}if(v=(c&e.childLanes)!==0,ft||v){if(r=qe,r!==null){switch(c&-c){case 4:l=2;break;case 16:l=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:l=32;break;case 536870912:l=268435456;break;default:l=0}l=(l&(r.suspendedLanes|c))!==0?0:l,l!==0&&l!==s.retryLane&&(s.retryLane=l,tn(e,l),Mt(r,e,l,-1))}return Ri(),r=ui(Error(u(421))),gs(e,t,c,r)}return l.data==="$?"?(t.flags|=128,t.child=e.child,t=Vf.bind(null,e),l._reactRetry=t,null):(e=s.treeContext,wt=hn(l.nextSibling),xt=t,Fe=!0,Tt=null,e!==null&&(jt[Ct++]=Zt,jt[Ct++]=en,jt[Ct++]=zn,Zt=e.id,en=e.overflow,zn=t),t=mi(t,r.children),t.flags|=4096,t)}function tc(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Ko(e.return,t,n)}function gi(e,t,n,r,l){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:l}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=l)}function nc(e,t,n){var r=t.pendingProps,l=r.revealOrder,s=r.tail;if(it(e,t,r.children,n),r=Be.current,(r&2)!==0)r=r&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&tc(e,n,t);else if(e.tag===19)tc(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Le(Be,r),(t.mode&1)===0)t.memoizedState=null;else switch(l){case"forwards":for(n=t.child,l=null;n!==null;)e=n.alternate,e!==null&&us(e)===null&&(l=n),n=n.sibling;n=l,n===null?(l=t.child,t.child=null):(l=n.sibling,n.sibling=null),gi(t,!1,l,n,s);break;case"backwards":for(n=null,l=t.child,t.child=null;l!==null;){if(e=l.alternate,e!==null&&us(e)===null){t.child=l;break}e=l.sibling,l.sibling=n,n=l,l=e}gi(t,!0,n,null,s);break;case"together":gi(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ys(e,t){(t.mode&1)===0&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function rn(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),An|=t.lanes,(n&t.childLanes)===0)return null;if(e!==null&&t.child!==e.child)throw Error(u(153));if(t.child!==null){for(e=t.child,n=jn(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=jn(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Of(e,t,n){switch(t.tag){case 3:qu(t),ur();break;case 5:gu(t);break;case 1:dt(t.type)&&Zl(t);break;case 4:Yo(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,l=t.memoizedProps.value;Le(ss,r._currentValue),r._currentValue=l;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Le(Be,Be.current&1),t.flags|=128,null):(n&t.child.childLanes)!==0?ec(e,t,n):(Le(Be,Be.current&1),e=rn(e,t,n),e!==null?e.sibling:null);Le(Be,Be.current&1);break;case 19:if(r=(n&t.childLanes)!==0,(e.flags&128)!==0){if(r)return nc(e,t,n);t.flags|=128}if(l=t.memoizedState,l!==null&&(l.rendering=null,l.tail=null,l.lastEffect=null),Le(Be,Be.current),r)break;return null;case 22:case 23:return t.lanes=0,Yu(e,t,n)}return rn(e,t,n)}var rc,yi,lc,sc;rc=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},yi=function(){},lc=function(e,t,n,r){var l=e.memoizedProps;if(l!==r){e=t.stateNode,$n(Bt.current);var s=null;switch(n){case"input":l=je(e,l),r=je(e,r),s=[];break;case"select":l=S({},l,{value:void 0}),r=S({},r,{value:void 0}),s=[];break;case"textarea":l=Ke(e,l),r=Ke(e,r),s=[];break;default:typeof l.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Jl)}jr(n,r);var c;n=null;for(M in l)if(!r.hasOwnProperty(M)&&l.hasOwnProperty(M)&&l[M]!=null)if(M==="style"){var v=l[M];for(c in v)v.hasOwnProperty(c)&&(n||(n={}),n[c]="")}else M!=="dangerouslySetInnerHTML"&&M!=="children"&&M!=="suppressContentEditableWarning"&&M!=="suppressHydrationWarning"&&M!=="autoFocus"&&(f.hasOwnProperty(M)?s||(s=[]):(s=s||[]).push(M,null));for(M in r){var N=r[M];if(v=l?.[M],r.hasOwnProperty(M)&&N!==v&&(N!=null||v!=null))if(M==="style")if(v){for(c in v)!v.hasOwnProperty(c)||N&&N.hasOwnProperty(c)||(n||(n={}),n[c]="");for(c in N)N.hasOwnProperty(c)&&v[c]!==N[c]&&(n||(n={}),n[c]=N[c])}else n||(s||(s=[]),s.push(M,n)),n=N;else M==="dangerouslySetInnerHTML"?(N=N?N.__html:void 0,v=v?v.__html:void 0,N!=null&&v!==N&&(s=s||[]).push(M,N)):M==="children"?typeof N!="string"&&typeof N!="number"||(s=s||[]).push(M,""+N):M!=="suppressContentEditableWarning"&&M!=="suppressHydrationWarning"&&(f.hasOwnProperty(M)?(N!=null&&M==="onScroll"&&Ie("scroll",e),s||v===N||(s=[])):(s=s||[]).push(M,N))}n&&(s=s||[]).push("style",n);var M=s;(t.updateQueue=M)&&(t.flags|=4)}},sc=function(e,t,n,r){n!==r&&(t.flags|=4)};function ol(e,t){if(!Fe)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function lt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var l=e.child;l!==null;)n|=l.lanes|l.childLanes,r|=l.subtreeFlags&14680064,r|=l.flags&14680064,l.return=e,l=l.sibling;else for(l=e.child;l!==null;)n|=l.lanes|l.childLanes,r|=l.subtreeFlags,r|=l.flags,l.return=e,l=l.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Tf(e,t,n){var r=t.pendingProps;switch(Fo(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return lt(t),null;case 1:return dt(t.type)&&ql(),lt(t),null;case 3:return r=t.stateNode,hr(),Me(ct),Me(nt),qo(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(rs(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Tt!==null&&(Pi(Tt),Tt=null))),yi(e,t),lt(t),null;case 5:Jo(t);var l=$n(tl.current);if(n=t.type,e!==null&&t.stateNode!=null)lc(e,t,n,r,l),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(u(166));return lt(t),null}if(e=$n(Bt.current),rs(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[Ut]=t,r[Jr]=s,e=(t.mode&1)!==0,n){case"dialog":Ie("cancel",r),Ie("close",r);break;case"iframe":case"object":case"embed":Ie("load",r);break;case"video":case"audio":for(l=0;l<Qr.length;l++)Ie(Qr[l],r);break;case"source":Ie("error",r);break;case"img":case"image":case"link":Ie("error",r),Ie("load",r);break;case"details":Ie("toggle",r);break;case"input":Pe(r,s),Ie("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Ie("invalid",r);break;case"textarea":Ae(r,s),Ie("invalid",r)}jr(n,s),l=null;for(var c in s)if(s.hasOwnProperty(c)){var v=s[c];c==="children"?typeof v=="string"?r.textContent!==v&&(s.suppressHydrationWarning!==!0&&Yl(r.textContent,v,e),l=["children",v]):typeof v=="number"&&r.textContent!==""+v&&(s.suppressHydrationWarning!==!0&&Yl(r.textContent,v,e),l=["children",""+v]):f.hasOwnProperty(c)&&v!=null&&c==="onScroll"&&Ie("scroll",r)}switch(n){case"input":ve(r),_e(r,s,!0);break;case"textarea":ve(r),yl(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Jl)}r=l,t.updateQueue=r,r!==null&&(t.flags|=4)}else{c=l.nodeType===9?l:l.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=kr(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=c.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=c.createElement(n,{is:r.is}):(e=c.createElement(n),n==="select"&&(c=e,r.multiple?c.multiple=!0:r.size&&(c.size=r.size))):e=c.createElementNS(e,n),e[Ut]=t,e[Jr]=r,rc(e,t,!1,!1),t.stateNode=e;e:{switch(c=Cr(n,r),n){case"dialog":Ie("cancel",e),Ie("close",e),l=r;break;case"iframe":case"object":case"embed":Ie("load",e),l=r;break;case"video":case"audio":for(l=0;l<Qr.length;l++)Ie(Qr[l],e);l=r;break;case"source":Ie("error",e),l=r;break;case"img":case"image":case"link":Ie("error",e),Ie("load",e),l=r;break;case"details":Ie("toggle",e),l=r;break;case"input":Pe(e,r),l=je(e,r),Ie("invalid",e);break;case"option":l=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},l=S({},r,{value:void 0}),Ie("invalid",e);break;case"textarea":Ae(e,r),l=Ke(e,r),Ie("invalid",e);break;default:l=r}jr(n,l),v=l;for(s in v)if(v.hasOwnProperty(s)){var N=v[s];s==="style"?wl(e,N):s==="dangerouslySetInnerHTML"?(N=N?N.__html:void 0,N!=null&&vl(e,N)):s==="children"?typeof N=="string"?(n!=="textarea"||N!=="")&&_n(e,N):typeof N=="number"&&_n(e,""+N):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(f.hasOwnProperty(s)?N!=null&&s==="onScroll"&&Ie("scroll",e):N!=null&&re(e,s,N,c))}switch(n){case"input":ve(e),_e(e,r,!1);break;case"textarea":ve(e),yl(e);break;case"option":r.value!=null&&e.setAttribute("value",""+ye(r.value));break;case"select":e.multiple=!!r.multiple,s=r.value,s!=null?ot(e,!!r.multiple,s,!1):r.defaultValue!=null&&ot(e,!!r.multiple,r.defaultValue,!0);break;default:typeof l.onClick=="function"&&(e.onclick=Jl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return lt(t),null;case 6:if(e&&t.stateNode!=null)sc(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(u(166));if(n=$n(tl.current),$n(Bt.current),rs(t)){if(r=t.stateNode,n=t.memoizedProps,r[Ut]=t,(s=r.nodeValue!==n)&&(e=xt,e!==null))switch(e.tag){case 3:Yl(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Yl(r.nodeValue,n,(e.mode&1)!==0)}s&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ut]=t,t.stateNode=r}return lt(t),null;case 13:if(Me(Be),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Fe&&wt!==null&&(t.mode&1)!==0&&(t.flags&128)===0)au(),ur(),t.flags|=98560,s=!1;else if(s=rs(t),r!==null&&r.dehydrated!==null){if(e===null){if(!s)throw Error(u(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(u(317));s[Ut]=t}else ur(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;lt(t),s=!1}else Tt!==null&&(Pi(Tt),Tt=null),s=!0;if(!s)return t.flags&65536?t:null}return(t.flags&128)!==0?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,(t.mode&1)!==0&&(e===null||(Be.current&1)!==0?Je===0&&(Je=3):Ri())),t.updateQueue!==null&&(t.flags|=4),lt(t),null);case 4:return hr(),yi(e,t),e===null&&Gr(t.stateNode.containerInfo),lt(t),null;case 10:return Wo(t.type._context),lt(t),null;case 17:return dt(t.type)&&ql(),lt(t),null;case 19:if(Me(Be),s=t.memoizedState,s===null)return lt(t),null;if(r=(t.flags&128)!==0,c=s.rendering,c===null)if(r)ol(s,!1);else{if(Je!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(c=us(e),c!==null){for(t.flags|=128,ol(s,!1),r=c.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)s=n,e=r,s.flags&=14680066,c=s.alternate,c===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=c.childLanes,s.lanes=c.lanes,s.child=c.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=c.memoizedProps,s.memoizedState=c.memoizedState,s.updateQueue=c.updateQueue,s.type=c.type,e=c.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Le(Be,Be.current&1|2),t.child}e=e.sibling}s.tail!==null&&$e()>yr&&(t.flags|=128,r=!0,ol(s,!1),t.lanes=4194304)}else{if(!r)if(e=us(c),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),ol(s,!0),s.tail===null&&s.tailMode==="hidden"&&!c.alternate&&!Fe)return lt(t),null}else 2*$e()-s.renderingStartTime>yr&&n!==1073741824&&(t.flags|=128,r=!0,ol(s,!1),t.lanes=4194304);s.isBackwards?(c.sibling=t.child,t.child=c):(n=s.last,n!==null?n.sibling=c:t.child=c,s.last=c)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=$e(),t.sibling=null,n=Be.current,Le(Be,r?n&1|2:n&1),t):(lt(t),null);case 22:case 23:return Di(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&(t.mode&1)!==0?(Nt&1073741824)!==0&&(lt(t),t.subtreeFlags&6&&(t.flags|=8192)):lt(t),null;case 24:return null;case 25:return null}throw Error(u(156,t.tag))}function Lf(e,t){switch(Fo(t),t.tag){case 1:return dt(t.type)&&ql(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return hr(),Me(ct),Me(nt),qo(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 5:return Jo(t),null;case 13:if(Me(Be),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(u(340));ur()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Me(Be),null;case 4:return hr(),null;case 10:return Wo(t.type._context),null;case 22:case 23:return Di(),null;case 24:return null;default:return null}}var vs=!1,st=!1,zf=typeof WeakSet=="function"?WeakSet:Set,fe=null;function mr(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ve(e,t,r)}else n.current=null}function vi(e,t,n){try{n()}catch(r){Ve(e,t,r)}}var oc=!1;function If(e,t){if(Do=$l,e=$a(),ko(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var l=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var c=0,v=-1,N=-1,M=0,G=0,X=e,K=null;t:for(;;){for(var ie;X!==n||l!==0&&X.nodeType!==3||(v=c+l),X!==s||r!==0&&X.nodeType!==3||(N=c+r),X.nodeType===3&&(c+=X.nodeValue.length),(ie=X.firstChild)!==null;)K=X,X=ie;for(;;){if(X===e)break t;if(K===n&&++M===l&&(v=c),K===s&&++G===r&&(N=c),(ie=X.nextSibling)!==null)break;X=K,K=X.parentNode}X=ie}n=v===-1||N===-1?null:{start:v,end:N}}else n=null}n=n||{start:0,end:0}}else n=null;for(Ro={focusedElem:e,selectionRange:n},$l=!1,fe=t;fe!==null;)if(t=fe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,fe=e;else for(;fe!==null;){t=fe;try{var he=t.alternate;if((t.flags&1024)!==0)switch(t.tag){case 0:case 11:case 15:break;case 1:if(he!==null){var pe=he.memoizedProps,We=he.memoizedState,_=t.stateNode,j=_.getSnapshotBeforeUpdate(t.elementType===t.type?pe:Lt(t.type,pe),We);_.__reactInternalSnapshotBeforeUpdate=j}break;case 3:var R=t.stateNode.containerInfo;R.nodeType===1?R.textContent="":R.nodeType===9&&R.documentElement&&R.removeChild(R.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(u(163))}}catch(ee){Ve(t,t.return,ee)}if(e=t.sibling,e!==null){e.return=t.return,fe=e;break}fe=t.return}return he=oc,oc=!1,he}function il(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var l=r=r.next;do{if((l.tag&e)===e){var s=l.destroy;l.destroy=void 0,s!==void 0&&vi(t,n,s)}l=l.next}while(l!==r)}}function xs(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function xi(e){var t=e.ref;if(t!==null){var n=e.stateNode;e.tag,e=n,typeof t=="function"?t(e):t.current=e}}function ic(e){var t=e.alternate;t!==null&&(e.alternate=null,ic(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ut],delete t[Jr],delete t[zo],delete t[vf],delete t[xf])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ac(e){return e.tag===5||e.tag===3||e.tag===4}function uc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||ac(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function wi(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Jl));else if(r!==4&&(e=e.child,e!==null))for(wi(e,t,n),e=e.sibling;e!==null;)wi(e,t,n),e=e.sibling}function Ni(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Ni(e,t,n),e=e.sibling;e!==null;)Ni(e,t,n),e=e.sibling}var et=null,zt=!1;function xn(e,t,n){for(n=n.child;n!==null;)cc(e,t,n),n=n.sibling}function cc(e,t,n){if(At&&typeof At.onCommitFiberUnmount=="function")try{At.onCommitFiberUnmount(Ol,n)}catch{}switch(n.tag){case 5:st||mr(n,t);case 6:var r=et,l=zt;et=null,xn(e,t,n),et=r,zt=l,et!==null&&(zt?(e=et,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):et.removeChild(n.stateNode));break;case 18:et!==null&&(zt?(e=et,n=n.stateNode,e.nodeType===8?Lo(e.parentNode,n):e.nodeType===1&&Lo(e,n),Fr(e)):Lo(et,n.stateNode));break;case 4:r=et,l=zt,et=n.stateNode.containerInfo,zt=!0,xn(e,t,n),et=r,zt=l;break;case 0:case 11:case 14:case 15:if(!st&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){l=r=r.next;do{var s=l,c=s.destroy;s=s.tag,c!==void 0&&((s&2)!==0||(s&4)!==0)&&vi(n,t,c),l=l.next}while(l!==r)}xn(e,t,n);break;case 1:if(!st&&(mr(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(v){Ve(n,t,v)}xn(e,t,n);break;case 21:xn(e,t,n);break;case 22:n.mode&1?(st=(r=st)||n.memoizedState!==null,xn(e,t,n),st=r):xn(e,t,n);break;default:xn(e,t,n)}}function dc(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new zf),t.forEach(function(r){var l=Wf.bind(null,e,r);n.has(r)||(n.add(r),r.then(l,l))})}}function It(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var l=n[r];try{var s=e,c=t,v=c;e:for(;v!==null;){switch(v.tag){case 5:et=v.stateNode,zt=!1;break e;case 3:et=v.stateNode.containerInfo,zt=!0;break e;case 4:et=v.stateNode.containerInfo,zt=!0;break e}v=v.return}if(et===null)throw Error(u(160));cc(s,c,l),et=null,zt=!1;var N=l.alternate;N!==null&&(N.return=null),l.return=null}catch(M){Ve(l,t,M)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)fc(t,e),t=t.sibling}function fc(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(It(t,e),Vt(e),r&4){try{il(3,e,e.return),xs(3,e)}catch(pe){Ve(e,e.return,pe)}try{il(5,e,e.return)}catch(pe){Ve(e,e.return,pe)}}break;case 1:It(t,e),Vt(e),r&512&&n!==null&&mr(n,n.return);break;case 5:if(It(t,e),Vt(e),r&512&&n!==null&&mr(n,n.return),e.flags&32){var l=e.stateNode;try{_n(l,"")}catch(pe){Ve(e,e.return,pe)}}if(r&4&&(l=e.stateNode,l!=null)){var s=e.memoizedProps,c=n!==null?n.memoizedProps:s,v=e.type,N=e.updateQueue;if(e.updateQueue=null,N!==null)try{v==="input"&&s.type==="radio"&&s.name!=null&&xe(l,s),Cr(v,c);var M=Cr(v,s);for(c=0;c<N.length;c+=2){var G=N[c],X=N[c+1];G==="style"?wl(l,X):G==="dangerouslySetInnerHTML"?vl(l,X):G==="children"?_n(l,X):re(l,G,X,M)}switch(v){case"input":be(l,s);break;case"textarea":gl(l,s);break;case"select":var K=l._wrapperState.wasMultiple;l._wrapperState.wasMultiple=!!s.multiple;var ie=s.value;ie!=null?ot(l,!!s.multiple,ie,!1):K!==!!s.multiple&&(s.defaultValue!=null?ot(l,!!s.multiple,s.defaultValue,!0):ot(l,!!s.multiple,s.multiple?[]:"",!1))}l[Jr]=s}catch(pe){Ve(e,e.return,pe)}}break;case 6:if(It(t,e),Vt(e),r&4){if(e.stateNode===null)throw Error(u(162));l=e.stateNode,s=e.memoizedProps;try{l.nodeValue=s}catch(pe){Ve(e,e.return,pe)}}break;case 3:if(It(t,e),Vt(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Fr(t.containerInfo)}catch(pe){Ve(e,e.return,pe)}break;case 4:It(t,e),Vt(e);break;case 13:It(t,e),Vt(e),l=e.child,l.flags&8192&&(s=l.memoizedState!==null,l.stateNode.isHidden=s,!s||l.alternate!==null&&l.alternate.memoizedState!==null||(ji=$e())),r&4&&dc(e);break;case 22:if(G=n!==null&&n.memoizedState!==null,e.mode&1?(st=(M=st)||G,It(t,e),st=M):It(t,e),Vt(e),r&8192){if(M=e.memoizedState!==null,(e.stateNode.isHidden=M)&&!G&&(e.mode&1)!==0)for(fe=e,G=e.child;G!==null;){for(X=fe=G;fe!==null;){switch(K=fe,ie=K.child,K.tag){case 0:case 11:case 14:case 15:il(4,K,K.return);break;case 1:mr(K,K.return);var he=K.stateNode;if(typeof he.componentWillUnmount=="function"){r=K,n=K.return;try{t=r,he.props=t.memoizedProps,he.state=t.memoizedState,he.componentWillUnmount()}catch(pe){Ve(r,n,pe)}}break;case 5:mr(K,K.return);break;case 22:if(K.memoizedState!==null){mc(X);continue}}ie!==null?(ie.return=K,fe=ie):mc(X)}G=G.sibling}e:for(G=null,X=e;;){if(X.tag===5){if(G===null){G=X;try{l=X.stateNode,M?(s=l.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(v=X.stateNode,N=X.memoizedProps.style,c=N!=null&&N.hasOwnProperty("display")?N.display:null,v.style.display=xl("display",c))}catch(pe){Ve(e,e.return,pe)}}}else if(X.tag===6){if(G===null)try{X.stateNode.nodeValue=M?"":X.memoizedProps}catch(pe){Ve(e,e.return,pe)}}else if((X.tag!==22&&X.tag!==23||X.memoizedState===null||X===e)&&X.child!==null){X.child.return=X,X=X.child;continue}if(X===e)break e;for(;X.sibling===null;){if(X.return===null||X.return===e)break e;G===X&&(G=null),X=X.return}G===X&&(G=null),X.sibling.return=X.return,X=X.sibling}}break;case 19:It(t,e),Vt(e),r&4&&dc(e);break;case 21:break;default:It(t,e),Vt(e)}}function Vt(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(ac(n)){var r=n;break e}n=n.return}throw Error(u(160))}switch(r.tag){case 5:var l=r.stateNode;r.flags&32&&(_n(l,""),r.flags&=-33);var s=uc(e);Ni(e,s,l);break;case 3:case 4:var c=r.stateNode.containerInfo,v=uc(e);wi(e,v,c);break;default:throw Error(u(161))}}catch(N){Ve(e,e.return,N)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Mf(e,t,n){fe=e,hc(e)}function hc(e,t,n){for(var r=(e.mode&1)!==0;fe!==null;){var l=fe,s=l.child;if(l.tag===22&&r){var c=l.memoizedState!==null||vs;if(!c){var v=l.alternate,N=v!==null&&v.memoizedState!==null||st;v=vs;var M=st;if(vs=c,(st=N)&&!M)for(fe=l;fe!==null;)c=fe,N=c.child,c.tag===22&&c.memoizedState!==null?gc(l):N!==null?(N.return=c,fe=N):gc(l);for(;s!==null;)fe=s,hc(s),s=s.sibling;fe=l,vs=v,st=M}pc(e)}else(l.subtreeFlags&8772)!==0&&s!==null?(s.return=l,fe=s):pc(e)}}function pc(e){for(;fe!==null;){var t=fe;if((t.flags&8772)!==0){var n=t.alternate;try{if((t.flags&8772)!==0)switch(t.tag){case 0:case 11:case 15:st||xs(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!st)if(n===null)r.componentDidMount();else{var l=t.elementType===t.type?n.memoizedProps:Lt(t.type,n.memoizedProps);r.componentDidUpdate(l,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&mu(t,s,r);break;case 3:var c=t.updateQueue;if(c!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}mu(t,c,n)}break;case 5:var v=t.stateNode;if(n===null&&t.flags&4){n=v;var N=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":N.autoFocus&&n.focus();break;case"img":N.src&&(n.src=N.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var M=t.alternate;if(M!==null){var G=M.memoizedState;if(G!==null){var X=G.dehydrated;X!==null&&Fr(X)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(u(163))}st||t.flags&512&&xi(t)}catch(K){Ve(t,t.return,K)}}if(t===e){fe=null;break}if(n=t.sibling,n!==null){n.return=t.return,fe=n;break}fe=t.return}}function mc(e){for(;fe!==null;){var t=fe;if(t===e){fe=null;break}var n=t.sibling;if(n!==null){n.return=t.return,fe=n;break}fe=t.return}}function gc(e){for(;fe!==null;){var t=fe;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{xs(4,t)}catch(N){Ve(t,n,N)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var l=t.return;try{r.componentDidMount()}catch(N){Ve(t,l,N)}}var s=t.return;try{xi(t)}catch(N){Ve(t,s,N)}break;case 5:var c=t.return;try{xi(t)}catch(N){Ve(t,c,N)}}}catch(N){Ve(t,t.return,N)}if(t===e){fe=null;break}var v=t.sibling;if(v!==null){v.return=t.return,fe=v;break}fe=t.return}}var $f=Math.ceil,ws=T.ReactCurrentDispatcher,ki=T.ReactCurrentOwner,Pt=T.ReactCurrentBatchConfig,De=0,qe=null,Qe=null,tt=0,Nt=0,gr=pn(0),Je=0,al=null,An=0,Ns=0,Si=0,ul=null,ht=null,ji=0,yr=1/0,ln=null,ks=!1,Ci=null,wn=null,Ss=!1,Nn=null,js=0,cl=0,Ei=null,Cs=-1,Es=0;function at(){return(De&6)!==0?$e():Cs!==-1?Cs:Cs=$e()}function kn(e){return(e.mode&1)===0?1:(De&2)!==0&&tt!==0?tt&-tt:Nf.transition!==null?(Es===0&&(Es=ua()),Es):(e=Te,e!==0||(e=window.event,e=e===void 0?16:va(e.type)),e)}function Mt(e,t,n,r){if(50<cl)throw cl=0,Ei=null,Error(u(185));Lr(e,n,r),((De&2)===0||e!==qe)&&(e===qe&&((De&2)===0&&(Ns|=n),Je===4&&Sn(e,tt)),pt(e,r),n===1&&De===0&&(t.mode&1)===0&&(yr=$e()+500,es&&gn()))}function pt(e,t){var n=e.callbackNode;wd(e,t);var r=zl(e,e===qe?tt:0);if(r===0)n!==null&&Dl(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Dl(n),t===1)e.tag===0?wf(vc.bind(null,e)):ru(vc.bind(null,e)),gf(function(){(De&6)===0&&gn()}),n=null;else{switch(ca(r)){case 1:n=we;break;case 4:n=Oe;break;case 16:n=Ue;break;case 536870912:n=Rl;break;default:n=Ue}n=Ec(n,yc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function yc(e,t){if(Cs=-1,Es=0,(De&6)!==0)throw Error(u(327));var n=e.callbackNode;if(vr()&&e.callbackNode!==n)return null;var r=zl(e,e===qe?tt:0);if(r===0)return null;if((r&30)!==0||(r&e.expiredLanes)!==0||t)t=bs(e,r);else{t=r;var l=De;De|=2;var s=wc();(qe!==e||tt!==t)&&(ln=null,yr=$e()+500,Bn(e,t));do try{Uf();break}catch(v){xc(e,v)}while(!0);Vo(),ws.current=s,De=l,Qe!==null?t=0:(qe=null,tt=0,t=Je)}if(t!==0){if(t===2&&(l=so(e),l!==0&&(r=l,t=bi(e,l))),t===1)throw n=al,Bn(e,0),Sn(e,r),pt(e,$e()),n;if(t===6)Sn(e,r);else{if(l=e.current.alternate,(r&30)===0&&!Ff(l)&&(t=bs(e,r),t===2&&(s=so(e),s!==0&&(r=s,t=bi(e,s))),t===1))throw n=al,Bn(e,0),Sn(e,r),pt(e,$e()),n;switch(e.finishedWork=l,e.finishedLanes=r,t){case 0:case 1:throw Error(u(345));case 2:Hn(e,ht,ln);break;case 3:if(Sn(e,r),(r&130023424)===r&&(t=ji+500-$e(),10<t)){if(zl(e,0)!==0)break;if(l=e.suspendedLanes,(l&r)!==r){at(),e.pingedLanes|=e.suspendedLanes&l;break}e.timeoutHandle=To(Hn.bind(null,e,ht,ln),t);break}Hn(e,ht,ln);break;case 4:if(Sn(e,r),(r&4194240)===r)break;for(t=e.eventTimes,l=-1;0<r;){var c=31-Rt(r);s=1<<c,c=t[c],c>l&&(l=c),r&=~s}if(r=l,r=$e()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*$f(r/1960))-r,10<r){e.timeoutHandle=To(Hn.bind(null,e,ht,ln),r);break}Hn(e,ht,ln);break;case 5:Hn(e,ht,ln);break;default:throw Error(u(329))}}}return pt(e,$e()),e.callbackNode===n?yc.bind(null,e):null}function bi(e,t){var n=ul;return e.current.memoizedState.isDehydrated&&(Bn(e,t).flags|=256),e=bs(e,t),e!==2&&(t=ht,ht=n,t!==null&&Pi(t)),e}function Pi(e){ht===null?ht=e:ht.push.apply(ht,e)}function Ff(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var l=n[r],s=l.getSnapshot;l=l.value;try{if(!Ot(s(),l))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Sn(e,t){for(t&=~Si,t&=~Ns,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Rt(t),r=1<<n;e[n]=-1,t&=~r}}function vc(e){if((De&6)!==0)throw Error(u(327));vr();var t=zl(e,0);if((t&1)===0)return pt(e,$e()),null;var n=bs(e,t);if(e.tag!==0&&n===2){var r=so(e);r!==0&&(t=r,n=bi(e,r))}if(n===1)throw n=al,Bn(e,0),Sn(e,t),pt(e,$e()),n;if(n===6)throw Error(u(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Hn(e,ht,ln),pt(e,$e()),null}function _i(e,t){var n=De;De|=1;try{return e(t)}finally{De=n,De===0&&(yr=$e()+500,es&&gn())}}function Un(e){Nn!==null&&Nn.tag===0&&(De&6)===0&&vr();var t=De;De|=1;var n=Pt.transition,r=Te;try{if(Pt.transition=null,Te=1,e)return e()}finally{Te=r,Pt.transition=n,De=t,(De&6)===0&&gn()}}function Di(){Nt=gr.current,Me(gr)}function Bn(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,mf(n)),Qe!==null)for(n=Qe.return;n!==null;){var r=n;switch(Fo(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ql();break;case 3:hr(),Me(ct),Me(nt),qo();break;case 5:Jo(r);break;case 4:hr();break;case 13:Me(Be);break;case 19:Me(Be);break;case 10:Wo(r.type._context);break;case 22:case 23:Di()}n=n.return}if(qe=e,Qe=e=jn(e.current,null),tt=Nt=t,Je=0,al=null,Si=Ns=An=0,ht=ul=null,Mn!==null){for(t=0;t<Mn.length;t++)if(n=Mn[t],r=n.interleaved,r!==null){n.interleaved=null;var l=r.next,s=n.pending;if(s!==null){var c=s.next;s.next=l,r.next=c}n.pending=r}Mn=null}return e}function xc(e,t){do{var n=Qe;try{if(Vo(),cs.current=ps,ds){for(var r=He.memoizedState;r!==null;){var l=r.queue;l!==null&&(l.pending=null),r=r.next}ds=!1}if(Fn=0,Xe=Ye=He=null,nl=!1,rl=0,ki.current=null,n===null||n.return===null){Je=1,al=t,Qe=null;break}e:{var s=e,c=n.return,v=n,N=t;if(t=tt,v.flags|=32768,N!==null&&typeof N=="object"&&typeof N.then=="function"){var M=N,G=v,X=G.tag;if((G.mode&1)===0&&(X===0||X===11||X===15)){var K=G.alternate;K?(G.updateQueue=K.updateQueue,G.memoizedState=K.memoizedState,G.lanes=K.lanes):(G.updateQueue=null,G.memoizedState=null)}var ie=Vu(c);if(ie!==null){ie.flags&=-257,Wu(ie,c,v,s,t),ie.mode&1&&Hu(s,M,t),t=ie,N=M;var he=t.updateQueue;if(he===null){var pe=new Set;pe.add(N),t.updateQueue=pe}else he.add(N);break e}else{if((t&1)===0){Hu(s,M,t),Ri();break e}N=Error(u(426))}}else if(Fe&&v.mode&1){var We=Vu(c);if(We!==null){(We.flags&65536)===0&&(We.flags|=256),Wu(We,c,v,s,t),Bo(pr(N,v));break e}}s=N=pr(N,v),Je!==4&&(Je=2),ul===null?ul=[s]:ul.push(s),s=c;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var _=Uu(s,N,t);pu(s,_);break e;case 1:v=N;var j=s.type,R=s.stateNode;if((s.flags&128)===0&&(typeof j.getDerivedStateFromError=="function"||R!==null&&typeof R.componentDidCatch=="function"&&(wn===null||!wn.has(R)))){s.flags|=65536,t&=-t,s.lanes|=t;var ee=Bu(s,v,t);pu(s,ee);break e}}s=s.return}while(s!==null)}kc(n)}catch(ge){t=ge,Qe===n&&n!==null&&(Qe=n=n.return);continue}break}while(!0)}function wc(){var e=ws.current;return ws.current=ps,e===null?ps:e}function Ri(){(Je===0||Je===3||Je===2)&&(Je=4),qe===null||(An&268435455)===0&&(Ns&268435455)===0||Sn(qe,tt)}function bs(e,t){var n=De;De|=2;var r=wc();(qe!==e||tt!==t)&&(ln=null,Bn(e,t));do try{Af();break}catch(l){xc(e,l)}while(!0);if(Vo(),De=n,ws.current=r,Qe!==null)throw Error(u(261));return qe=null,tt=0,Je}function Af(){for(;Qe!==null;)Nc(Qe)}function Uf(){for(;Qe!==null&&!Or();)Nc(Qe)}function Nc(e){var t=Cc(e.alternate,e,Nt);e.memoizedProps=e.pendingProps,t===null?kc(e):Qe=t,ki.current=null}function kc(e){var t=e;do{var n=t.alternate;if(e=t.return,(t.flags&32768)===0){if(n=Tf(n,t,Nt),n!==null){Qe=n;return}}else{if(n=Lf(n,t),n!==null){n.flags&=32767,Qe=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Je=6,Qe=null;return}}if(t=t.sibling,t!==null){Qe=t;return}Qe=t=e}while(t!==null);Je===0&&(Je=5)}function Hn(e,t,n){var r=Te,l=Pt.transition;try{Pt.transition=null,Te=1,Bf(e,t,n,r)}finally{Pt.transition=l,Te=r}return null}function Bf(e,t,n,r){do vr();while(Nn!==null);if((De&6)!==0)throw Error(u(327));n=e.finishedWork;var l=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(u(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(Nd(e,s),e===qe&&(Qe=qe=null,tt=0),(n.subtreeFlags&2064)===0&&(n.flags&2064)===0||Ss||(Ss=!0,Ec(Ue,function(){return vr(),null})),s=(n.flags&15990)!==0,(n.subtreeFlags&15990)!==0||s){s=Pt.transition,Pt.transition=null;var c=Te;Te=1;var v=De;De|=4,ki.current=null,If(e,n),fc(n,e),af(Ro),$l=!!Do,Ro=Do=null,e.current=n,Mf(n),ro(),De=v,Te=c,Pt.transition=s}else e.current=n;if(Ss&&(Ss=!1,Nn=e,js=l),s=e.pendingLanes,s===0&&(wn=null),md(n.stateNode),pt(e,$e()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)l=t[n],r(l.value,{componentStack:l.stack,digest:l.digest});if(ks)throw ks=!1,e=Ci,Ci=null,e;return(js&1)!==0&&e.tag!==0&&vr(),s=e.pendingLanes,(s&1)!==0?e===Ei?cl++:(cl=0,Ei=e):cl=0,gn(),null}function vr(){if(Nn!==null){var e=ca(js),t=Pt.transition,n=Te;try{if(Pt.transition=null,Te=16>e?16:e,Nn===null)var r=!1;else{if(e=Nn,Nn=null,js=0,(De&6)!==0)throw Error(u(331));var l=De;for(De|=4,fe=e.current;fe!==null;){var s=fe,c=s.child;if((fe.flags&16)!==0){var v=s.deletions;if(v!==null){for(var N=0;N<v.length;N++){var M=v[N];for(fe=M;fe!==null;){var G=fe;switch(G.tag){case 0:case 11:case 15:il(8,G,s)}var X=G.child;if(X!==null)X.return=G,fe=X;else for(;fe!==null;){G=fe;var K=G.sibling,ie=G.return;if(ic(G),G===M){fe=null;break}if(K!==null){K.return=ie,fe=K;break}fe=ie}}}var he=s.alternate;if(he!==null){var pe=he.child;if(pe!==null){he.child=null;do{var We=pe.sibling;pe.sibling=null,pe=We}while(pe!==null)}}fe=s}}if((s.subtreeFlags&2064)!==0&&c!==null)c.return=s,fe=c;else e:for(;fe!==null;){if(s=fe,(s.flags&2048)!==0)switch(s.tag){case 0:case 11:case 15:il(9,s,s.return)}var _=s.sibling;if(_!==null){_.return=s.return,fe=_;break e}fe=s.return}}var j=e.current;for(fe=j;fe!==null;){c=fe;var R=c.child;if((c.subtreeFlags&2064)!==0&&R!==null)R.return=c,fe=R;else e:for(c=j;fe!==null;){if(v=fe,(v.flags&2048)!==0)try{switch(v.tag){case 0:case 11:case 15:xs(9,v)}}catch(ge){Ve(v,v.return,ge)}if(v===c){fe=null;break e}var ee=v.sibling;if(ee!==null){ee.return=v.return,fe=ee;break e}fe=v.return}}if(De=l,gn(),At&&typeof At.onPostCommitFiberRoot=="function")try{At.onPostCommitFiberRoot(Ol,e)}catch{}r=!0}return r}finally{Te=n,Pt.transition=t}}return!1}function Sc(e,t,n){t=pr(n,t),t=Uu(e,t,1),e=vn(e,t,1),t=at(),e!==null&&(Lr(e,1,t),pt(e,t))}function Ve(e,t,n){if(e.tag===3)Sc(e,e,n);else for(;t!==null;){if(t.tag===3){Sc(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(wn===null||!wn.has(r))){e=pr(n,e),e=Bu(t,e,1),t=vn(t,e,1),e=at(),t!==null&&(Lr(t,1,e),pt(t,e));break}}t=t.return}}function Hf(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=at(),e.pingedLanes|=e.suspendedLanes&n,qe===e&&(tt&n)===n&&(Je===4||Je===3&&(tt&130023424)===tt&&500>$e()-ji?Bn(e,0):Si|=n),pt(e,t)}function jc(e,t){t===0&&((e.mode&1)===0?t=1:(t=Ll,Ll<<=1,(Ll&130023424)===0&&(Ll=4194304)));var n=at();e=tn(e,t),e!==null&&(Lr(e,t,n),pt(e,n))}function Vf(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),jc(e,n)}function Wf(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,l=e.memoizedState;l!==null&&(n=l.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(u(314))}r!==null&&r.delete(t),jc(e,n)}var Cc;Cc=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||ct.current)ft=!0;else{if((e.lanes&n)===0&&(t.flags&128)===0)return ft=!1,Of(e,t,n);ft=(e.flags&131072)!==0}else ft=!1,Fe&&(t.flags&1048576)!==0&&lu(t,ns,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;ys(e,t),e=t.pendingProps;var l=or(t,nt.current);fr(t,n),l=ti(null,t,r,e,l,n);var s=ni();return t.flags|=1,typeof l=="object"&&l!==null&&typeof l.render=="function"&&l.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,dt(r)?(s=!0,Zl(t)):s=!1,t.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,Go(t),l.updater=ms,t.stateNode=l,l._reactInternals=t,ai(t,r,e,n),t=fi(null,t,r,!0,s,n)):(t.tag=0,Fe&&s&&$o(t),it(null,t,l,n),t=t.child),t;case 16:r=t.elementType;e:{switch(ys(e,t),e=t.pendingProps,l=r._init,r=l(r._payload),t.type=r,l=t.tag=Qf(r),e=Lt(r,e),l){case 0:t=di(null,t,r,e,n);break e;case 1:t=Xu(null,t,r,e,n);break e;case 11:t=Ku(null,t,r,e,n);break e;case 14:t=Qu(null,t,r,Lt(r.type,e),n);break e}throw Error(u(306,r,""))}return t;case 0:return r=t.type,l=t.pendingProps,l=t.elementType===r?l:Lt(r,l),di(e,t,r,l,n);case 1:return r=t.type,l=t.pendingProps,l=t.elementType===r?l:Lt(r,l),Xu(e,t,r,l,n);case 3:e:{if(qu(t),e===null)throw Error(u(387));r=t.pendingProps,s=t.memoizedState,l=s.element,hu(e,t),as(t,r,null,n);var c=t.memoizedState;if(r=c.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:c.cache,pendingSuspenseBoundaries:c.pendingSuspenseBoundaries,transitions:c.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){l=pr(Error(u(423)),t),t=Zu(e,t,r,n,l);break e}else if(r!==l){l=pr(Error(u(424)),t),t=Zu(e,t,r,n,l);break e}else for(wt=hn(t.stateNode.containerInfo.firstChild),xt=t,Fe=!0,Tt=null,n=du(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ur(),r===l){t=rn(e,t,n);break e}it(e,t,r,n)}t=t.child}return t;case 5:return gu(t),e===null&&Uo(t),r=t.type,l=t.pendingProps,s=e!==null?e.memoizedProps:null,c=l.children,Oo(r,l)?c=null:s!==null&&Oo(r,s)&&(t.flags|=32),Ju(e,t),it(e,t,c,n),t.child;case 6:return e===null&&Uo(t),null;case 13:return ec(e,t,n);case 4:return Yo(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=cr(t,null,r,n):it(e,t,r,n),t.child;case 11:return r=t.type,l=t.pendingProps,l=t.elementType===r?l:Lt(r,l),Ku(e,t,r,l,n);case 7:return it(e,t,t.pendingProps,n),t.child;case 8:return it(e,t,t.pendingProps.children,n),t.child;case 12:return it(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,l=t.pendingProps,s=t.memoizedProps,c=l.value,Le(ss,r._currentValue),r._currentValue=c,s!==null)if(Ot(s.value,c)){if(s.children===l.children&&!ct.current){t=rn(e,t,n);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var v=s.dependencies;if(v!==null){c=s.child;for(var N=v.firstContext;N!==null;){if(N.context===r){if(s.tag===1){N=nn(-1,n&-n),N.tag=2;var M=s.updateQueue;if(M!==null){M=M.shared;var G=M.pending;G===null?N.next=N:(N.next=G.next,G.next=N),M.pending=N}}s.lanes|=n,N=s.alternate,N!==null&&(N.lanes|=n),Ko(s.return,n,t),v.lanes|=n;break}N=N.next}}else if(s.tag===10)c=s.type===t.type?null:s.child;else if(s.tag===18){if(c=s.return,c===null)throw Error(u(341));c.lanes|=n,v=c.alternate,v!==null&&(v.lanes|=n),Ko(c,n,t),c=s.sibling}else c=s.child;if(c!==null)c.return=s;else for(c=s;c!==null;){if(c===t){c=null;break}if(s=c.sibling,s!==null){s.return=c.return,c=s;break}c=c.return}s=c}it(e,t,l.children,n),t=t.child}return t;case 9:return l=t.type,r=t.pendingProps.children,fr(t,n),l=Et(l),r=r(l),t.flags|=1,it(e,t,r,n),t.child;case 14:return r=t.type,l=Lt(r,t.pendingProps),l=Lt(r.type,l),Qu(e,t,r,l,n);case 15:return Gu(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,l=t.pendingProps,l=t.elementType===r?l:Lt(r,l),ys(e,t),t.tag=1,dt(r)?(e=!0,Zl(t)):e=!1,fr(t,n),Fu(t,r,l),ai(t,r,l,n),fi(null,t,r,!0,e,n);case 19:return nc(e,t,n);case 22:return Yu(e,t,n)}throw Error(u(156,t.tag))};function Ec(e,t){return Rr(e,t)}function Kf(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function _t(e,t,n,r){return new Kf(e,t,n,r)}function Oi(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Qf(e){if(typeof e=="function")return Oi(e)?1:0;if(e!=null){if(e=e.$$typeof,e===I)return 11;if(e===ue)return 14}return 2}function jn(e,t){var n=e.alternate;return n===null?(n=_t(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Ps(e,t,n,r,l,s){var c=2;if(r=e,typeof e=="function")Oi(e)&&(c=1);else if(typeof e=="string")c=5;else e:switch(e){case L:return Vn(n.children,l,s,t);case Z:c=8,l|=8;break;case J:return e=_t(12,n,t,l|2),e.elementType=J,e.lanes=s,e;case ae:return e=_t(13,n,t,l),e.elementType=ae,e.lanes=s,e;case oe:return e=_t(19,n,t,l),e.elementType=oe,e.lanes=s,e;case z:return _s(n,l,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case F:c=10;break e;case ce:c=9;break e;case I:c=11;break e;case ue:c=14;break e;case se:c=16,r=null;break e}throw Error(u(130,e==null?e:typeof e,""))}return t=_t(c,n,t,l),t.elementType=e,t.type=r,t.lanes=s,t}function Vn(e,t,n,r){return e=_t(7,e,r,t),e.lanes=n,e}function _s(e,t,n,r){return e=_t(22,e,r,t),e.elementType=z,e.lanes=n,e.stateNode={isHidden:!1},e}function Ti(e,t,n){return e=_t(6,e,null,t),e.lanes=n,e}function Li(e,t,n){return t=_t(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Gf(e,t,n,r,l){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=oo(0),this.expirationTimes=oo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=oo(0),this.identifierPrefix=r,this.onRecoverableError=l,this.mutableSourceEagerHydrationData=null}function zi(e,t,n,r,l,s,c,v,N){return e=new Gf(e,t,n,v,N),t===1?(t=1,s===!0&&(t|=8)):t=0,s=_t(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Go(s),e}function Yf(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:q,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function bc(e){if(!e)return mn;e=e._reactInternals;e:{if(Jt(e)!==e||e.tag!==1)throw Error(u(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(dt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(u(171))}if(e.tag===1){var n=e.type;if(dt(n))return tu(e,n,t)}return t}function Pc(e,t,n,r,l,s,c,v,N){return e=zi(n,r,!0,e,l,s,c,v,N),e.context=bc(null),n=e.current,r=at(),l=kn(n),s=nn(r,l),s.callback=t??null,vn(n,s,l),e.current.lanes=l,Lr(e,l,r),pt(e,r),e}function Ds(e,t,n,r){var l=t.current,s=at(),c=kn(l);return n=bc(n),t.context===null?t.context=n:t.pendingContext=n,t=nn(s,c),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=vn(l,t,c),e!==null&&(Mt(e,l,c,s),is(e,l,c)),c}function Rs(e){return e=e.current,e.child?(e.child.tag===5,e.child.stateNode):null}function _c(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Ii(e,t){_c(e,t),(e=e.alternate)&&_c(e,t)}function Jf(){return null}var Dc=typeof reportError=="function"?reportError:function(e){console.error(e)};function Mi(e){this._internalRoot=e}Os.prototype.render=Mi.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(u(409));Ds(e,t,null,null)},Os.prototype.unmount=Mi.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Un(function(){Ds(null,e,null,null)}),t[Xt]=null}};function Os(e){this._internalRoot=e}Os.prototype.unstable_scheduleHydration=function(e){if(e){var t=ha();e={blockedOn:null,target:e,priority:t};for(var n=0;n<cn.length&&t!==0&&t<cn[n].priority;n++);cn.splice(n,0,e),n===0&&ga(e)}};function $i(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Ts(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Rc(){}function Xf(e,t,n,r,l){if(l){if(typeof r=="function"){var s=r;r=function(){var M=Rs(c);s.call(M)}}var c=Pc(t,r,e,0,null,!1,!1,"",Rc);return e._reactRootContainer=c,e[Xt]=c.current,Gr(e.nodeType===8?e.parentNode:e),Un(),c}for(;l=e.lastChild;)e.removeChild(l);if(typeof r=="function"){var v=r;r=function(){var M=Rs(N);v.call(M)}}var N=zi(e,0,!1,null,null,!1,!1,"",Rc);return e._reactRootContainer=N,e[Xt]=N.current,Gr(e.nodeType===8?e.parentNode:e),Un(function(){Ds(t,N,n,r)}),N}function Ls(e,t,n,r,l){var s=n._reactRootContainer;if(s){var c=s;if(typeof l=="function"){var v=l;l=function(){var N=Rs(c);v.call(N)}}Ds(t,c,e,l)}else c=Xf(n,t,e,l,r);return Rs(c)}da=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Tr(t.pendingLanes);n!==0&&(io(t,n|1),pt(t,$e()),(De&6)===0&&(yr=$e()+500,gn()))}break;case 13:Un(function(){var r=tn(e,1);if(r!==null){var l=at();Mt(r,e,1,l)}}),Ii(e,1)}},ao=function(e){if(e.tag===13){var t=tn(e,134217728);if(t!==null){var n=at();Mt(t,e,134217728,n)}Ii(e,134217728)}},fa=function(e){if(e.tag===13){var t=kn(e),n=tn(e,t);if(n!==null){var r=at();Mt(n,e,t,r)}Ii(e,t)}},ha=function(){return Te},pa=function(e,t){var n=Te;try{return Te=e,t()}finally{Te=n}},Pr=function(e,t,n){switch(t){case"input":if(be(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var l=Xl(r);if(!l)throw Error(u(90));ne(r),be(r,l)}}}break;case"textarea":gl(e,n);break;case"select":t=n.value,t!=null&&ot(e,!!n.multiple,t,!1)}},jl=_i,Gn=Un;var qf={usingClientEntryPoint:!1,Events:[Xr,lr,Xl,kl,Sl,_i]},dl={findFiberByHostInstance:Tn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Zf={bundleType:dl.bundleType,version:dl.version,rendererPackageName:dl.rendererPackageName,rendererConfig:dl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:T.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Pl(e),e===null?null:e.stateNode},findFiberByHostInstance:dl.findFiberByHostInstance||Jf,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zs=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zs.isDisabled&&zs.supportsFiber)try{Ol=zs.inject(Zf),At=zs}catch{}}return mt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=qf,mt.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!$i(t))throw Error(u(200));return Yf(e,t,null,n)},mt.createRoot=function(e,t){if(!$i(e))throw Error(u(299));var n=!1,r="",l=Dc;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(l=t.onRecoverableError)),t=zi(e,1,!1,null,null,n,!1,r,l),e[Xt]=t.current,Gr(e.nodeType===8?e.parentNode:e),new Mi(t)},mt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(u(188)):(e=Object.keys(e).join(","),Error(u(268,e)));return e=Pl(t),e=e===null?null:e.stateNode,e},mt.flushSync=function(e){return Un(e)},mt.hydrate=function(e,t,n){if(!Ts(t))throw Error(u(200));return Ls(null,e,t,!0,n)},mt.hydrateRoot=function(e,t,n){if(!$i(e))throw Error(u(405));var r=n!=null&&n.hydratedSources||null,l=!1,s="",c=Dc;if(n!=null&&(n.unstable_strictMode===!0&&(l=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(c=n.onRecoverableError)),t=Pc(t,null,e,1,n??null,l,!1,s,c),e[Xt]=t.current,Gr(e),r)for(e=0;e<r.length;e++)n=r[e],l=n._getVersion,l=l(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,l]:t.mutableSourceEagerHydrationData.push(n,l);return new Os(t)},mt.render=function(e,t,n){if(!Ts(t))throw Error(u(200));return Ls(null,e,t,!1,n)},mt.unmountComponentAtNode=function(e){if(!Ts(e))throw Error(u(40));return e._reactRootContainer?(Un(function(){Ls(null,null,e,!1,function(){e._reactRootContainer=null,e[Xt]=null})}),!0):!1},mt.unstable_batchedUpdates=_i,mt.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Ts(n))throw Error(u(200));if(e==null||e._reactInternals===void 0)throw Error(u(38));return Ls(e,t,n,!1,r)},mt.version="18.3.1-next-f1338f8080-20240426",mt}var Fc;function ah(){if(Fc)return Ui.exports;Fc=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(a){console.error(a)}}return i(),Ui.exports=ih(),Ui.exports}var Ac;function uh(){if(Ac)return Is;Ac=1;var i=ah();return Is.createRoot=i.createRoot,Is.hydrateRoot=i.hydrateRoot,Is}var ch=uh();const ze={get(i){try{return localStorage.getItem(i)}catch(a){return console.warn("safeLocalStorage.get failed",a),null}},set(i,a){try{if(localStorage.setItem(i,a),localStorage.getItem(i)!==a)throw new Error("Failed to verify localStorage write")}catch(u){throw console.error("safeLocalStorage.set failed",u),u}},remove(i){try{localStorage.removeItem(i)}catch(a){console.warn("safeLocalStorage.remove failed",a)}}};var dh={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const fh=i=>i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ut=(i,a)=>{const u=C.forwardRef(({color:d="currentColor",size:f=24,strokeWidth:h=2,absoluteStrokeWidth:p,children:y,...x},k)=>C.createElement("svg",{ref:k,...dh,width:f,height:f,stroke:d,strokeWidth:p?Number(h)*24/Number(f):h,className:`lucide lucide-${fh(i)}`,...x},[...a.map(([w,E])=>C.createElement(w,E)),...(Array.isArray(y)?y:[y])||[]]));return u.displayName=`${i}`,u},Uc=ut("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),hh=ut("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),rd=ut("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),Fs=ut("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),ld=ut("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),ph=ut("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),sa=ut("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),Gi=ut("FolderOpen",[["path",{d:"m6 14 1.45-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.55 6a2 2 0 0 1-1.94 1.5H4a2 2 0 0 1-2-2V5c0-1.1.9-2 2-2h3.93a2 2 0 0 1 1.66.9l.82 1.2a2 2 0 0 0 1.66.9H18a2 2 0 0 1 2 2v2",key:"1nmvlm"}]]),As=ut("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),Qs=ut("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]),Yi=ut("Pencil",[["line",{x1:"18",x2:"22",y1:"2",y2:"6",key:"1e96e7"}],["path",{d:"M7.5 20.5 19 9l-4-4L3.5 16.5 2 22z",key:"12iwkt"}]]),mh=ut("Plus",[["line",{x1:"12",x2:"12",y1:"5",y2:"19",key:"pwfkuu"}],["line",{x1:"5",x2:"19",y1:"12",y2:"12",key:"13b5wn"}]]),Ji=ut("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),gh=ut("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]),Wt=ut("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),yh=/^(?:day|d)[\s_-]?(\d{1,2})(?:[^\d]|$)/i,vh=/(\d{4})-(\d{2})-(\d{2})/,xh=/(\d{4})_(\d{2})_(\d{2})/,wh=/^(\d{1,2})[\s_-]/,Nh=/^([A-M])(?:[\s_-]+)(Establishing|People|Culture(?:[-_\s]?Detail)?|Detail|Action|Moment|Transition|Mood|Food)$/i,kh=/^([A-M])$/i,Sh=/^([A-M])(?:[\s_-]+)(.+)$/i,jh=/^(0[1-6])$/,Bc={"01":"A","02":"B","03":"C","04":"D","05":"E","06":"M"};function Hc(i,a){try{const u=new Date(i),d=a?new Date(a):u;if(isNaN(u.getTime())||isNaN(d.getTime()))return null;const f=u.getTime()-d.getTime();return Math.floor(f/(1e3*60*60*24))+1}catch{return null}}function Us(i,a){const u=i.match(yh);if(u){const h=parseInt(u[1],10);if(h>=1&&h<=31)return{day:h,pattern:"day_prefix",confidence:"high"}}let d=i.match(vh);if(d){const h=`${d[1]}-${d[2]}-${d[3]}`,p=Hc(h,a);if(p!==null)return{day:p,pattern:"iso_date",confidence:a?"high":"medium"}}if(d=i.match(xh),d){const h=`${d[1]}-${d[2]}-${d[3]}`,p=Hc(h,a);if(p!==null)return{day:p,pattern:"iso_date",confidence:a?"high":"medium"}}const f=i.match(wh);if(f){const h=parseInt(f[1],10);if(h>=1&&h<=31)return{day:h,pattern:"numeric_prefix",confidence:"medium"}}return null}function Nr(i,a){return Us(i,a)?.day??null}function Xi(i){const a=i.match(Nh);if(a)return{bucket:a[1].toUpperCase(),confidence:"high",pattern:"standard"};const u=i.match(kh);if(u)return{bucket:u[1].toUpperCase(),confidence:"high",pattern:"letter"};const d=i.match(Sh);if(d)return{bucket:d[1].toUpperCase(),confidence:"medium",pattern:"custom"};const f=i.match(jh);return f&&Bc[f[1]]?{bucket:Bc[f[1]],confidence:"low",pattern:"numeric"}:null}function Ch(i,a){const u="01_DAYS",d=i.split(/[\\/]/).filter(Boolean),f=d.length>0?d.slice(0,-1):[];let h=null,p=null,y="none",x="none";const k=f.findIndex(D=>{const A=D.toLowerCase();return A===u.toLowerCase()||A==="01_days"||A==="days"});if(k!==-1&&k<f.length-1){const D=f[k+1],A=Us(D);if(A&&(h=A.day,y=A.confidence,k+2<f.length)){const U=f[k+2],O=Xi(U);O&&(p=O.bucket,x=O.confidence)}}else for(let D=0;D<f.length;D++){const A=f[D],U=Us(A);if(U){if(h=U.day,y=U.confidence==="high"?"medium":"low",D+1<f.length){const O=f[D+1],B=Xi(O);B&&(p=B.bucket,x=B.confidence)}break}}const w=h!==null&&p!==null;let E="none";return w?y==="high"&&x==="high"?E="high":y!=="none"&&x!=="none"?E="medium":E="low":h!==null&&(E=y),{detectedDay:h,detectedBucket:p,isPreOrganized:w,confidence:E,pathSegments:f}}async function Vc(i){const a=[],u=["jpg","jpeg","png","heic","webp","mp4","mov","webm","avi","mkv"];try{for await(const[d,f]of i.entries()){if(f.kind!=="directory")continue;const h=Xi(d);if(!h)continue;let p=0;for await(const[y,x]of f.entries()){if(x.kind!=="file")continue;const k=y.split(".").pop()?.toLowerCase()||"";u.includes(k)&&(p+=1)}a.push({bucketLetter:h.bucket,folderName:d,photoCount:p,confidence:h.confidence,patternMatched:h.pattern})}}catch(d){console.warn("Failed to scan for buckets:",d)}return a.sort((d,f)=>d.bucketLetter.localeCompare(f.bucketLetter))}function Wc(i){return i===null?"Unsorted":`Day ${String(i).padStart(2,"0")}`}function Eh(i){return[/^\..*/,/^unsorted$/i,/^inbox$/i,/^miscellaneous$/i,/^metadata$/i,/^_meta$/i].some(u=>u.test(i))}function Kc(i,a){const{photoCountMap:u=new Map,projectName:d="",tripStart:f}=a||{},h=[];for(const p of i){if(Eh(p)||d&&p.toLowerCase()===d.toLowerCase())continue;const y=u.get(p)||0,x=Us(p,f);x?h.push({folder:p,folderPath:p,detectedDay:x.day,confidence:x.confidence,patternMatched:x.pattern,suggestedName:Wc(x.day),manual:!1,photoCount:y}):h.push({folder:p,folderPath:p,detectedDay:null,confidence:"undetected",patternMatched:"none",suggestedName:Wc(null),manual:!1,photoCount:y})}return h.sort((p,y)=>p.detectedDay===null&&y.detectedDay===null?p.folder.localeCompare(y.folder):p.detectedDay===null?1:y.detectedDay===null?-1:p.detectedDay-y.detectedDay),h}function sd({isOpen:i,onClose:a,onComplete:u,recentProjects:d=[],onSelectRecent:f}){const[h,p]=C.useState("select"),[y,x]=C.useState(""),[k,w]=C.useState(""),[E,D]=C.useState(null),[A,U]=C.useState(null),[O,B]=C.useState([]),[H,V]=C.useState(!1),re=$s.useRef(null),T=C.useCallback(async()=>{if(!y.trim()){D("Please enter a project name");return}if(!A){D("Please choose a folder");return}D(null),V(!0);try{const L=["jpg","jpeg","png","heic","webp","mp4","mov","webm","avi","mkv"],Z=z=>{const m=z.toLowerCase().replace(/[^a-z0-9]+/g,"");return m==="01days"||m==="days"},J=async z=>{let m=0;for await(const[,$]of z.entries())if($.kind==="directory")m+=await J($);else if($.kind==="file"){const S=$.name.split(".").pop()?.toLowerCase()||"";L.includes(S)&&(m+=1)}return m},F=new Map,ce=[],I=new Map;for await(const[z,m]of A.entries()){if(m.kind!=="directory")continue;ce.push(z),I.set(z,m);let $=0;for await(const[,S]of m.entries()){if(S.kind!=="file")continue;const g=S.name.split(".").pop()?.toLowerCase()||"";L.includes(g)&&($+=1)}F.set(z,$)}const ae=ce.find(z=>Z(z))||null;if(ae){const z=I.get(ae);if(z){const m=[],$=new Map,S=new Map;for await(const[Y,te]of z.entries()){if(te.kind!=="directory")continue;m.push(Y),$.set(Y,te);const de=await J(te);S.set(Y,de)}const g=Kc(m,{photoCountMap:S,projectName:y}).map(Y=>({...Y,folderPath:`${ae}/${Y.folder}`})),W=(await Promise.all(g.map(async Y=>{const te=$.get(Y.folder);if(!te||Y.confidence==="undetected")return Y;const de=await Vc(te);return{...Y,detectedBuckets:de,isOrganizedStructure:de.length>0,bucketConfidence:de.length>0?de.every(Ne=>Ne.confidence==="high")?"high":"medium":"none"}}))).map(Y=>({...Y,skip:Y.confidence==="undetected"?!0:Y.skip??!1}));B(W),p("preview");return}}const oe=Kc(ce,{photoCountMap:F,projectName:y}),se=(await Promise.all(oe.map(async z=>{const m=I.get(z.folder);if(!m||z.confidence==="undetected")return z;const $=await Vc(m);return{...z,detectedBuckets:$,isOrganizedStructure:$.length>0,bucketConfidence:$.length>0?$.every(S=>S.confidence==="high")?"high":"medium":"none"}}))).map(z=>({...z,skip:z.confidence==="undetected"?!0:z.skip??!1}));B(se),p("preview")}catch(L){D(L instanceof Error?L.message:"Failed to detect folder structure")}finally{V(!1)}},[A,y]),Q=C.useCallback((L,Z,J)=>{B(F=>{const ce=[...F];return Z==="detectedDay"?(ce[L].detectedDay=J===""?null:parseInt(J,10),ce[L].manual=!0):Z==="skip"?ce[L].skip=J:ce[L][Z]=J,ce})},[]),q=C.useCallback(()=>{if(!y.trim()){D("Please enter a project name");return}if(!A){D("Please choose a folder");return}const L=k.trim()||A.name,Z=d.find(J=>J.rootPath.toLowerCase()===L.toLowerCase());if(Z){D(`This folder is already being used by project "${Z.projectName}". Opening the same folder twice could cause conflicts. Open the existing project instead or choose a different folder.`);return}D(null),u({projectName:y.trim(),rootPath:L,dirHandle:A,mappings:O}),a()},[A,O,a,u,y,k,d]);return i?o.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-start justify-center z-50 pt-12",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-3xl w-full mx-6 max-h-[88vh] overflow-y-auto",children:[o.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-8 py-6 flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-extrabold text-gray-900",children:h==="select"?"Create Project":"Review Folder Structure"}),o.jsx("p",{className:"text-sm text-gray-500 mt-1",children:h==="select"?"Add a project name and choose the folder that contains your photos.":"Confirm how your existing folders map to days."})]}),o.jsx("button",{onClick:a,className:"text-gray-600 hover:text-gray-800 rounded-md px-2 py-1","aria-label":"Close",children:o.jsx(Wt,{size:20})})]}),o.jsxs("div",{className:"px-8 py-6 space-y-6",children:[E&&o.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg text-sm text-red-800",children:E}),h==="select"&&d.length>0&&o.jsxs("div",{className:"space-y-3 rounded-lg border border-gray-200 bg-gray-50 p-4",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Recent Projects"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Open a recent project instead of creating a new one."})]}),o.jsx("div",{className:"space-y-2",children:d.map(L=>o.jsxs("button",{onClick:()=>{f?.(L.projectId),a()},className:"w-full text-left rounded-lg border border-gray-200 bg-white px-3 py-2 hover:border-blue-300 hover:bg-blue-50",children:[o.jsx("div",{className:"text-sm font-medium text-gray-900",children:L.projectName}),o.jsx("div",{className:"text-xs text-gray-600 truncate",children:L.rootPath})]},L.projectId))})]}),h==="select"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Project Name"}),o.jsx("input",{type:"text",value:y,onChange:L=>x(L.target.value),placeholder:"e.g., Mexico 2025",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 placeholder:text-gray-600 text-gray-900"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Folder Path"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{type:"text",value:k,onChange:L=>w(L.target.value),placeholder:"/Users/you/trips/mexico",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 placeholder:text-gray-600 text-gray-900"}),o.jsx("input",{ref:re,type:"file",webkitdirectory:"true",as:!0,any:!0,directory:"true",mozdirectory:"true",className:"hidden",onChange:L=>{const Z=L.currentTarget.files;if(!Z||Z.length===0)return;const J=Z[0],ce=(J.webkitRelativePath||J.name).split("/")[0];w(ce),U(null),L.currentTarget.value=""}}),o.jsxs("button",{onClick:async()=>{if("showDirectoryPicker"in window){const L=await window.showDirectoryPicker();U(L),w(L?.name||"");return}re.current?.click()},className:"px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 flex items-center gap-2",children:[o.jsx(Gi,{size:18}),"Browse"]})]}),o.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Use the folder picker to grant access. If the picker is unavailable, paste the full path (the app will ask again on first open)."})]})]}),h==="preview"&&o.jsxs("div",{className:"space-y-4",children:[o.jsx("p",{className:"text-sm text-gray-600",children:"Review the detected folders and adjust the day numbers if needed."}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50",children:[o.jsx("th",{className:"text-left px-3 py-2 font-medium text-gray-700",children:"Folder"}),o.jsx("th",{className:"text-center px-3 py-2 font-medium text-gray-700",children:"Day #"}),o.jsx("th",{className:"text-left px-3 py-2 font-medium text-gray-700",children:"Buckets"}),o.jsx("th",{className:"text-center px-3 py-2 font-medium text-gray-700",children:"Photos"}),o.jsx("th",{className:"text-center px-3 py-2 font-medium text-gray-700",children:"Action"})]})}),o.jsxs("tbody",{children:[O.map((L,Z)=>o.jsxs("tr",{className:`border-b border-gray-200 ${L.skip?"bg-gray-100 opacity-60":"hover:bg-blue-50"}`,children:[o.jsx("td",{className:"px-3 py-3 text-gray-900",children:L.folder}),o.jsx("td",{className:"px-3 py-3 text-center",children:o.jsx("input",{type:"number",min:"1",max:"31",value:L.detectedDay??"",onChange:J=>Q(Z,"detectedDay",J.target.value),disabled:L.skip,className:"w-12 px-2 py-1 border border-gray-300 rounded text-center focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900",placeholder:""})}),o.jsx("td",{className:"px-3 py-3",children:L.detectedBuckets&&L.detectedBuckets.length>0?o.jsx("div",{className:"flex flex-wrap gap-1",children:L.detectedBuckets.map(J=>o.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800",title:`${J.folderName} (${J.photoCount} photos)`,children:[J.bucketLetter,o.jsxs("span",{className:"ml-1 text-green-600",children:["(",J.photoCount,")"]})]},J.bucketLetter))}):o.jsx("span",{className:"text-xs text-gray-400 italic",children:"None detected"})}),o.jsx("td",{className:"px-3 py-3 text-center text-gray-600",children:L.photoCount}),o.jsx("td",{className:"px-3 py-3 text-center",children:o.jsx("button",{onClick:()=>Q(Z,"skip",!L.skip),className:`px-3 py-1 rounded text-sm font-medium ${L.skip?"bg-gray-200 text-gray-700 hover:bg-gray-300":"bg-blue-100 text-blue-700 hover:bg-blue-200"}`,children:L.skip?"Skip":"Map"})})]},L.folder)),O.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:5,className:"px-3 py-4 text-sm text-gray-600 text-center",children:"No subfolders detected. You can still continue and sort manually."})})]})]})})]})]}),o.jsx("div",{className:"sticky bottom-0 bg-white border-t border-gray-200 px-6 py-4 flex justify-between gap-3",children:h==="select"?o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 font-medium",children:"Cancel"}),o.jsx("button",{onClick:T,disabled:!y.trim()||!A||H,"aria-disabled":!y.trim()||!A||H,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium disabled:bg-gray-200 disabled:text-gray-500 disabled:cursor-not-allowed",children:H?"Detecting":"Next"})]}):o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:()=>p("select"),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 font-medium",children:"Back"}),o.jsx("button",{onClick:q,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",children:"Create Project"})]})})]})}):null}const bh="narrative-covers",Ph=1,Pn="covers",gt="metadata";let Ms=null;async function Gs(){return Ms||new Promise((i,a)=>{const u=indexedDB.open(bh,Ph);u.onerror=()=>a(u.error),u.onsuccess=()=>{Ms=u.result,i(Ms)},u.onupgradeneeded=d=>{const f=d.target.result;f.objectStoreNames.contains(Pn)||f.createObjectStore(Pn,{keyPath:"coverKey"}),f.objectStoreNames.contains(gt)||f.createObjectStore(gt,{keyPath:"projectId"}).createIndex("lastUsed","lastUsed",{unique:!1})}})}async function _h(i,a,u=120,d=90){const f=await Gs(),h=`cover-${i}-${Date.now()}`,p=a.size,y=f.transaction([Pn],"readwrite").objectStore(Pn).put({coverKey:h,blob:a});await new Promise((w,E)=>{y.onsuccess=()=>w(),y.onerror=()=>E(y.error)});const x={projectId:i,coverKey:h,lastUsed:Date.now(),width:u,height:d,sizeBytes:p},k=f.transaction([gt],"readwrite").objectStore(gt).put(x);return await new Promise((w,E)=>{k.onsuccess=()=>w(),k.onerror=()=>E(k.error)}),h}async function Dh(i){const a=await Gs(),u=a.transaction([gt],"readonly").objectStore(gt).get(i),d=await new Promise((y,x)=>{u.onsuccess=()=>y(u.result),u.onerror=()=>x(u.error)});if(!d)return null;const f=a.transaction([gt],"readwrite").objectStore(gt).put({...d,lastUsed:Date.now()});await new Promise((y,x)=>{f.onsuccess=()=>y(),f.onerror=()=>x(f.error)});const h=a.transaction([Pn],"readonly").objectStore(Pn).get(d.coverKey);return(await new Promise((y,x)=>{h.onsuccess=()=>y(h.result),h.onerror=()=>x(h.error)}))?.blob||null}async function Rh(i){const a=await Dh(i);return a?URL.createObjectURL(a):null}async function Oh(i){const a=await Gs(),u=a.transaction([gt],"readonly").objectStore(gt).get(i),d=await new Promise((p,y)=>{u.onsuccess=()=>p(u.result),u.onerror=()=>y(u.error)});if(!d)return;const f=a.transaction([Pn],"readwrite").objectStore(Pn).delete(d.coverKey);await new Promise((p,y)=>{f.onsuccess=()=>p(),f.onerror=()=>y(f.error)});const h=a.transaction([gt],"readwrite").objectStore(gt).delete(i);await new Promise((p,y)=>{h.onsuccess=()=>p(),h.onerror=()=>y(h.error)})}async function Th(){const a=(await Gs()).transaction([gt],"readonly").objectStore(gt).index("lastUsed");return await new Promise((d,f)=>{const h=a.getAll();h.onsuccess=()=>d(h.result),h.onerror=()=>f(h.error)})}async function Lh(i=10){const a=await Th(),u=[];if(a.length>i){const d=a.slice(0,a.length-i);for(const f of d)await Oh(f.projectId),u.push(f.projectId)}return u}function zh({project:i,onOpen:a}){const[u,d]=C.useState(null);return C.useEffect(()=>(i.coverKey?Rh(i.projectId).then(f=>d(f)).catch(f=>{console.warn(`Failed to load cover for ${i.projectId}:`,f),i.coverUrl&&d(i.coverUrl)}):i.coverUrl&&d(i.coverUrl),()=>{u&&u.startsWith("blob:")&&URL.revokeObjectURL(u)}),[i,i.coverKey,i.coverUrl]),o.jsxs("div",{className:"relative rounded-lg overflow-hidden border border-gray-800 bg-gray-950 hover:border-blue-500 transition-colors group cursor-pointer",children:[o.jsx("button",{onClick:()=>a(i.projectId),className:"w-full block text-left","aria-label":`Open project ${i.projectName}`,children:o.jsx("div",{className:"aspect-video overflow-hidden bg-gray-900 relative",children:u?o.jsx("img",{src:u,alt:i.projectName,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-200"}):o.jsx("div",{className:"w-full h-full bg-gradient-to-br from-gray-800 to-gray-900 flex items-center justify-center text-sm text-gray-400",children:o.jsx("div",{className:"text-center",children:o.jsx("div",{className:"text-xs font-medium text-gray-500",children:"No cover"})})})})}),o.jsxs("div",{className:"p-3 space-y-1",children:[o.jsx("div",{className:"text-sm font-semibold text-gray-200 truncate",children:i.projectName}),typeof i.totalPhotos=="number"&&o.jsx("div",{className:"text-xs text-gray-500",children:`${i.totalPhotos} ${i.totalPhotos===1?"photo":"photos"}`}),o.jsx("div",{className:"text-xs text-gray-600 truncate",children:i.rootPath})]})]})}const Ih="4.1.3";class wr{static instance;version;constructor(){this.version=Ih}static getInstance(){return wr.instance||(wr.instance=new wr),wr.instance}getVersion(){return this.version}getDisplayVersion(){return`v${this.version}`}isValidVersion(a){return/^\d+\.\d+\.\d+$/.test(a)}isCurrentVersionValid(){return this.isValidVersion(this.version)}getVersionComponents(){const[a,u,d]=this.version.split(".").map(Number);return{major:a,minor:u,patch:d}}compareVersions(a,u){const d=a.split(".").map(Number),f=u.split(".").map(Number);for(let h=0;h<3;h++){if(d[h]<f[h])return-1;if(d[h]>f[h])return 1}return 0}async fetchRuntimeVersion(){try{return null}catch(a){return console.warn("Error fetching runtime version:",a),null}}async getCurrentVersion(){return this.version}}const Bs=wr.getInstance();function Mh({isOpen:i,onClose:a,onCreateComplete:u,onOpenProject:d,recentProjects:f=[],canClose:h=!1,errorMessage:p=null}){const[y,x]=C.useState(!1),[k,w]=C.useState(Bs.getDisplayVersion());C.useEffect(()=>{(async()=>{try{const O=await Bs.getCurrentVersion();w(`v${O}`)}catch(O){console.warn("Failed to fetch runtime version:",O)}})()},[]);const E=typeof globalThis<"u"&&(globalThis.vitest||globalThis.__APP_VERSION__==="0.0.0"),D="showDirectoryPicker"in window,A="indexedDB"in window;return!E&&(!D||!A)?o.jsx("div",{className:"h-screen bg-gray-950 text-gray-100 flex items-center justify-center",children:o.jsxs("div",{className:"max-w-md mx-auto text-center p-6",children:[o.jsx("div",{className:"text-red-400 text-6xl mb-4",children:""}),o.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Browser Not Supported"}),o.jsx("p",{className:"text-gray-400 mb-4",children:"This app requires a modern browser with support for the File System Access API and IndexedDB."}),o.jsxs("div",{className:"text-sm text-gray-500 space-y-1",children:[!D&&o.jsx("div",{children:" File System Access API not available"}),!A&&o.jsx("div",{children:" IndexedDB not available"})]}),o.jsx("p",{className:"text-gray-400 text-sm mt-4",children:"Please use a recent version of Chrome, Edge, or another supported browser."})]})}):o.jsxs("div",{className:"h-screen bg-gray-950 text-gray-100 flex flex-col",children:[o.jsx("div",{className:"border-b border-gray-800 bg-gray-900/50 backdrop-blur-sm",children:o.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-4 flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("img",{src:"/Narrative/assets/Narrative_icon.png",alt:"Narrative",className:"w-8 h-8 rounded"}),o.jsx("h1",{className:"text-xl font-bold",children:"Narrative"})]}),o.jsx("div",{className:"px-3 py-1 bg-gray-800 text-gray-300 rounded-md text-xs font-medium tracking-wide",children:o.jsx("span",{className:"uppercase",children:k})})]})}),o.jsx("div",{className:"flex-1 flex items-center justify-center p-6",children:o.jsxs("div",{className:"w-full max-w-7xl",children:[o.jsxs("div",{className:"mb-8",children:[o.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Projects"}),o.jsx("p",{className:"text-gray-400 text-sm",children:"Create a new project or open a recent one"})]}),p&&o.jsx("div",{className:"rounded-lg border border-red-800 bg-red-950/60 px-4 py-3 text-sm text-red-200 mb-6",children:p}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 auto-rows-max",children:[o.jsxs("div",{className:"relative rounded-lg overflow-hidden border-2 border-dashed border-gray-700 bg-gray-950 hover:border-blue-500 transition-colors group cursor-pointer",children:[o.jsx("button",{onClick:()=>x(!0),className:"w-full block text-left","aria-label":"Create new project",children:o.jsx("div",{className:"aspect-video overflow-hidden bg-gray-900 relative",children:o.jsx("div",{className:"w-full h-full bg-gradient-to-br from-gray-800 to-gray-900 flex items-center justify-center group-hover:from-gray-700 group-hover:to-gray-800 transition-colors",children:o.jsx("div",{className:"w-14 h-14 rounded-full bg-gray-700 group-hover:bg-blue-500/20 flex items-center justify-center mb-2 transition-colors",children:o.jsx(mh,{className:"w-7 h-7 text-blue-400"})})})})}),o.jsxs("div",{className:"p-3 space-y-1",children:[o.jsx("div",{className:"text-sm font-semibold text-gray-200",children:"New Project"}),o.jsx("div",{className:"text-xs text-gray-500",children:"Start organizing photos"})]})]}),f.map(U=>o.jsx(zh,{project:U,onOpen:d},U.projectId))]}),f.length===0&&o.jsx("div",{className:"text-center py-12 text-gray-500",children:o.jsx("p",{className:"text-sm",children:"No recent projects. Create one to get started."})})]})}),o.jsx(sd,{isOpen:y,onClose:()=>x(!1),onComplete:U=>{x(!1),u(U)},recentProjects:f,onSelectRecent:d})]})}function $h({isOpen:i,title:a="Loading Project",message:u="Please wait while we load your project...",progress:d=0,showProgressBar:f=!0}){const[h,p]=C.useState(0);return C.useEffect(()=>{if(d!==h){const y=setTimeout(()=>{p(d)},100);return()=>clearTimeout(y)}},[d,h]),i?o.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-gray-900 rounded-lg shadow-2xl p-8 max-w-md w-full mx-4 border border-gray-800",children:[o.jsxs("div",{className:"flex flex-col items-center gap-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute inset-0 bg-blue-500 rounded-full blur-lg opacity-20"}),o.jsx(Qs,{className:"w-12 h-12 text-blue-400 animate-spin relative"})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:a}),o.jsx("p",{className:"text-gray-400 text-sm",children:u})]})]}),f&&o.jsxs("div",{className:"mt-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-2",children:[o.jsx("span",{className:"text-xs font-medium text-gray-400",children:"Progress"}),o.jsxs("span",{className:"text-xs font-bold text-blue-400",children:[Math.round(h),"%"]})]}),o.jsx("div",{className:"w-full bg-gray-800 rounded-full h-2 overflow-hidden",children:o.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-400 h-full rounded-full transition-all duration-300 ease-out",style:{width:`${h}%`}})})]}),o.jsx("div",{className:"mt-6 text-center",children:o.jsx("p",{className:"text-xs text-gray-500 animate-pulse",children:h===100?"Almost done...":"Loading..."})})]})}):null}const Fh="modulepreload",Ah=function(i){return"/Narrative/"+i},Qc={},Uh=function(a,u,d){let f=Promise.resolve();if(u&&u.length>0){let x=function(k){return Promise.all(k.map(w=>Promise.resolve(w).then(E=>({status:"fulfilled",value:E}),E=>({status:"rejected",reason:E}))))};document.getElementsByTagName("link");const p=document.querySelector("meta[property=csp-nonce]"),y=p?.nonce||p?.getAttribute("nonce");f=x(u.map(k=>{if(k=Ah(k),k in Qc)return;Qc[k]=!0;const w=k.endsWith(".css"),E=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${k}"]${E}`))return;const D=document.createElement("link");if(D.rel=w?"stylesheet":Fh,w||(D.as="script"),D.crossOrigin="",D.href=k,y&&D.setAttribute("nonce",y),document.head.appendChild(D),w)return new Promise((A,U)=>{D.addEventListener("load",A),D.addEventListener("error",()=>U(new Error(`Unable to preload CSS for ${k}`)))})}))}function h(p){const y=new Event("vite:preloadError",{cancelable:!0});if(y.payload=p,window.dispatchEvent(y),!y.defaultPrevented)throw p}return f.then(p=>{for(const y of p||[])y.status==="rejected"&&h(y.reason);return a().catch(h)})},qi=(i,a)=>a.some(u=>i instanceof u);let Gc,Yc;function Bh(){return Gc||(Gc=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Hh(){return Yc||(Yc=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Zi=new WeakMap,Vi=new WeakMap,Ys=new WeakMap;function Vh(i){const a=new Promise((u,d)=>{const f=()=>{i.removeEventListener("success",h),i.removeEventListener("error",p)},h=()=>{u(Kn(i.result)),f()},p=()=>{d(i.error),f()};i.addEventListener("success",h),i.addEventListener("error",p)});return Ys.set(a,i),a}function Wh(i){if(Zi.has(i))return;const a=new Promise((u,d)=>{const f=()=>{i.removeEventListener("complete",h),i.removeEventListener("error",p),i.removeEventListener("abort",p)},h=()=>{u(),f()},p=()=>{d(i.error||new DOMException("AbortError","AbortError")),f()};i.addEventListener("complete",h),i.addEventListener("error",p),i.addEventListener("abort",p)});Zi.set(i,a)}let ea={get(i,a,u){if(i instanceof IDBTransaction){if(a==="done")return Zi.get(i);if(a==="store")return u.objectStoreNames[1]?void 0:u.objectStore(u.objectStoreNames[0])}return Kn(i[a])},set(i,a,u){return i[a]=u,!0},has(i,a){return i instanceof IDBTransaction&&(a==="done"||a==="store")?!0:a in i}};function od(i){ea=i(ea)}function Kh(i){return Hh().includes(i)?function(...a){return i.apply(ta(this),a),Kn(this.request)}:function(...a){return Kn(i.apply(ta(this),a))}}function Qh(i){return typeof i=="function"?Kh(i):(i instanceof IDBTransaction&&Wh(i),qi(i,Bh())?new Proxy(i,ea):i)}function Kn(i){if(i instanceof IDBRequest)return Vh(i);if(Vi.has(i))return Vi.get(i);const a=Qh(i);return a!==i&&(Vi.set(i,a),Ys.set(a,i)),a}const ta=i=>Ys.get(i);function Gh(i,a,{blocked:u,upgrade:d,blocking:f,terminated:h}={}){const p=indexedDB.open(i,a),y=Kn(p);return d&&p.addEventListener("upgradeneeded",x=>{d(Kn(p.result),x.oldVersion,x.newVersion,Kn(p.transaction),x)}),u&&p.addEventListener("blocked",x=>u(x.oldVersion,x.newVersion,x)),y.then(x=>{h&&x.addEventListener("close",()=>h()),f&&x.addEventListener("versionchange",k=>f(k.oldVersion,k.newVersion,k))}).catch(()=>{}),y}const Yh=["get","getKey","getAll","getAllKeys","count"],Jh=["put","add","delete","clear"],Wi=new Map;function Jc(i,a){if(!(i instanceof IDBDatabase&&!(a in i)&&typeof a=="string"))return;if(Wi.get(a))return Wi.get(a);const u=a.replace(/FromIndex$/,""),d=a!==u,f=Jh.includes(u);if(!(u in(d?IDBIndex:IDBObjectStore).prototype)||!(f||Yh.includes(u)))return;const h=async function(p,...y){const x=this.transaction(p,f?"readwrite":"readonly");let k=x.store;return d&&(k=k.index(y.shift())),(await Promise.all([k[u](...y),f&&x.done]))[0]};return Wi.set(a,h),h}od(i=>({...i,get:(a,u,d)=>Jc(a,u)||i.get(a,u,d),has:(a,u)=>!!Jc(a,u)||i.has(a,u)}));const Xh=["continue","continuePrimaryKey","advance"],Xc={},na=new WeakMap,id=new WeakMap,qh={get(i,a){if(!Xh.includes(a))return i[a];let u=Xc[a];return u||(u=Xc[a]=function(...d){na.set(this,id.get(this)[a](...d))}),u}};async function*Zh(...i){let a=this;if(a instanceof IDBCursor||(a=await a.openCursor(...i)),!a)return;a=a;const u=new Proxy(a,qh);for(id.set(u,a),Ys.set(u,ta(a));a;)yield u,a=await(na.get(u)||a.continue()),na.delete(u)}function qc(i,a){return a===Symbol.asyncIterator&&qi(i,[IDBIndex,IDBObjectStore,IDBCursor])||a==="iterate"&&qi(i,[IDBIndex,IDBObjectStore])}od(i=>({...i,get(a,u,d){return qc(a,u)?Zh:i.get(a,u,d)},has(a,u){return qc(a,u)||i.has(a,u)}}));class ep{db=null;objectUrls=new Map;async init(){this.db||(this.db=await Gh("narrative-thumbnails",1,{upgrade(a){a.objectStoreNames.contains("thumbnails")||a.createObjectStore("thumbnails",{keyPath:"id"})}}))}async get(a){if(this.objectUrls.has(a))return this.objectUrls.get(a);await this.init();const u=await this.db.get("thumbnails",a);if(!u?.blob)return null;const d=URL.createObjectURL(u.blob);return this.objectUrls.set(a,d),d}async set(a,u){await this.init();const d=this.objectUrls.get(a);if(d){try{URL.revokeObjectURL(d)}catch{}this.objectUrls.delete(a)}await this.db.put("thumbnails",{id:a,blob:u,timestamp:Date.now()})}async clear(){await this.init(),await this.db.clear("thumbnails"),this.objectUrls.forEach(a=>{try{URL.revokeObjectURL(a)}catch{}}),this.objectUrls.clear()}}const Zc=new ep,tp=["jpg","jpeg","png","heic","webp","mp4","mov","webm","avi","mkv"],Js="narrative:projectState:",np="narrative:handles",Kt="projects",Hs={autoDay:!0,folderStructure:{daysFolder:"01_DAYS",archiveFolder:"98_ARCHIVE",favoritesFolder:"FAV",metaFolder:"_meta"}};function ad(){return`${Date.now().toString(36)}-${Math.random().toString(36).slice(2,8)}`}const rp=1e4;async function Xs(){if(!window.indexedDB)throw new Error("IndexedDB is not available in this environment.");return new Promise((i,a)=>{let u=!1;const d=p=>{u||(u=!0,p())},f=window.setTimeout(()=>{d(()=>a(new Error("IndexedDB open timed out.")))},rp),h=indexedDB.open(np,1);h.onupgradeneeded=()=>{const p=h.result;p.objectStoreNames.contains(Kt)||p.createObjectStore(Kt)},h.onsuccess=()=>{window.clearTimeout(f),d(()=>i(h.result))},h.onerror=()=>{window.clearTimeout(f),d(()=>a(h.error))},h.onblocked=()=>{window.clearTimeout(f),d(()=>a(new Error("IndexedDB open was blocked. Please close other Narrative tabs and retry.")))}})}async function oa(i,a){const u=await Xs();return new Promise((d,f)=>{const h=u.transaction(Kt,"readwrite");h.objectStore(Kt).put(a,i),h.oncomplete=()=>d(),h.onerror=()=>f(h.error)})}async function Vs(i){const a=await Xs();return new Promise((u,d)=>{const h=a.transaction(Kt,"readonly").objectStore(Kt).get(i);h.onsuccess=()=>u(h.result||null),h.onerror=()=>d(h.error)})}async function lp(i){const a=await Xs();return new Promise((u,d)=>{const f=a.transaction(Kt,"readwrite");f.objectStore(Kt).delete(i),f.oncomplete=()=>u(),f.onerror=()=>d(f.error)})}function sp(i){const a=i.split(".").pop()?.toLowerCase()||"";return tp.includes(a)}function op(i){const a=i.toLowerCase();return i.startsWith(".")||i.startsWith("._")||a==="thumbs.db"||a==="desktop.ini"}async function ud(i,a=""){const u=[];for await(const[d,f]of i.entries())if(f.kind==="directory"){if(d.startsWith("."))continue;const h=await ud(f,a?`${a}/${d}`:d);u.push(...h)}else if(f.kind==="file"){if(op(d)||!sp(d))continue;const h=a?`${a}/${d}`:d;u.push({handle:f,path:h})}return u}async function ip(i){try{if(typeof createImageBitmap<"u")return(await createImageBitmap(i)).close(),i}catch{}try{const d=(await Uh(async()=>{const{default:f}=await import("./heic2any-DeblY5-W.js").then(h=>h.h);return{default:f}},[])).default;try{return await d({blob:i,toType:"image/jpeg",quality:.8})}catch(f){if(f?.message?.includes("already browser readable")||f?.message?.includes("ERR_USER")||f?.code===1)return i;console.warn(`heic2any conversion failed for ${i.name}:`,f)}}catch{console.warn("heic2any library not available, trying fallbacks")}const a=document.createElement("canvas"),u=a.getContext("2d");if(!u)return new Blob([""],{type:"image/jpeg"});try{if(typeof createImageBitmap<"u")try{const d=await createImageBitmap(i);a.width=d.width||400,a.height=d.height||300;try{u.drawImage(d,0,0)}catch{}return new Promise((f,h)=>{try{if(typeof a.toBlob=="function")a.toBlob(p=>{if(p){f(p);return}try{const x=a.toDataURL("image/jpeg",.8).split(","),k=x[0].match(/:(.*?);/),w=x[1];let E;if(typeof atob=="function"){const D=atob(w);let A=D.length;for(E=new Uint8Array(A);A--;)E[A]=D.charCodeAt(A)}else if(typeof Buffer<"u"){const D=Buffer.from(w,"base64");E=new Uint8Array(D.buffer,D.byteOffset,D.byteLength)}else throw new Error("No base64 decoder available");f(new Blob([E],{type:k&&k[1]||"image/jpeg"}))}catch{f(new Blob([""],{type:"image/jpeg"}))}},"image/jpeg",.8);else{const y=a.toDataURL("image/jpeg",.8).split(","),x=y[0].match(/:(.*?);/),k=y[1];let w;if(typeof atob=="function"){const E=atob(k);let D=E.length;for(w=new Uint8Array(D);D--;)w[D]=E.charCodeAt(D)}else if(typeof Buffer<"u"){const E=Buffer.from(k,"base64");w=new Uint8Array(E.buffer,E.byteOffset,E.byteLength)}else return f(new Blob([""],{type:"image/jpeg"}));f(new Blob([w],{type:x&&x[1]||"image/jpeg"}))}}catch{f(new Blob([""],{type:"image/jpeg"}))}})}catch{}try{const d=new Image,f=URL.createObjectURL(i);return d.crossOrigin="Anonymous",await new Promise((h,p)=>{d.onload=()=>h(),d.onerror=()=>p(new Error("Image load failed")),d.src=f}),a.width=d.naturalWidth||d.width||400,a.height=d.naturalHeight||d.height||300,u.drawImage(d,0,0),URL.revokeObjectURL(f),new Promise((h,p)=>{a.toBlob(y=>{if(y){h(y);return}try{const k=a.toDataURL("image/jpeg",.8).split(","),w=k[0].match(/:(.*?);/),E=k[1];let D;if(typeof atob=="function"){const A=atob(E);let U=A.length;for(D=new Uint8Array(U);U--;)D[U]=A.charCodeAt(U)}else if(typeof Buffer<"u"){const A=Buffer.from(E,"base64");D=new Uint8Array(A.buffer,A.byteOffset,A.byteLength)}else{h(new Blob([""],{type:"image/jpeg"}));return}h(new Blob([D],{type:w&&w[1]||"image/jpeg"}))}catch{h(new Blob([""],{type:"image/jpeg"}))}},"image/jpeg",.8)})}catch{}return a.width=400,a.height=300,u.fillStyle="#e5e5e5",u.fillRect(0,0,400,300),u.fillStyle="#666666",u.font="bold 16px sans-serif",u.textAlign="center",u.textBaseline="middle",u.fillText("HEIC",200,140),u.font="12px sans-serif",u.fillText("Preview not available",200,165),new Promise(d=>{a.toBlob(f=>{if(f){d(f);return}d(new Blob([""],{type:"image/jpeg"}))},"image/jpeg",.8)})}catch{return new Blob([""],{type:"image/jpeg"})}}async function ia(i,a){const u=await ud(i),d=[],f=new Set;for(let h=0;h<u.length;h++){const p=u[h],y=Math.round((h+1)/u.length*100);a?.(y,`Processing ${p.handle.name}...`);const x=await p.handle.getFile(),k=x.lastModified,w=x.name,E=`${w}|${k}|${x.size}`;if(f.has(E))continue;f.add(E);const D=ad(),A=x.name.split(".").pop()?.toLowerCase()||"",U=A==="heic"||A==="heif"||x.type.toLowerCase().includes("heic");let O="";if(U)try{const q=p.path,L=await Zc.get(q);if(L)O=L;else{const Z=await ip(x);Z&&(O=URL.createObjectURL(Z),await Zc.set(q,Z))}}catch(q){console.warn(`Failed to generate preview for ${w}:`,q)}else try{O=URL.createObjectURL(x)}catch(q){console.warn(`Failed to create object URL for ${w}:`,q)}const B=Ch(p.path),H=p.path.split(/[\\/]/).filter(Boolean),V=H.length>1?H.slice(0,-1):[],re=V[V.length-1]||"root";let T=null,Q=null;B.isPreOrganized&&B.confidence==="high"&&(T=B.detectedDay,Q=B.detectedBucket),d.push({id:D,originalName:w,currentName:w,timestamp:k,day:T,bucket:Q,sequence:null,favorite:!1,rating:0,archived:!1,thumbnail:O,mimeType:x.type||(U?"image/heic":""),fileHandle:p.handle,filePath:p.path,sourceFolder:re,folderHierarchy:V,detectedDay:B.detectedDay,detectedBucket:B.detectedBucket,isPreOrganized:B.isPreOrganized,organizationConfidence:B.confidence})}return d.sort((h,p)=>h.timestamp-p.timestamp)}function ap(i){const a={};if(i.length===0)return a;let u=1,d=i[0].timestamp;const f=360*60*1e3;return a[u]=[],i.forEach(h=>{h.timestamp-d>f&&(u+=1,a[u]=[]),a[u].push(h.id),d=h.timestamp}),a}function cd(i){const a=i.photos.map(u=>({filePath:u.filePath,day:u.day,bucket:u.bucket,sequence:u.sequence,favorite:u.favorite,rating:u.rating,archived:u.archived,currentName:u.currentName,sourceFolder:u.sourceFolder,folderHierarchy:u.folderHierarchy,detectedDay:u.detectedDay,detectedBucket:u.detectedBucket,isPreOrganized:u.isPreOrganized,organizationConfidence:u.organizationConfidence,subfolderOverride:u.subfolderOverride}));return{projectName:i.projectName,rootPath:i.rootPath,settings:i.settings,dayLabels:i.dayLabels||{},dayContainers:i.dayContainers||[],lastModified:i.lastModified??Date.now(),edits:a}}function up(i,a){const u=i.toLowerCase(),d=u.replace(/[^a-z0-9]+/g," ").trim(),f=a.toLowerCase();return!!(f&&u===f||u==="archive"||u==="archives"||u.endsWith("_archive")||u.endsWith("-archive")||u.includes("archive")||d.includes("archive"))}function dd(i,a){return a?i.map(u=>u.filePath&&u.filePath.split(/[\\/]/).filter(Boolean).some(f=>up(f,a))?{...u,archived:!0,bucket:"X"}:u):i}async function cp(i){const{dirHandle:a,projectName:u,rootLabel:d,onProgress:f}=i;if(!("requestPermission"in a))throw new Error("File System Access API is not available or supported in this environment.");let h;try{h=await a.requestPermission({mode:"read"})}catch(w){throw console.warn("Permission request failed:",w),new Error("Unable to request folder access. Please try again.")}if(h!=="granted")throw new Error("Folder access was not granted. Please allow access to create the project.");f?.(5,"Scanning folder structure...");const p=ad();f?.(10,"Collecting image files...");const y=dd(await ia(a,(w,E)=>{const D=10+w*.6;f?.(D,E)}),Hs.folderStructure.archiveFolder);f?.(75,"Analyzing photo timestamps...");const x=ap(y);f?.(85,"Saving project data...");const k={projectName:u?.trim()||a.name,rootPath:d||a.name,photos:y,settings:Hs,lastModified:Date.now()};return await oa(p,a),ze.set(`${Js}${p}`,JSON.stringify(cd(k))),f?.(95,"Project initialized successfully"),{projectId:p,photos:y,suggestedDays:x}}async function dp(i){const a=await Vs(i);if(!a)throw new Error("Project folder access not available. Please reselect the folder.");if(!("requestPermission"in a))throw new Error("File System Access API is not available or supported in this environment.");let u;try{u=await a.requestPermission({mode:"read"})}catch(k){throw console.warn("Permission request failed, removing stale handle:",k),await lp(i),new Error("Project folder access has expired. Please click the project again to reselect the folder.")}if(u!=="granted")throw new Error("Folder access was not granted. Please allow access to continue.");const d=ze.get(`${Js}${i}`),f=d?JSON.parse(d):{},h=await ia(a);if(h.length===0)throw new Error("Project folder access is no longer available. Please reselect the folder.");let p=h;if(f.edits){const k=new Map;f.edits.forEach(w=>{w?.filePath&&k.set(w.filePath,w)}),p=h.map(w=>{const E=w.filePath?k.get(w.filePath):null;return E?{...w,day:E.day,bucket:E.bucket,sequence:E.sequence,favorite:E.favorite,rating:E.rating,archived:E.archived,currentName:E.currentName,subfolderOverride:E.subfolderOverride}:w})}const y=f.settings||Hs,x=dd(p,y.folderStructure?.archiveFolder||Hs.folderStructure.archiveFolder);return{projectName:f.projectName||a.name,rootPath:f.rootPath||a.name,photos:x,settings:y,dayLabels:f.dayLabels||{},dayContainers:f.dayContainers||[],lastModified:f.lastModified}}async function fd(i,a){ze.set(`${Js}${i}`,JSON.stringify(cd(a)))}async function fp(i){try{ze.remove(`${Js}${i}`)}catch{}try{const a=await Xs();await new Promise((u,d)=>{const f=a.transaction(Kt,"readwrite");f.objectStore(Kt).delete(i),f.oncomplete=()=>u(),f.onerror=()=>d(f.error)})}catch{}}const kt="narrative:recentProjects",En="narrative:activeProject";function hp({photos:i,setPhotos:a,projectRootPath:u,projectName:d,projectFolderLabel:f,projectSettings:h,dayLabels:p,prevThumbnailsRef:y}){const[x,k]=C.useState([]),[w,E]=C.useState(-1),D=C.useCallback(B=>{if(!u)return;fd(u,{projectName:d,rootPath:f||u,photos:B??i,settings:h,dayLabels:p}).catch(()=>{})},[u,d,f,i,h,p]),A=C.useCallback(B=>{const H=i.map(T=>({id:T.id,filePath:T.filePath,day:T.day,bucket:T.bucket,sequence:T.sequence,favorite:T.favorite,rating:T.rating,archived:T.archived,currentName:T.currentName,originalName:T.originalName,timestamp:T.timestamp,subfolderOverride:T.subfolderOverride})),V=x.slice(0,w+1);V.push(H);const re=V.slice(-30);k(re),E(re.length-1);try{const T=B.map(Q=>Q.thumbnail).filter(Boolean);y.current.forEach(Q=>{if(Q&&!T.includes(Q)&&Q.startsWith("blob:"))try{URL.revokeObjectURL(Q)}catch{}}),y.current=T}catch{}a(B),D(B)},[x,w,i,D,y,a]),U=C.useCallback(()=>{if(w>0){const B=x[w-1],H=i.map(V=>{const re=B.find(T=>T.id===V.id);return re?{...V,...re}:V});E(w-1),a(H),D(H)}},[x,w,D,i,a]),O=C.useCallback(()=>{if(w<x.length-1){const B=x[w+1],H=i.map(V=>{const re=B.find(T=>T.id===V.id);return re?{...V,...re}:V});E(w+1),a(H),D(H)}},[x,w,D,i,a]);return{history:x,historyIndex:w,setHistory:k,setHistoryIndex:E,persistState:D,saveToHistory:A,undo:U,redo:O}}function pp({filteredPhotos:i,coverSelectionMode:a,setCoverForPhotoId:u,setCoverSelectionMode:d}){const[f,h]=C.useState(new Set),[p,y]=C.useState(null),[x,k]=C.useState(null),w=C.useRef(null),E=C.useCallback(()=>{h(new Set),y(null),k(null),w.current=null},[]),D=C.useCallback(async(A,U,O,B=i)=>{if(A.shiftKey&&w.current!==null&&w.current!==void 0){const H=Math.min(w.current,O),V=Math.max(w.current,O),re=B.slice(H,V+1).map(T=>T.id);h(new Set(re)),y(U),k(O),w.current=O;return}if(A.metaKey||A.ctrlKey){const H=new Set(f);H.has(U)?H.delete(U):H.add(U),h(H),y(U),k(O),w.current=O;return}h(new Set([U])),y(U),k(O),w.current=O,a&&(await u(U),d(!1))},[a,i,f,u,d]);return{selectedPhotos:f,setSelectedPhotos:h,focusedPhoto:p,setFocusedPhoto:y,lastSelectedIndex:x,setLastSelectedIndex:k,lastSelectedIndexRef:w,resetSelection:E,handleSelectPhoto:D}}const hl={autoDay:!0,folderStructure:{daysFolder:"01_DAYS",archiveFolder:"98_ARCHIVE",favoritesFolder:"FAV",metaFolder:"_meta"}},mp="narrative:projectState:";function gp({debugEnabled:i,showToast:a,prevThumbnailsRef:u}){const[d,f]=C.useState([]),[h,p]=C.useState("No Project"),[y,x]=C.useState(null),[k,w]=C.useState(null),[E,D]=C.useState(hl),[A,U]=C.useState([]),[O,B]=C.useState(!1),[H,V]=C.useState(()=>!ze.get(En)),[re,T]=C.useState(null),[Q,q]=C.useState(null),[L,Z]=C.useState(null),[J,F]=C.useState(!1),[ce,I]=C.useState(0),[ae,oe]=C.useState("Loading project..."),[ue,se]=C.useState({}),[z,m]=C.useState([]),$=C.useRef(!1),S=C.useCallback(b=>{const le=b.split(/[/\\]/).filter(Boolean);return le[le.length-1]||"Untitled Project"},[]),g=C.useCallback((b,le)=>{if(!le)return b;const ve=new Map;return Object.entries(le).forEach(([ne,me])=>{const je=Number.parseInt(ne,10);Number.isNaN(je)||me.forEach(Pe=>ve.set(Pe,je))}),b.map(ne=>({...ne,day:ve.get(ne.id)??ne.day}))},[]),P=C.useCallback(b=>{try{const le=(b.photos||[]).map(ve=>ve.thumbnail).filter(Boolean);u.current.forEach(ve=>{if(ve&&!le.includes(ve)&&ve.startsWith("blob:"))try{URL.revokeObjectURL(ve)}catch{}}),u.current=le}catch{}f(b.photos||[]),p(b.projectName||"No Project"),w(b.rootPath||null),D(b.settings||hl),se(b.dayLabels||{}),m(b.dayContainers||[])},[u]),W=C.useCallback(b=>{try{const le=ze.get(kt),ne=(le?JSON.parse(le):[]).map(_e=>({..._e,projectId:_e.projectId||_e.rootPath}));let me=ne.findIndex(_e=>_e.projectId===b.projectId);me===-1&&(me=ne.findIndex(_e=>_e.rootPath===b.rootPath));const Pe={...me!==-1?ne[me]:{},...b},xe=ne.filter((_e,Ge)=>Ge!==me),be=[Pe,...xe].slice(0,20);ze.set(kt,JSON.stringify(be)),U(be)}catch(le){if(le instanceof Error&&le.name==="QuotaExceededError")try{const ve=[b,...A].map((ne,me)=>{if(me>=3&&ne.coverUrl){const{coverUrl:je,...Pe}=ne;return Pe}return ne}).slice(0,20);ze.set(kt,JSON.stringify(ve)),U(ve),a("Storage limit reached. Kept covers for 3 most recent projects.","info")}catch{try{const ne=[b,...A.slice(0,9)].map((me,je)=>{if(je>0&&me.coverUrl){const{coverUrl:Pe,...xe}=me;return xe}return me});ze.set(kt,JSON.stringify(ne)),U(ne),a("Storage critically low. Removed older project covers.","error")}catch{try{const me=[{...b,coverUrl:void 0}];ze.set(kt,JSON.stringify(me)),U(me),a("Storage full. Reset to current project only.","error")}catch{ze.remove(kt),U([]),a("Storage exhausted. Unable to save projects.","error")}}}else a("Failed to persist recent project updates. Changes may not be saved.","error")}},[A,a]),Y=C.useCallback((b,le)=>{const ve=new Map;return le.forEach(ne=>ve.set(ne.folderPath||ne.folder,ne)),b.map(ne=>{if(!ne.filePath||ne.isPreOrganized&&ne.day!=null&&ne.bucket!=null)return ne;const me=ne.filePath.split(/[\\/]/),je=me.join("/");if(me.length>1){const xe=me[1].match(/^D(\d{1,2})/i);if(xe){const be=parseInt(xe[1],10);if(!Number.isNaN(be))return{...ne,day:be}}}for(const[Pe,xe]of ve.entries()){if(!xe||xe.skip||xe.detectedDay==null)continue;const be=Pe.split(/[\\/]/).join("/");if(je===be||je.startsWith(`${be}/`))return{...ne,day:xe.detectedDay}}return ne.day!=null?ne:{...ne,day:null}})},[]),te=C.useCallback((b,le)=>{const ve=new Map;return le.forEach((ne,me)=>{const je=Nr(ne);je!=null&&ve.set(ne,je)}),b.map(ne=>{if(!ne.filePath||ne.isPreOrganized&&ne.day!=null)return ne;const me=ne.filePath.split(/[\\/]/),je=me.join("/"),Pe=me[0],xe=ve.get(Pe);if(xe!=null)return{...ne,day:xe};for(const[be,_e]of ve.entries()){const Ge=be.split(/[\\/]/).join("/");if(je===Ge||je.startsWith(`${Ge}/`))return{...ne,day:_e}}if(me.length>1){const _e=me[1].match(/^D(\d{1,2})/i);if(_e){const Ge=parseInt(_e[1],10);if(!Number.isNaN(Ge))return{...ne,day:Ge}}}return ne})},[]),de=C.useCallback(async(b,le)=>{const ve=typeof performance<"u"?performance.now():Date.now();console.log("[Performance] Starting project load:",b),F(!0),I(0),oe("Loading project..."),T(null);try{I(25),oe("Reading project data...");const ne=await dp(b);I(50),oe("Processing photos...");const me=te(ne.photos,ne.dayContainers||[]),je={...ne,photos:me};if(I(75),oe("Initializing view..."),P(je),x(b),B(!1),V(!1),ze.set(En,b),I(90),le?.addRecent!==!1){const _e=ze.get(kt),yt=(_e?JSON.parse(_e):[]).map(Ae=>({...Ae,projectId:Ae.projectId||Ae.rootPath}));let ot=yt.find(Ae=>Ae.projectId===b);ot||(ot=yt.find(Ae=>Ae.rootPath===b));const Ke=ot?.coverUrl;W({projectName:ne.projectName||"Untitled Project",projectId:b,rootPath:ne.rootPath||"Unknown location",lastOpened:Date.now(),totalPhotos:ne.photos?.length||0,...Ke&&{coverUrl:Ke}})}I(100),q(null);const xe=(typeof performance<"u"?performance.now():Date.now())-ve,be=me.length;console.log("[Performance] Project loaded in:",xe.toFixed(2),"ms"),console.log("[Performance] Photo count:",be),be>0&&console.log("[Performance] Time per photo:",(xe/be).toFixed(2),"ms"),xe>5e3&&a("Large project loaded. Performance may be slower.","info")}catch(ne){const me=ne instanceof Error?ne.message:"Failed to load project";console.error("Failed to load project:",ne),T(me),(me.includes("access")&&!me.includes("no longer available")||me.includes("permission")||me.includes("granted"))&&q(b),a(me,"error"),ze.remove(En),V(!0)}finally{F(!1),I(0)}},[te,P,a,W]),Ne=C.useCallback(async()=>{if(Q){F(!0),I(0),oe("Requesting folder access..."),T(null);try{const b=await Vs(Q);if(b){if(I(25),oe("Re-requesting permissions..."),await b.requestPermission({mode:"read"})==="granted"){I(50),oe("Loading project..."),await de(Q,{addRecent:!1}),q(null);return}}else throw new Error("Project folder access is no longer available. Please reselect the folder from the start screen.");throw new Error("Folder access was not granted.")}catch(b){const le=b instanceof Error?b.message:"Failed to retry permission";console.error("Failed to retry permission:",b),T(le),a(le,"error"),V(!0),q(null)}finally{F(!1),I(0)}}},[Q,de,a]),ye=C.useCallback(async(b,le)=>{F(!0),I(0),oe("Initializing project..."),T(null);try{if(le)return I(25),oe("Saving folder access..."),await oa(le,b.dirHandle),I(50),oe("Loading project..."),de(le),!0;I(5),oe("Requesting folder access...");const ve=await cp({dirHandle:b.dirHandle,projectName:b.projectName,rootLabel:b.rootPath,onProgress:(be,_e)=>{const Ge=5+be*.789;I(Ge),oe(_e)}});I(80),oe("Processing photo organization...");const ne=b.mappings?.length?Y(ve.photos,b.mappings):g(ve.photos,ve.suggestedDays),me=(b.mappings||[]).filter(be=>!be.skip).map(be=>be.folderPath||be.folder),je=b.projectName?.trim()||S(b.rootPath);let Pe,xe;if(le){Pe=le,I(80),oe("Loading existing project data...");const be=ze.get(`${mp}${le}`),_e=be?JSON.parse(be):{},Ge=await ia(b.dirHandle);let yt=Ge;if(_e.edits){const ot=new Map;_e.edits.forEach(Ke=>{Ke?.filePath&&ot.set(Ke.filePath,Ke)}),yt=Ge.map(Ke=>{const Ae=Ke.filePath?ot.get(Ke.filePath):null;return Ae?{...Ke,day:Ae.day,bucket:Ae.bucket,sequence:Ae.sequence,favorite:Ae.favorite,rating:Ae.rating,archived:Ae.archived,currentName:Ae.currentName}:Ke})}xe={projectName:_e.projectName||je,rootPath:b.rootPath||b.dirHandle.name,photos:yt,settings:_e.settings||hl,dayContainers:_e.dayContainers||me,dayLabels:_e.dayLabels,lastModified:Date.now()}}else Pe=ve.projectId,xe={projectName:je,rootPath:b.rootPath||b.dirHandle.name,photos:ne,settings:hl,dayContainers:me};return I(90),oe("Saving project state..."),f(ne),p(je),x(Pe),w(b.rootPath||b.dirHandle.name),D(hl),B(!1),V(!1),ze.set(En,Pe),I(95),oe("Updating recent projects..."),W({projectName:je,projectId:Pe,rootPath:b.rootPath||b.dirHandle.name,lastOpened:Date.now(),totalPhotos:ne.length}),I(98),oe("Finalizing project..."),await fd(Pe,xe),V(!1),I(100),q(null),!0}catch(ve){return T(ve instanceof Error?ve.message:"Failed to initialize project"),B(!0),V(!0),!1}finally{F(!1),I(0)}},[Y,g,i,S,de,W]);return C.useEffect(()=>{if($.current)return;$.current=!0;try{const ve=ze.get(kt);if(ve)try{const ne=JSON.parse(ve),me=Array.isArray(ne)?ne.map(xe=>({...xe,projectId:xe.projectId||xe.rootPath})):[],je=new Map;me.forEach(xe=>{xe.projectId&&!je.has(xe.projectId)&&je.set(xe.projectId,xe)});const Pe=Array.from(je.values());JSON.stringify(Pe)!==JSON.stringify(ne)&&ze.set(kt,JSON.stringify(Pe)),console.log("Loaded recent projects:",Pe.map(xe=>({id:xe.projectId,cover:xe.coverUrl?"has cover":"no cover"}))),U(Pe)}catch(ne){console.warn("Failed to parse recent projects from storage",ne),U([])}}catch{U([])}const b=ze.get(En),le=typeof globalThis<"u"&&(globalThis.vitest||globalThis.__APP_VERSION__==="0.0.0");b&&(le||"showDirectoryPicker"in window)?le?V(!1):(async()=>{try{await Vs(b)?de(b):V(!0)}catch(ve){console.warn("Error checking stored handle on startup:",ve),V(!0)}})():V(!0)},[]),{photos:d,setPhotos:f,projectName:h,setProjectName:p,projectRootPath:y,setProjectRootPath:x,projectFolderLabel:k,setProjectFolderLabel:w,projectSettings:E,setProjectSettings:D,recentProjects:A,setRecentProjects:U,showOnboarding:O,setShowOnboarding:B,showWelcome:H,setShowWelcome:V,projectError:re,setProjectError:T,permissionRetryProjectId:Q,setPermissionRetryProjectId:q,projectNeedingReselection:L,setProjectNeedingReselection:Z,loadingProject:J,loadingProgress:ce,loadingMessage:ae,dayLabels:ue,setDayLabels:se,dayContainers:z,setDayContainers:m,loadProject:de,retryProjectPermission:Ne,handleOnboardingComplete:ye,updateRecentProjects:W,applySuggestedDays:g,applyFolderMappings:Y,applyDayContainers:te}}function yp(){const[i,a]=C.useState("folders"),[u,d]=C.useState(!1),[f,h]=C.useState(!1),[p,y]=C.useState(!1),[x,k]=C.useState(null),[w,E]=C.useState(null),[D,A]=C.useState(null),[U,O]=C.useState(null),B=C.useRef({selectedRootFolder:null,selectedDay:null});return{currentView:i,setCurrentView:a,sidebarCollapsed:u,setSidebarCollapsed:d,hideAssigned:f,setHideAssigned:h,showHelp:p,setShowHelp:y,galleryViewPhoto:x,setGalleryViewPhoto:k,fullscreenPhoto:w,setFullscreenPhoto:E,selectedDay:D,setSelectedDay:A,selectedRootFolder:U,setSelectedRootFolder:O,foldersViewStateRef:B}}function vp(){const[i,a]=C.useState(null),u=C.useRef(null),d=C.useCallback(()=>{a(null),u.current&&(window.clearTimeout(u.current),u.current=null)},[]),f=C.useCallback((h,p="info",y)=>{a({message:h,tone:p,actionLabel:y?.actionLabel,onAction:y?.onAction}),u.current&&window.clearTimeout(u.current);const x=y?.durationMs??2500;u.current=window.setTimeout(()=>{a(null),u.current=null},x)},[]);return{toast:i,showToast:f,clearToast:d}}function ra(i,a){return i.sourceRoot?i.sourceRoot:i.ingested!==!1?i.rootPath:wp(a)}function xp(i,a,u){return ra(i,a)}function wp(i){const a=i.filter(p=>p.filePath);if(a.length===0)return"";const d=a[0].filePath.split("/");let f=0;for(let p=0;p<d.length-1;p++){const y=d.slice(0,p+1).join("/");if(a.every(k=>k.filePath?.startsWith(y+"/")))f=p+1;else break}return d.slice(0,Math.max(f,d.length-2)).join("/")||"/"}async function Np(i,a,u,d,f,h){const p=[],y=h.folderStructure.daysFolder,x=h.folderStructure.archiveFolder,k={A:"Establishing",B:"People",C:"Culture-Detail",D:"Action-Moment",E:"Transition",M:"Mood-Food"};for(const w of i){if(!w.filePath||!Sp(w,x,f,y,k))continue;let D="";if(w.archived)D=`${u}/${x}/${w.currentName}`;else if(w.bucket&&w.day!==null){const U=f[w.day]||`Day ${String(w.day).padStart(2,"0")}`,O=k[w.bucket]||w.bucket;D=`${u}/${y}/${U}/${w.bucket}_${O}/${w.currentName}`}else D=`${u}/${w.currentName}`;let A=0;try{w.fileHandle&&(A=(await w.fileHandle.getFile()).size)}catch{}p.push({sourcePath:w.filePath,destinationPath:D,fileSize:A,operation:"copy"})}return{timestamp:Date.now(),operations:p,sourceRoot:a,destinationRoot:u,ingested:d}}function kp(i){const a=[];a.push("#!/bin/bash"),a.push("# Narrative Export Undo Script"),a.push("# This script safely undoes the last export operation"),a.push("set -e"),a.push(""),a.push(`# Export timestamp: ${new Date(i.timestamp).toISOString()}`),a.push(`# Source root: ${i.sourceRoot}`),a.push(`# Destination root: ${i.destinationRoot}`),a.push(`# Ingested: ${i.ingested}`),a.push(""),a.push("RED='\\033[0;31m'"),a.push("GREEN='\\033[0;32m'"),a.push("YELLOW='\\033[1;33m'"),a.push("NC='\\033[0m' # No Color"),a.push(""),a.push('echo "${YELLOW}${NC}"'),a.push('echo "${YELLOW}       UNDO EXPORT - DRY RUN${NC}"'),a.push('echo "${YELLOW}${NC}"'),a.push("echo"),a.push('echo "${YELLOW}This will delete '+i.operations.length+' files created by the export.${NC}"'),a.push('echo "${RED}WARNING: This operation cannot be undone!${NC}"'),a.push("echo"),a.push('echo "${YELLOW}Files to be deleted:${NC}"'),i.operations.forEach((d,f)=>{f<10&&a.push(`echo "  - ${d.destinationPath}"`)}),i.operations.length>10&&a.push(`echo "  ... and ${i.operations.length-10} more files"`),a.push("echo"),a.push('read -r -p "${YELLOW}Type \\"DELETE\\" to confirm deletion (or press Ctrl+C to abort):${NC} " confirm'),a.push('if [ "$confirm" != "DELETE" ]; then'),a.push('  echo "${RED}Aborted - no files were deleted.${NC}"'),a.push("  exit 0"),a.push("fi"),a.push(""),a.push('echo "${GREEN}Starting undo operation...${NC}"'),a.push(""),i.operations.forEach(d=>{a.push("# Delete: "+d.destinationPath),a.push('if [ -f "'+d.destinationPath+'" ]; then'),d.fileSize>0?(a.push('  FILE_SIZE=$(stat -f%z "'+d.destinationPath+'" 2>/dev/null || stat -c%s "'+d.destinationPath+'" 2>/dev/null || echo "0")'),a.push('  if [ "$FILE_SIZE" -eq "'+d.fileSize+'" ]; then'),a.push('    rm "'+d.destinationPath+'"'),a.push('    echo "${GREEN} Deleted: '+d.destinationPath+'${NC}"'),a.push("  else"),a.push('    echo "${RED} Skipped (size mismatch): '+d.destinationPath+'${NC}"'),a.push("  fi")):(a.push('  rm "'+d.destinationPath+'"'),a.push('  echo "${GREEN} Deleted: '+d.destinationPath+'${NC}"')),a.push("else"),a.push('  echo "${YELLOW} File not found: '+d.destinationPath+'${NC}"'),a.push("fi"),a.push("")}),a.push("echo"),a.push('echo "${YELLOW}Cleaning up empty directories...${NC}"');const u=new Set;return i.operations.forEach(d=>{const f=d.destinationPath.substring(0,d.destinationPath.lastIndexOf("/"));u.add(f)}),Array.from(u).sort().reverse().forEach(d=>{a.push('if [ -d "'+d+'" ] && [ -z "$(ls -A "'+d+'")" ]; then'),a.push('  rmdir "'+d+'"'),a.push('  echo "${GREEN} Removed empty directory: '+d+'${NC}"'),a.push("fi")}),a.push(""),a.push("echo"),a.push('echo "${GREEN}${NC}"'),a.push('echo "${GREEN} Undo operation complete!${NC}"'),a.push('echo "${GREEN}${NC}"'),a.join(`
`)}function Sp(i,a,u,d,f){const h=i.originalName!==i.currentName,p=i.bucket&&!i.isPreOrganized,y=i.day!==null&&i.day!==i.detectedDay,x=i.archived&&!i.filePath?.includes(a);let k=!1;if(i.bucket&&i.day!==null){const w=u[i.day]||`Day ${String(i.day).padStart(2,"0")}`,E=f[i.bucket]||i.bucket,D=`${d}/${w}/${i.bucket}_${E}/${i.currentName}`;k=i.filePath!==D&&!i.filePath?.includes(D)}else if(i.archived){const w=`${a}/${i.currentName}`;k=i.filePath!==w&&!i.filePath?.includes(w)}return h||p||y||x||k}function jp(i,a){try{const u=`narrative:exportManifest:${i}`;localStorage.setItem(u,JSON.stringify(a))}catch(u){console.error("Failed to save export manifest:",u)}}function ed(i){try{const a=`narrative:exportManifest:${i}`,u=localStorage.getItem(a);return u?JSON.parse(u):null}catch(a){return console.error("Failed to load export manifest:",a),null}}function Cp(i,a,u,d,f,h){const[p,y]=C.useState(!1),[x,k]=C.useState(""),[w,E]=C.useState("idle"),[D,A]=C.useState(""),[U,O]=C.useState(null),[B,H]=C.useState(!1),[V,re]=C.useState("");C.useEffect(()=>{if(d){const z=ed(d);O(z)}},[d]);const T=C.useCallback(z=>{const m=[],$=u.folderStructure.daysFolder,S=u.folderStructure.archiveFolder,P=ra({rootPath:d||"",ingested:f,sourceRoot:h},i);let W=z||D||P;const Y={A:"Establishing",B:"People",C:"Culture-Detail",D:"Action-Moment",E:"Transition",M:"Mood-Food"},te={},de=[],Ne=[];i.forEach(b=>{const le=b.originalName!==b.currentName,ve=b.bucket&&!b.isPreOrganized,ne=b.day!==null&&b.day!==b.detectedDay,me=b.archived&&!b.filePath?.includes(S);let je=!1;if(b.bucket&&b.day!==null){const xe=a[b.day]||`Day ${String(b.day).padStart(2,"0")}`,be=Y[b.bucket]||b.bucket,_e=`${$}/${xe}/${b.bucket}_${be}/${b.currentName}`;je=b.filePath!==_e&&!b.filePath?.includes(_e)}else if(b.archived){const xe=`${S}/${b.currentName}`;je=b.filePath!==xe&&!b.filePath?.includes(xe)}if(le||ve||ne||me||je)if(b.archived)de.push(b);else if(b.bucket){const xe=b.day;te[xe]||(te[xe]={}),te[xe][b.bucket]||(te[xe][b.bucket]=[]),te[xe][b.bucket].push(b)}else Ne.push(b)}),m.push("#!/bin/bash"),m.push("# Narrative Export Script - Ingest-Aware Export"),m.push("# This script organizes your photos based on ingest state"),m.push("set -e"),m.push(""),m.push("# Ingest mode: INGESTED (photos in project)"),m.push(""),m.push("# Export script with dry-run first, then safe execution with preview and confirmation."),m.push("# NOTE: Only modified/newly organized photos are included - existing organized files are left untouched."),m.push(""),W?(m.push("# Where should organized photos be saved?"),m.push(`read -r -p "Destination folder [${W}]: " USER_PROJECT_ROOT`),m.push(`PROJECT_ROOT="\${USER_PROJECT_ROOT:-${W}}"`)):(m.push("# Where should organized photos be saved?"),m.push('read -r -p "Destination folder: " PROJECT_ROOT'),m.push('if [ -z "$PROJECT_ROOT" ]; then'),m.push('  echo "Error: Destination folder is required"'),m.push("  exit 1"),m.push("fi")),m.push(""),m.push("# Remove quotes if present"),m.push('PROJECT_ROOT="${PROJECT_ROOT//\\\'/}"'),m.push('PROJECT_ROOT="${PROJECT_ROOT//\\"/}"'),m.push(""),m.push("# Create destination folder if needed"),m.push('mkdir -p "$PROJECT_ROOT"'),m.push(""),m.push(`DAYS_FOLDER="${$}"`),m.push(`ARCHIVE_FOLDER="${S}"`),m.push('TARGET_DAYS_DIR="${PROJECT_ROOT}/${DAYS_FOLDER}"'),m.push('TARGET_ARCHIVE_DIR="${PROJECT_ROOT}/${ARCHIVE_FOLDER}"'),m.push(""),m.push("# Color codes for output"),m.push("RED='\\033[0;31m'"),m.push("GREEN='\\033[0;32m'"),m.push("YELLOW='\\033[1;33m'"),m.push("BLUE='\\033[0;34m'"),m.push("NC='\\033[0m' # No Color"),m.push(""),m.push('echo "${BLUE}${NC}"'),m.push('echo "${BLUE}       EXPORT SCRIPT - DRY RUN PREVIEW${NC}"'),m.push('echo "${BLUE}${NC}"'),m.push("echo"),m.push('echo "${YELLOW}Project root:${NC} ${PROJECT_ROOT}"'),m.push('echo "${YELLOW}Target days folder:${NC} ${TARGET_DAYS_DIR}"'),m.push('echo "${YELLOW}Target archive folder:${NC} ${TARGET_ARCHIVE_DIR}"'),m.push("echo"),m.push('echo "${GREEN}This is a DRY RUN - no files will be copied yet.${NC}"'),m.push('echo "${GREEN}You will be asked to confirm before any files are moved.${NC}"'),m.push("echo"),Ne.length>0&&(m.push('echo "${YELLOW}Root files (${NC}'+Ne.length+'):${NC}"'),Ne.forEach(b=>{b.filePath&&m.push(`echo "  cp "\${PROJECT_ROOT}/${b.filePath}"  "${b.currentName}""`)}),m.push(""));let ye=Ne.length+de.length;return Object.keys(te).forEach(b=>{Object.keys(te[parseInt(b)]).forEach(le=>{ye+=te[parseInt(b)][le].length})}),m.push('echo "${YELLOW}Days with organized photos:${NC}"'),Object.keys(te).map(Number).sort((b,le)=>b-le).forEach(b=>{const le=a[b]||`Day ${String(b).padStart(2,"0")}`,ve=te[b],ne=Object.values(ve).reduce((me,je)=>me+je.length,0);m.push(`echo "  ${le} (${ne} photos)"`),Object.keys(ve).sort().forEach(me=>{const je=Y[me]||me,Pe=ve[me];m.push(`echo "     ${me}_${je} (${Pe.length})"`)})}),de.length>0&&m.push('echo "  ${YELLOW}Archive ('+de.length+')${NC}"'),m.push(""),m.push('echo "${YELLOW}Total files to copy:${NC} '+ye+'"'),m.push("echo"),m.push('echo "${YELLOW}${NC}"'),m.push('echo "${YELLOW}Ready to proceed?${NC}"'),m.push('echo "${RED}WARNING: This will copy files to your project directory.${NC}"'),m.push('echo "${YELLOW}${NC}"'),m.push("echo"),m.push('read -r -p "${YELLOW}Type \\"yes\\" to confirm and copy files (or press Ctrl+C to abort):${NC} " confirm'),m.push('if [ "$confirm" != "yes" ]; then'),m.push('  echo "${RED}Aborted - no files were copied.${NC}"'),m.push("  exit 0"),m.push("fi"),m.push(""),m.push('echo "${GREEN}${NC}"'),m.push('echo "${GREEN}Starting file copy operation...${NC}"'),m.push('echo "${GREEN}${NC}"'),m.push("echo"),Ne.length>0&&(Ne.forEach(b=>{b.filePath&&m.push(`if [ -e "${b.currentName}" ]; then echo "Skipping existing: ${b.currentName}"; else cp "\${PROJECT_ROOT}/${b.filePath}" "${b.currentName}"; fi`)}),m.push("")),m.push("# Ingested mode: create day folders with MECE buckets inside"),m.push('mkdir -p "${TARGET_DAYS_DIR}"'),Object.keys(te).map(Number).sort((b,le)=>b-le).forEach(b=>{const le=a[b]||`Day ${String(b).padStart(2,"0")}`,ve=te[b];Object.keys(ve).sort().forEach(ne=>{const me=Y[ne]||ne;let je;je=`${$}/${le}/${ne}_${me}`;const Pe=ve[ne];m.push(`mkdir -p "${je}"`),Pe.forEach(xe=>{xe.filePath&&m.push(`if [ -e "${je}/${xe.currentName}" ]; then echo "Skipping existing: ${je}/${xe.currentName}"; else cp "\${PROJECT_ROOT}/${xe.filePath}" "${je}/${xe.currentName}"; fi`)})})}),de.length>0&&(m.push('mkdir -p "${TARGET_ARCHIVE_DIR}"'),de.forEach(b=>{b.filePath&&m.push(`if [ -e "\${TARGET_ARCHIVE_DIR}/${b.currentName}" ]; then echo "Skipping existing: \${TARGET_ARCHIVE_DIR}/${b.currentName}"; else cp "\${PROJECT_ROOT}/${b.filePath}" "\${TARGET_ARCHIVE_DIR}/${b.currentName}"; fi`)})),m.push(""),m.push('echo "${GREEN}${NC}"'),m.push('echo "${GREEN} Copy operation complete!${NC}"'),m.push('echo "${GREEN}${NC}"'),m.join(`
`)},[i,a,u,d,D,f,h]),Q=C.useCallback(()=>{const z=T();k(z),E("idle"),y(!0)},[T]),q=C.useCallback(()=>{y(!1)},[]),L=C.useCallback(()=>{const z=x||T(),m=new Blob([z],{type:"text/plain"}),$=URL.createObjectURL(m),S=document.createElement("a");S.href=$,S.download="narrative-export.sh",document.body.appendChild(S),S.click(),document.body.removeChild(S),URL.revokeObjectURL($)},[x,T]),Z=C.useCallback(async()=>{const z=x||T();x||k(z);try{if(!navigator?.clipboard?.writeText)throw new Error("Clipboard API unavailable");await navigator.clipboard.writeText(z),E("copied")}catch{E("failed")}},[x,T]),J=C.useCallback(()=>{E("idle")},[]),F=C.useCallback(z=>{A(z);const m=T(z);k(m)},[T]),ce=C.useCallback(()=>{if(D)return D;const z=i.find(m=>m.filePath);if(z?.filePath&&z.folderHierarchy){const m=z.folderHierarchy.join("/"),$=z.filePath;if(m&&$.includes(m)){const S=$.lastIndexOf(m);if(S>0)return $.substring(0,S-1)}}if(z?.filePath){const m=z.filePath.split("/");if(m.length>3)return m.slice(0,-2).join("/")}return""},[i,D]),I=C.useCallback(async()=>{if(!d)return;const z={rootPath:d,ingested:f,sourceRoot:h},m=ra(z,i),$=xp(z,i),S=await Np(i,m,$,f!==!1,a,u);return O(S),jp(d,S),S},[i,a,u,d,f,h]),ae=C.useCallback(()=>{if(!d)return;const z=ed(d);if(!z){console.warn("No export manifest found for this project");return}const m=kp(z);re(m),H(!0)},[d]),oe=C.useCallback(()=>{H(!1)},[]),ue=C.useCallback(()=>{if(!V)return;const z=new Blob([V],{type:"text/plain"}),m=URL.createObjectURL(z),$=document.createElement("a");$.href=m,$.download="narrative-undo-export.sh",document.body.appendChild($),$.click(),document.body.removeChild($),URL.revokeObjectURL(m)},[V]),se=C.useCallback(()=>U!==null,[U]);return{showExportScript:p,exportScriptText:x,exportCopyStatus:w,buildExportScript:T,openExportScriptModal:Q,closeExportScriptModal:q,copyExportScript:Z,downloadExportScript:L,resetExportCopyStatus:J,regenerateScript:F,getDetectedProjectPath:ce,showUndoScript:B,undoScriptText:V,openUndoScriptModal:ae,closeUndoScriptModal:oe,downloadUndoScript:ue,generateManifest:I,hasExportManifest:se}}function Ep(i,a){if(i.timestamp!==a.timestamp)return i.timestamp-a.timestamp;const u=i.filePath||i.originalName||"",d=a.filePath||a.originalName||"",f=u.localeCompare(d);if(f!==0)return f;const h=(i.originalName||"").localeCompare(a.originalName||"");return h!==0?h:i.id.localeCompare(a.id)}function aa(i,a={}){const{groupBy:u,separateVideos:d,selectedDay:f,getSubfolderGroup:h,isVideo:p}=a,y=[...i].sort(Ep);if(u==="subfolder"&&f!=null&&h)return bp(y,f,h,d,p);if(u==="bucket")return Pp(y,d,p);if(u==="day")return _p(y,d,p);if(d&&p){const x=y.filter(w=>!p(w)),k=y.filter(w=>p(w));return Ws([...x,...k])}return Ws(y)}function bp(i,a,u,d,f){const h=new Map;i.forEach(w=>{const E=u(w,a);h.has(E)||h.set(E,[]),h.get(E).push(w)});const p=Array.from(h.entries()).sort(([w],[E])=>w==="Day Root"?-1:E==="Day Root"?1:w.localeCompare(E)).map(([w,E])=>({label:w,photos:E})),y=[],x=[];p.forEach(w=>{const E=y.length;if(d&&f){const D=w.photos.filter(U=>!f(U)),A=w.photos.filter(U=>f(U));y.push(...D,...A)}else y.push(...w.photos);x.push({label:w.label,photos:w.photos,startIndex:E})});const k=new Map;return y.forEach((w,E)=>k.set(w.id,E)),{photos:y,indexMap:k,groups:x}}function Pp(i,a,u){const d=["A","B","C","D","E","M","X",null],f=new Map;i.forEach(p=>{const y=p.bucket||null;f.has(y)||f.set(y,[]),f.get(y).push(p)});const h=[];return d.forEach(p=>{if(!f.has(p))return;const y=f.get(p);if(a&&u){const x=y.filter(w=>!u(w)),k=y.filter(w=>u(w));h.push(...x,...k)}else h.push(...y)}),Ws(h)}function _p(i,a,u){const d=new Map;i.forEach(p=>{const y=p.day??null;d.has(y)||d.set(y,[]),d.get(y).push(p)});const f=Array.from(d.keys()).sort((p,y)=>p===null?1:y===null?-1:p-y),h=[];return f.forEach(p=>{const y=d.get(p);if(a&&u){const x=y.filter(w=>!u(w)),k=y.filter(w=>u(w));h.push(...x,...k)}else h.push(...y)}),Ws(h)}function Ws(i){const a=new Map;return i.forEach((u,d)=>a.set(u.id,d)),{photos:i,indexMap:a}}function Wn(i,a){return a.get(i)??-1}function $t(i,a,u,d){const f=Wn(i,u.indexMap);if(f===-1)return null;const h=a==="next"?1:-1;let p=f+h;if(d){for(;p>=0&&p<u.photos.length;){if(d(u.photos[p]))return u.photos[p];p+=h}return null}return p>=0&&p<u.photos.length?u.photos[p]:null}function Dp(i){const{selectedPhotos:a,focusedPhoto:u,filteredPhotos:d,orderingResult:f,fullscreenPhoto:h,showHelp:p,showExportScript:y,showWelcome:x,showOnboarding:k,coverSelectionMode:w,hideAssigned:E,MECE_BUCKETS:D,onAssignBucket:A,onToggleFavorite:U,onUndo:O,onRedo:B,onSetFocusedPhoto:H,onSetSelectedPhotos:V,onSetLastSelectedIndex:re,onSetFullscreenPhoto:T,onSetShowHelp:Q,onSetCoverSelectionMode:q,onSetHideAssigned:L,onToggleDebugOverlay:Z,onShowToast:J,lastSelectedIndexRef:F}=i;C.useEffect(()=>{const ce=I=>{const ae=I.target;if(x||k||y||ae&&(ae.tagName==="INPUT"||ae.tagName==="TEXTAREA"||ae.tagName==="SELECT"||ae.isContentEditable))return;if(p){(I.key==="Escape"||I.key==="?")&&Q(!1);return}if(w&&I.key==="Escape"){q(!1),J?.("Cover selection cancelled.");return}if(I.key==="?"){Q(!0);return}if(I.key==="H"&&I.shiftKey){I.preventDefault();const g=!E;L(g),J?.(g?"Hiding assigned photos":"Showing all photos","info");return}if(I.key.toLowerCase()==="d"&&I.shiftKey&&(I.ctrlKey||I.metaKey)){I.preventDefault(),Z?.();return}if(I.key==="z"&&(I.metaKey||I.ctrlKey)){I.preventDefault(),I.shiftKey?B():O();return}const oe=u||(a.size>0?Array.from(a)[0]:null);if(!oe)return;const ue=g=>{const P=Wn(g,f.indexMap);H(g),V(new Set([g])),re(P===-1?null:P),F&&(F.current=P===-1?null:P)};if(I.key.toLowerCase()==="f"&&!I.shiftKey&&!I.metaKey&&!I.ctrlKey&&!I.altKey){const g=a.size>0?Array.from(a):[oe];U(g);return}const se=["A","B","C","D","E","M","X"],z=I.key.toUpperCase(),m=se.includes(z),$=z==="F",S=D.some(g=>g.key===z);if(m||S&&!$){I.preventDefault();const g=z;if(a.size>1){const te=Array.from(a);A(te,g),J?.(`Assigned ${te.length} photos to bucket ${g}`,"info"),V(new Set),H(null),re(null),F&&(F.current=null);return}const P=Wn(oe,f.indexMap);if(P===-1)return;const W=f.photos[P];if(!W)return;const Y=W.bucket===g?"":g;if(A([oe],Y),Y&&!I.shiftKey){const te=$t(oe,"next",f);te&&ue(te.id)}return}if(I.key==="ArrowRight"){const g=$t(oe,"next",f);g&&ue(g.id)}else if(I.key==="ArrowLeft"){const g=$t(oe,"prev",f);g&&ue(g.id)}else if(I.key==="j"||I.key==="J"){I.preventDefault();const g=I.shiftKey?W=>!W.bucket:void 0,P=$t(oe,"next",f,g);P&&ue(P.id)}else if(I.key==="k"||I.key==="K"){I.preventDefault();const g=I.shiftKey?W=>!W.bucket:void 0,P=$t(oe,"prev",f,g);P&&ue(P.id)}else I.key==="Enter"||I.key===" "?(I.preventDefault(),T(oe)):I.key==="Escape"&&(h?T(null):(V(new Set),H(null),re(null),F&&(F.current=null)))};return window.addEventListener("keydown",ce),()=>window.removeEventListener("keydown",ce)},[a,u,f,A,U,O,B,p,h,x,k,y,w,E,D,H,V,re,T,Q,q,L,Z,J,F])}function Rp({photos:i,persistState:a,setDayLabels:u}){const[d,f]=C.useState(null),[h,p]=C.useState(""),y=C.useCallback((w,E)=>{f(w),p(E)},[]),x=C.useCallback(w=>{u(E=>({...E,[w]:h})),a(i),f(null)},[h,a,i,u]),k=C.useCallback(()=>{f(null)},[]);return{editingDay:d,editingDayName:h,setEditingDayName:p,startEditingDay:y,saveDayName:x,cancelEditingDay:k}}function Op({photos:i,dayLabels:a,dayContainers:u,projectSettings:d,debugEnabled:f,currentView:h,selectedDay:p,selectedRootFolder:y,hideAssigned:x}){const k=C.useMemo(()=>{const T=new Map;return i.forEach(Q=>{Q.day&&(T.has(Q.day)||T.set(Q.day,[]),T.get(Q.day).push(Q))}),Array.from(T.entries()).sort((Q,q)=>Q[0]-q[0])},[i]),w=C.useMemo(()=>k.filter(([T])=>a[T]!=null),[k,a]),E=C.useCallback(T=>T.split(/[\\/]/).filter(Boolean).join("/"),[]),D=/^(?:day|d)[\s_-]?(\d{1,2})/i,A=C.useCallback((T,Q)=>{const q=(u||[]).includes(T),L=Q.some(ue=>ue.day!==null),Z=Q.some(ue=>{const se=(ue.filePath||ue.originalName||"").split("/");return se.length>1&&/^D\d{1,2}/i.test(se[1])}),J=k.some(([ue])=>(a[ue]||`Day ${String(ue).padStart(2,"0")}`)===T),F=T===d?.folderStructure?.daysFolder,ce=D.test(T)||T.toLowerCase().startsWith("day"),I=L||Z||J||F||ce;let ae=null;if(L){const ue={};Q.forEach(se=>{se.day!=null&&(ue[se.day]=(ue[se.day]||0)+1)}),Object.keys(ue).length&&(ae=Number(Object.entries(ue).sort((se,z)=>z[1]-se[1])[0][0]))}if(ae==null){const ue=T.match(D);if(ue){const se=parseInt(ue[1],10);Number.isNaN(se)||(ae=se)}}const oe=ae!=null?a[ae]||`Day ${String(ae).padStart(2,"0")}`:T;return{isSelected:q,isDayLike:I,dayNumber:ae,displayName:oe}},[u,a,k,d]),U=C.useCallback(T=>{const Q=T.map(([J,F])=>{const ce=A(J,F);return{folder:J,items:F,...ce}}),q=Q.filter(J=>J.isSelected),L=Q.filter(J=>!J.isSelected&&!J.isDayLike),Z=Q.filter(J=>!J.isSelected&&J.isDayLike);return q.sort((J,F)=>(J.dayNumber??999)-(F.dayNumber??999)),L.sort((J,F)=>J.folder.localeCompare(F.folder)),Z.sort((J,F)=>J.folder.localeCompare(F.folder)),{selected:q,nonDay:L,dayLike:Z}},[A]),O=C.useCallback((T,Q)=>{if(Q==null)return"Day Root";const L=E(T.filePath||T.originalName||"").split("/").slice(0,-1),Z=d?.folderStructure?.daysFolder;let J=-1;if(Z){const F=E(Z),ce=L.findIndex(I=>I.toLowerCase()===F.toLowerCase());if(ce!==-1&&ce+1<L.length){const I=L[ce+1];Nr(I)===Q&&(J=ce+1)}}return J===-1&&(J=L.findIndex(F=>Z&&F.toLowerCase()===Z.toLowerCase()?!1:Nr(F)===Q)),J!==-1&&J+1<L.length?L[J+1]:"Day Root"},[E,d]),B=C.useCallback((T,Q)=>T.subfolderOverride!==void 0?T.subfolderOverride??"Day Root":O(T,Q),[O]),H=C.useMemo(()=>{const T=new Map;for(const Q of i){if(Q.archived)continue;const q=(Q.filePath||Q.originalName||"").split(/[\\/]/),L=q.length>1?q[0]:"(root)";T.has(L)||T.set(L,[]),T.get(L).push(Q)}return Array.from(T.entries()).sort((Q,q)=>Q[0].localeCompare(q[0]))},[i]),V=C.useMemo(()=>{const T=new Map(H);return(u||[]).forEach(Q=>{const q=E(Q).split("/")[0];T.has(q)||T.set(q,[])}),Array.from(T.entries())},[H,u,E]);C.useEffect(()=>{},[f,k,a,i,u,d,H,A]);const re=C.useMemo(()=>{const T=L=>!!L.bucket||L.isPreOrganized&&!!L.detectedBucket,Q=L=>!x||!T(L)&&!L.archived;let q=[];switch(h){case"days":if(p!==null){q=i.filter(L=>!L.archived&&L.day===p).filter(Q);break}q=i.filter(L=>L.day!==null&&!L.archived).filter(Q);break;case"folders":if(y!==null){q=i.filter(L=>{if(L.archived)return!1;const Z=E(L.filePath||L.originalName||""),J=E(y),F=Z.split("/")[0]||"(root)";return(J.includes("/")?Z===J||Z.startsWith(`${J}/`):F===J)&&Q(L)});break}if(p!==null){q=i.filter(L=>!L.archived&&L.day===p).filter(Q);break}q=[];break;case"root":if(y!==null){q=i.filter(L=>!L.archived&&(E(L.filePath||L.originalName||"").split("/")[0]||"(root)")===E(y)&&Q(L));break}q=[];break;case"favorites":q=i.filter(L=>L.favorite&&!L.archived).filter(Q);break;case"archive":q=i.filter(L=>L.archived).filter(Q);break;case"review":q=i.filter(L=>L.bucket&&!L.archived).filter(Q);break;default:q=i.filter(Q);break}return aa(q).photos},[i,x,h,p,y,E]);return{days:k,visibleDays:w,normalizePath:E,categorizeFolder:A,sortFolders:U,getDerivedSubfolderGroup:O,getSubfolderGroup:B,rootGroups:H,displayRootGroups:V,filteredPhotos:re}}function Tp({photos:i,projectRootPath:a,projectName:u,projectFolderLabel:d,setRecentProjects:f,showToast:h}){return{setCoverForPhotoId:C.useCallback(async y=>{if(!a)return;const x=i.find(k=>k.id===y);if(!x){h("Selected photo is no longer available.","error");return}try{let k;if(x.fileHandle)k=await x.fileHandle.getFile();else if(x.thumbnail)k=await(await fetch(x.thumbnail)).blob();else{h("Cannot create cover from this photo.","error");return}const w=`original (${(k.size/1024).toFixed(1)}KB)`;await Lh(10);const E=await _h(a,k,0,0),D=ze.get(kt),U=(D?JSON.parse(D):[]).map(H=>({...H,projectId:H.projectId||H.rootPath}));let O=U.findIndex(H=>H.projectId===a);O===-1&&(O=U.findIndex(H=>H.rootPath===a));const B=U.map((H,V)=>V===O?{...H,coverKey:E,lastOpened:Date.now()}:H);O===-1&&B.unshift({projectName:u||"Untitled Project",projectId:a,rootPath:d||a,lastOpened:Date.now(),totalPhotos:i.length,coverKey:E}),ze.set(kt,JSON.stringify(B.slice(0,20))),f(B.slice(0,20)),console.log(`Cover saved to IndexedDB (${w}):`,a),h("Cover photo updated.")}catch(k){console.error("Failed to set cover photo:",k),h("Failed to set cover photo.","error")}},[i,a,u,d,f,h])}}function Lp({photos:i,saveToHistory:a,selectedDay:u}){const d=C.useCallback((p,y,x=null)=>{const k=Array.isArray(p)?p:[p],w={},E=i.map(D=>{if(!k.includes(D.id))return D;if(!y)return{...D,bucket:null,sequence:null,archived:!1,currentName:D.originalName};const A=x||D.day||u||Math.ceil(new Date(D.timestamp).getDate()/1),U=`${A}_${y}`,O=i.filter(V=>V.day===A&&V.bucket===y).length,B=(w[U]||O)+1;w[U]=B;const H=y==="X"?D.originalName:`D${String(A).padStart(2,"0")}_${y}_${String(B).padStart(3,"0")}__${D.originalName}`;return{...D,bucket:y,day:A,sequence:B,currentName:H,archived:y==="X"}});a(E)},[i,a,u]),f=C.useCallback(p=>{const y=Array.isArray(p)?p:[p],x=i.map(k=>y.includes(k.id)?{...k,day:null}:k);a(x)},[i,a]),h=C.useCallback(p=>{const y=Array.isArray(p)?p:[p],x=i.map(k=>y.includes(k.id)?{...k,favorite:!k.favorite}:k);a(x)},[i,a]);return{assignBucket:d,removeDayAssignment:f,toggleFavorite:h}}function zp({projectRootPath:i,photosLength:a,selectedRootFolder:u,selectedDay:d,currentView:f,days:h,rootGroups:p,setSelectedDay:y,setSelectedRootFolder:x}){C.useEffect(()=>{if(!i||a===0||u!==null||d!==null||f!=="folders")return;const k=h[0]?.[0]??null;if(k!==null){y(k);return}const w=p[0]?.[0];w&&x(w)},[i,a,u,d,f,p,h,y,x])}function Ip({projectRootPath:i,selectedPhotos:a,showToast:u,setCoverForPhotoId:d}){return{setCoverFromSelection:C.useCallback(async()=>{if(!i)return;if(a.size===0){u("Select a photo to set as cover.");return}if(a.size>1){u("Select a single photo to set as cover.");return}const h=Array.from(a)[0];await d(h)},[i,a,u,d])}}function Mp({handleOnboardingCompleteInternal:i,setHistory:a,setHistoryIndex:u,resetSelection:d,setSelectedDay:f,setSelectedRootFolder:h,setCurrentView:p}){return{handleOnboardingComplete:C.useCallback(async(x,k)=>{await i(x,k)&&(a([]),u(-1),d(),f(null),h(null),p("folders"))},[i,d,p,a,u,f,h])}}function $p({showWelcome:i,projectName:a,stats:u,currentVersion:d,coverSelectionMode:f,selectedPhotosCount:h,projectRootPath:p,currentView:y,hideAssigned:x,recentProjects:k,projectError:w,permissionRetryProjectId:E,loadingProject:D,hasExportManifest:A,onMainMenu:U,onStartCoverSelection:O,onUseCoverSelection:B,onCancelCoverSelection:H,onSelectRecentProject:V,onOpenProject:re,onDeleteProject:T,onImportTrip:Q,onExportScript:q,onUndoExport:L,onShowHelp:Z,onRetryPermission:J,onChangeView:F,onToggleHideAssigned:ce,onRememberFoldersViewState:I,onRestoreFoldersViewState:ae,onClearDaySelection:oe}){const[ue,se]=C.useState(!1);return i?null:o.jsxs("header",{className:"border-b border-gray-800 bg-gray-900",children:[o.jsxs("div",{className:"flex items-center justify-between px-6 py-3",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("img",{src:"/Narrative/assets/Narrative_icon.png",alt:"Narrative",className:"w-8 h-8 rounded"}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-lg font-semibold text-gray-100",children:a}),o.jsxs("p",{className:"text-xs text-gray-400",children:[u.sorted," sorted  ",u.root," root  ",u.favorites," favorites"]})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-xs text-gray-500",children:d}),o.jsx("button",{onClick:()=>{se(!1),U()},className:"px-3 py-1 bg-gray-800 hover:bg-gray-700 rounded text-sm font-medium",title:"Back to the main menu",children:"Main Menu"}),p&&o.jsx("button",{onClick:O,className:`px-3 py-1 rounded text-sm font-medium ${f?"bg-yellow-200 text-yellow-900":"bg-gray-800 hover:bg-gray-700 text-gray-100"}`,title:"Set cover from selected photo",children:f?"Selecting":"Set Cover"}),f&&o.jsxs("div",{className:"px-3 py-1 bg-yellow-50 text-yellow-900 rounded text-sm flex items-center gap-3",children:[o.jsx("span",{children:"Select a photo to set as cover"}),h===1&&o.jsx("button",{onClick:B,className:"underline",children:"Use selection"}),o.jsx("button",{onClick:H,className:"underline",children:"Cancel"})]}),o.jsxs("div",{className:"relative",children:[o.jsxs("button",{onClick:()=>se(z=>!z),className:"px-3 py-1 bg-gray-800 hover:bg-gray-700 rounded text-sm font-medium flex items-center gap-1",title:"Open recent projects","aria-expanded":ue,children:["Projects",o.jsx(rd,{className:"w-4 h-4"})]}),ue&&o.jsxs("div",{className:"absolute right-0 mt-2 w-72 rounded-lg border border-gray-800 bg-gray-900 shadow-xl z-20",children:[o.jsx("div",{className:"px-3 py-2 text-xs uppercase tracking-wide text-gray-400 border-b border-gray-800",children:"Recent Projects"}),k.length===0?o.jsx("div",{className:"px-3 py-3 text-sm text-gray-400",children:"No recent projects yet."}):o.jsx("div",{className:"max-h-64 overflow-y-auto",children:k.map(z=>o.jsxs("button",{onClick:()=>{se(!1),V(z.projectId)},className:"w-full text-left px-3 py-2 hover:bg-gray-800",children:[o.jsx("div",{className:"text-sm text-gray-100",children:z.projectName}),o.jsx("div",{className:"text-xs text-gray-500 truncate",children:z.rootPath})]},z.projectId))}),o.jsx("div",{className:"border-t border-gray-800",children:o.jsx("button",{onClick:()=>{se(!1),re()},className:"w-full text-left px-3 py-2 text-sm text-blue-300 hover:bg-gray-800",children:"Open Project"})})]})]}),p&&o.jsx("button",{onClick:T,className:"px-3 py-1 bg-red-700 hover:bg-red-800 rounded text-sm font-medium",title:"Delete project",children:"Delete"}),o.jsxs("button",{onClick:Q,className:"px-3 py-1 bg-blue-600 hover:bg-blue-700 rounded text-sm font-medium flex items-center gap-1",title:"Import existing trip folder",disabled:D,children:[D?o.jsx(Qs,{className:"w-4 h-4 animate-spin"}):o.jsx(sa,{className:"w-4 h-4"}),"Import Trip"]}),o.jsx("button",{onClick:q,className:"px-3 py-1 bg-gray-800 hover:bg-gray-700 rounded text-sm font-medium",title:"Export rename script",disabled:u.total===0,children:"Export Script"}),A&&L&&o.jsx("button",{onClick:L,className:"px-3 py-1 bg-yellow-800 hover:bg-yellow-700 rounded text-sm font-medium",title:"Undo last export",children:"Undo Export"}),o.jsx("button",{onClick:Z,className:"p-2 hover:bg-gray-800 rounded",title:"Show shortcuts (?)",children:"?"})]})]}),o.jsx("div",{className:"flex gap-1 px-6 pb-2",children:[{id:"folders",label:"Folders",count:u.root},{id:"favorites",label:"Favorites",count:u.favorites},{id:"archive",label:"Archive",count:u.archived},{id:"review",label:"Review",count:u.sorted}].map(z=>o.jsxs("button",{onClick:()=>{y==="folders"&&I(),F(z.id),z.id==="folders"?ae():oe()},className:`px-4 py-2 rounded-t text-sm font-medium transition-colors ${y===z.id?"bg-gray-950 text-blue-400":"text-gray-400 hover:text-gray-200"}`,children:[z.label," ",z.count>0&&o.jsxs("span",{className:"text-xs opacity-60",children:["(",z.count,")"]})]},z.id))}),o.jsxs("div",{className:"flex flex-wrap items-center gap-2 px-6 pb-3",children:[x&&o.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-blue-600/20 border border-blue-500/30 rounded-lg",children:[o.jsx("span",{className:"text-xs text-blue-300",children:"Skip Assigned: ON"}),o.jsx("kbd",{className:"text-xs text-blue-200",children:"Shift+H to toggle"})]}),o.jsx("button",{onClick:ce,className:`px-3 py-1.5 rounded text-sm font-medium transition-colors ${x?"bg-blue-600 text-white":"bg-gray-800 text-gray-300 hover:bg-gray-700"}`,children:x?"Show All":"Hide Assigned"})]}),w&&o.jsx("div",{className:"mx-6 mb-3 rounded-lg border border-red-800 bg-red-950/60 px-4 py-3",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-red-200",children:w}),E&&o.jsx("button",{onClick:J,className:"ml-3 px-3 py-1 bg-red-700 hover:bg-red-600 text-white text-xs rounded transition-colors",children:"Try Again"})]})})]})}function Fp({currentView:i,sidebarCollapsed:a,onCollapseSidebar:u,onExpandSidebar:d,visibleDays:f,selectedDay:h,selectedRootFolder:p,onSelectDay:y,onSelectRootFolder:x,editingDay:k,editingDayName:w,onChangeEditingDayName:E,onStartEditingDay:D,onSaveDayName:A,onCancelEditingDay:U,onClearSelectedDay:O,days:B,dayLabels:H,dayContainers:V,photos:re,normalizePath:T,rootGroups:Q,displayRootGroups:q,sortFolders:L,projectSettings:Z,debugEnabled:J}){return i==="days"&&a?o.jsx("button",{onClick:d,className:"w-12 border-r border-gray-800 bg-gray-900 flex items-center justify-center hover:bg-gray-800 transition-colors","aria-label":"Expand sidebar",title:"Expand sidebar",children:o.jsx(Fs,{className:"w-4 h-4 text-gray-400 rotate-180"})}):i==="days"?o.jsx("aside",{className:"w-48 border-r border-gray-800 bg-gray-900 overflow-y-auto",children:o.jsxs("div",{className:"p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h3",{className:"text-xs font-semibold text-gray-400 uppercase",children:"Days"}),o.jsx("button",{onClick:u,className:"p-1 hover:bg-gray-800 rounded","aria-label":"Collapse sidebar",title:"Collapse sidebar",children:o.jsx(Fs,{className:"w-4 h-4 text-gray-400"})})]}),o.jsx("div",{className:"space-y-1",children:f.map(([F,ce])=>o.jsxs("div",{role:"button",tabIndex:0,onClick:()=>{x(null),y(F)},onKeyDown:I=>{I.key==="Enter"&&(x(null),y(F))},className:`w-full text-left px-3 py-2 rounded text-sm transition-colors ${h===F?"bg-blue-600 text-white":"hover:bg-gray-800 text-gray-300"}`,children:[o.jsx("div",{className:"flex items-center justify-between",children:k===F?o.jsxs("div",{className:"flex items-center gap-2 w-full",children:[o.jsx("input",{value:w,onChange:I=>E(I.target.value),className:"w-full px-2 py-1 rounded bg-gray-800 text-sm text-gray-100"}),o.jsx("button",{onClick:I=>{I.stopPropagation(),A(F)},className:"p-1 bg-green-600 rounded","aria-label":"Save day name",children:o.jsx(Ji,{className:"w-4 h-4"})}),o.jsx("button",{onClick:I=>{I.stopPropagation(),U()},className:"p-1 bg-gray-800 rounded","aria-label":"Cancel",children:o.jsx(Wt,{className:"w-4 h-4"})})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"font-medium",children:H[F]||`Day ${String(F).padStart(2,"0")}`}),o.jsxs("div",{className:"flex items-center gap-2",children:[h===F&&o.jsx("button",{onClick:I=>{I.stopPropagation(),O()},className:"px-2 py-0.5 rounded bg-gray-800 text-xs text-gray-300 hover:text-white","aria-label":"Clear day selection",title:"Clear day selection",children:"Clear"}),o.jsx("button",{onClick:I=>{I.stopPropagation(),D(F,H[F]||`Day ${String(F).padStart(2,"0")}`)},className:"p-1","aria-label":`Edit day ${F}`,children:o.jsx(Yi,{className:"w-4 h-4 text-gray-400"})})]})]})}),o.jsxs("div",{className:"text-xs opacity-70",children:[ce.length," photos"]})]},F))})]})}):i!=="folders"?null:o.jsx("aside",{className:"w-48 border-r border-gray-800 bg-gray-900 overflow-y-auto",children:o.jsxs("div",{className:"p-4",children:[o.jsx("h3",{className:"text-xs font-semibold text-gray-400 uppercase mb-3",children:"Days"}),o.jsx("div",{className:"space-y-1 mb-4",children:(()=>{const F=new Map,ce=V||[],I=[],ae=[];ce.forEach(S=>{const g=T(S);g.includes("/")?ae.push(g):I.push(g)});const oe=S=>{const g=T(S);return re.filter(P=>{const W=T(P.filePath||P.originalName||"");return W===g||W.startsWith(`${g}/`)})};B.forEach(([S,g])=>{F.has(S)||F.set(S,{dayNumber:S,photos:g,folderName:null})}),ae.forEach(S=>{const g=S.split("/").slice(-1)[0],P=Nr(g);P==null||F.has(P)||F.set(P,{dayNumber:P,photos:oe(S),folderName:S})});const ue=Z?.folderStructure?.daysFolder;if(ue){const S=T(ue),g=new Map;re.forEach(P=>{const Y=T(P.filePath||P.originalName||"").split("/");if(Y.length<2||Y[0]!==S)return;const te=Nr(Y[1]);te!=null&&(g.has(te)||g.set(te,[]),g.get(te).push(P))}),g.forEach((P,W)=>{F.has(W)||F.set(W,{dayNumber:W,photos:P,folderName:`${S}/${H[W]||`Day ${String(W).padStart(2,"0")}`}`})})}const se=L(q),z=[...se.selected,...se.nonDay,...se.dayLike];J&&console.debug("[PhotoOrganizer] Folder categorization:",{selected:se.selected.map(S=>S.folder),nonDay:se.nonDay.map(S=>S.folder),dayLike:se.dayLike.map(S=>S.folder)}),Q.forEach(([S,g])=>{const P=z.find(W=>W.folder===S);if(P&&P.isDayLike&&P.dayNumber!==null&&!F.has(P.dayNumber)){const W=g.filter(Y=>Y.day===P.dayNumber||Y.day===null);F.set(P.dayNumber,{dayNumber:P.dayNumber,photos:W,folderName:S})}});const m=Array.from(F.values()).sort((S,g)=>S.dayNumber-g.dayNumber),$=I.filter(S=>z.find(P=>P.folder===S)?.dayNumber===null);return o.jsxs(o.Fragment,{children:[m.map(S=>o.jsxs("div",{role:"button",tabIndex:0,onClick:()=>{x(null),y(S.dayNumber)},onKeyDown:g=>{g.key==="Enter"&&(x(null),y(S.dayNumber))},className:`w-full text-left px-3 py-2 rounded text-sm transition-colors ${h===S.dayNumber?"bg-blue-600 text-white":"hover:bg-gray-800 text-gray-300"}`,children:[o.jsx("div",{className:"flex items-center justify-between",children:k===S.dayNumber?o.jsxs("div",{className:"flex items-center gap-2 w-full",children:[o.jsx("input",{value:w,onChange:g=>E(g.target.value),className:"w-full px-2 py-1 rounded bg-gray-800 text-sm text-gray-100"}),o.jsx("button",{onClick:g=>{g.stopPropagation(),A(S.dayNumber)},className:"p-1 bg-green-600 rounded","aria-label":"Save day name",children:o.jsx(Ji,{className:"w-4 h-4"})}),o.jsx("button",{onClick:g=>{g.stopPropagation(),U()},className:"p-1 bg-gray-800 rounded","aria-label":"Cancel",children:o.jsx(Wt,{className:"w-4 h-4"})})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"font-medium",children:H[S.dayNumber]||`Day ${String(S.dayNumber).padStart(2,"0")}`}),o.jsx("div",{className:"flex items-center gap-2",children:o.jsx("button",{onClick:g=>{g.stopPropagation(),D(S.dayNumber,H[S.dayNumber]||`Day ${String(S.dayNumber).padStart(2,"0")}`)},className:"p-1","aria-label":`Edit day ${S.dayNumber}`,children:o.jsx(Yi,{className:"w-4 h-4 text-gray-400"})})})]})}),o.jsxs("div",{className:"text-xs opacity-70",children:[S.photos.length," photos"]})]},`day-${S.dayNumber}`)),$.map(S=>o.jsxs("div",{role:"button",tabIndex:0,onClick:()=>{x(S),y(null)},className:`w-full text-left px-3 py-2 rounded text-sm transition-colors ${p===S?"bg-blue-600 text-white":"hover:bg-gray-800 text-gray-300"}`,children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("div",{className:"font-medium",children:S}),o.jsx("div",{className:"text-xs px-2 py-0.5 rounded bg-gray-700 text-gray-300",children:"Container"})]}),o.jsxs("div",{className:"text-xs opacity-70",children:[Q.find(([g])=>g===S)?.[1].length||0," photos"]})]},`container-${S}`))]})})()}),o.jsx("h3",{className:"text-xs font-semibold text-gray-400 uppercase mb-3",children:"Other"}),o.jsx("div",{className:"space-y-1",children:(()=>{const{selected:F,nonDay:ce}=L(q),I=Z?.folderStructure?.daysFolder,ae=[];if(I){const ue=T(I),se=new Map;re.forEach(z=>{if(z.archived)return;const $=T(z.filePath||z.originalName||"").split("/");if($.length<3||$[0]!==ue||Nr($[1])!=null)return;const g=$[1],P=`${ue}/${g}`;se.has(P)||se.set(P,[]),se.get(P).push(z)}),se.forEach((z,m)=>{ae.push({key:m,label:m,items:z})})}const oe=[...ce.map(ue=>({key:ue.folder,label:ue.folder,items:ue.items})),...ae];return o.jsxs(o.Fragment,{children:[oe.map(ue=>o.jsxs("div",{role:"button",tabIndex:0,onClick:()=>{x(ue.key),y(null)},className:`w-full text-left px-3 py-2 rounded text-sm transition-colors ${p===ue.key?"bg-blue-600 text-white":"hover:bg-gray-800 text-gray-300"}`,children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("div",{className:"font-medium",children:ue.label}),o.jsx("div",{className:"flex gap-2"})]}),o.jsxs("div",{className:"text-xs opacity-70",children:[ue.items.length," photos (",ue.items.filter(se=>se.day===null).length," ","unsorted)"]})]},ue.key)),oe.length===0&&o.jsx("div",{className:"text-xs text-gray-400",children:"No other folders"})]})})()})]})})}const Ap=async i=>{try{const a=await i.getFile();return new Promise(u=>{const d=document.createElement("video"),f=document.createElement("canvas"),h=f.getContext("2d"),p=()=>{f.width=d.videoWidth,f.height=d.videoHeight,d.currentTime=0},y=()=>{if(h){h.drawImage(d,0,0);const x=f.toDataURL("image/jpeg",.8);d.removeEventListener("loadedmetadata",p),d.removeEventListener("seeked",y),u(x)}};d.addEventListener("loadedmetadata",p),d.addEventListener("seeked",y),d.src=URL.createObjectURL(a),d.load(),setTimeout(()=>{d.removeEventListener("loadedmetadata",p),d.removeEventListener("seeked",y),u(null)},2e3)})}catch(a){return console.error("Failed to generate video thumbnail:",a),null}},Up=({photos:i,currentPhotoId:a,onSelectPhoto:u,visibleCount:d=7})=>{const f=C.useRef(null),h=C.useRef(null),[p,y]=C.useState({});C.useEffect(()=>{(async()=>{const B=i.filter(H=>H.mimeType?.startsWith("video/")&&!p[H.id]);for(const H of B)if(H.fileHandle){const V=await Ap(H.fileHandle);y(re=>({...re,[H.id]:V}))}})()},[i]),C.useEffect(()=>{if(h.current&&f.current){const O=f.current,B=h.current,H=O.getBoundingClientRect(),V=B.getBoundingClientRect();(V.left<H.left||V.right>H.right)&&B.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})}},[a]);const x=O=>{if(f.current){const B=f.current.clientWidth*.7;f.current.scrollBy({left:O==="right"?B:-B,behavior:"smooth"})}},k=i.findIndex(O=>O.id===a),w=k>0,E=k<i.length-1,D=i.filter(O=>!O.mimeType?.startsWith("video/")),A=i.filter(O=>O.mimeType?.startsWith("video/")),U=(O,B)=>{const H=O.id===a,V=O.bucket?{A:"bg-blue-500",B:"bg-purple-500",C:"bg-green-500",D:"bg-orange-500",E:"bg-yellow-500",M:"bg-indigo-500",X:"bg-gray-500"}[O.bucket]||"bg-gray-500":null,re=O.mimeType?.startsWith("video/")&&p[O.id]||O.thumbnail;return o.jsxs("button",{ref:H?h:null,onClick:()=>u(O.id),className:`relative flex-shrink-0 group ${H?"ring-4 ring-blue-500 shadow-xl scale-110":"hover:ring-2 hover:ring-gray-600"} transition-all duration-200 rounded-lg overflow-hidden`,style:{width:"120px",height:"90px"},"aria-label":`${O.currentName}${H?" (current)":""}`,"aria-current":H?"true":void 0,children:[re?o.jsx("img",{src:re,alt:O.currentName,className:"w-full h-full object-cover"}):o.jsx("div",{className:"w-full h-full bg-gray-800 flex items-center justify-center",children:o.jsx("span",{className:"text-xs text-gray-500 text-center px-2 break-words",children:O.currentName})}),O.mimeType?.startsWith("video/")&&o.jsx("div",{className:"absolute top-1 left-1 bg-black/70 rounded p-1",children:o.jsx(gh,{className:"w-3 h-3 text-white"})}),V&&o.jsx("div",{className:`absolute top-1 right-1 ${V} text-white text-xs font-bold rounded px-1.5 py-0.5 shadow-lg`,children:O.bucket}),O.favorite&&o.jsx("div",{className:"absolute bottom-1 right-1 bg-yellow-500 text-white text-xs rounded-full p-1",children:o.jsx("svg",{className:"w-3 h-3 fill-current",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:o.jsx("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})})}),!H&&o.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:o.jsxs("span",{className:"text-white text-xs font-medium",children:["#",B+1]})}),H&&o.jsx("div",{className:"absolute inset-0 pointer-events-none",children:o.jsx("div",{className:"absolute inset-0 bg-blue-500/10"})})]},O.id)};return o.jsxs("div",{className:"relative bg-gray-900 border-t border-gray-800",children:[w&&o.jsx("button",{onClick:()=>x("left"),className:"absolute left-2 top-1/2 -translate-y-1/2 z-10 p-2 bg-gray-950/80 hover:bg-gray-800 rounded-lg text-gray-300 hover:text-white transition-colors shadow-lg","aria-label":"Scroll left",children:o.jsx(Fs,{className:"w-5 h-5"})}),o.jsxs("div",{ref:f,className:"flex items-center gap-3 px-12 py-4 overflow-x-auto scrollbar-thin scrollbar-thumb-gray-700 scrollbar-track-gray-900",style:{scrollbarWidth:"thin"},children:[D.length>0&&o.jsxs(o.Fragment,{children:[D.map((O,B)=>U(O,B)),A.length>0&&o.jsx("div",{className:"h-20 border-l border-gray-700 mx-2"})]}),A.length>0&&o.jsx("div",{className:"flex gap-3",children:A.map((O,B)=>{const H=i.findIndex(V=>V.id===O.id);return U(O,H)})})]}),E&&o.jsx("button",{onClick:()=>x("right"),className:"absolute right-2 top-1/2 -translate-y-1/2 z-10 p-2 bg-gray-950/80 hover:bg-gray-800 rounded-lg text-gray-300 hover:text-white transition-colors shadow-lg","aria-label":"Scroll right",children:o.jsx(ld,{className:"w-5 h-5"})}),o.jsxs("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 bg-gray-950/80 px-3 py-1 rounded-full text-xs text-gray-300",children:[k+1," / ",i.length]})]})},Bp=({photo:i,filteredPhotos:a,orderingResult:u,onClose:d,onNavigate:f,onToggleFavorite:h,onAssignBucket:p,onAssignDay:y,selectedBucket:x,selectedDay:k,buckets:w,dayLabels:E={},onShowToast:D})=>{const[A,U]=C.useState(Wn(i.id,u.indexMap)),[O,B]=C.useState(null),[H,V]=C.useState(!1),[re,T]=C.useState(null),[Q,q]=C.useState(!0),[L,Z]=C.useState(!0),J=C.useRef(null);C.useEffect(()=>{const m=Wn(i.id,u.indexMap);m!==-1&&m!==A&&U(m)},[u.indexMap,i.id,A]);const F=u.photos[A]||i,ce=C.useCallback(m=>!m.bucket&&!m.archived,[]),I=u.photos.filter(ce).length,ae=I;C.useEffect(()=>(T(null),(async()=>{O&&(F.fileHandle&&J.current===O||!F.fileHandle&&F.thumbnail===O)||(V(!0),J.current=null);try{if(F.fileHandle){const S=await F.fileHandle.getFile(),g=URL.createObjectURL(S);J.current=g,B(g)}else F.thumbnail?B(F.thumbnail):T("No image data available")}catch(S){console.error("Failed to load full resolution image:",S),F.thumbnail?B(F.thumbnail):T("Failed to load image")}finally{V(!1)}})(),()=>{if(J.current&&J.current.startsWith("blob:"))try{URL.revokeObjectURL(J.current)}catch{}}),[F.id,F.fileHandle,F.thumbnail]),C.useEffect(()=>{const $=setTimeout(async()=>{const S=Math.min(A+1,u.photos.length-1),g=Math.max(A-1,0),P=[S,g].filter(W=>W!==A);for(const W of P){const Y=u.photos[W];if(Y?.fileHandle)try{await Y.fileHandle.getFile()}catch{}}},100);return()=>clearTimeout($)},[A,a]);const oe=C.useCallback(m=>{const $=$t(F.id,m,u);if(!$)return;const S=Wn($.id,u.indexMap);S!==-1&&(U(S),f($.id))},[F.id,u,f]),ue=C.useCallback(m=>{const $=Wn(m,u.indexMap);$!==-1&&$!==A&&(U($),f(m))},[u.indexMap,A,f]),se=C.useCallback(m=>{const $=u.photos[A];if($)if(m.key==="Escape")m.preventDefault(),d();else if(m.key==="ArrowRight")m.preventDefault(),oe("next");else if(m.key==="ArrowLeft")m.preventDefault(),oe("prev");else if(m.key===" "||m.key.toLowerCase()==="n"){m.preventDefault();const S=$t($.id,"next",u,ce);S?(f(S.id),D?.(`${Math.max(ae-1,0)} unassigned remaining`,"info",{durationMs:1e3})):D?.("No more unassigned photos","info")}else if(m.key==="f"||m.key==="F")m.preventDefault(),h($.id);else if(m.key.toLowerCase()==="x")m.preventDefault(),p($.id,"X");else{const S=m.key.toUpperCase();if(["A","B","C","D","E","M"].includes(S)){m.preventDefault();const P=$.bucket===S?"":S;if(p($.id,P),P){const W=$t($.id,"next",u,ce);W&&f(W.id)}}}},[A,u,d,oe,h,p,ae,ce,f,D]);C.useEffect(()=>(window.addEventListener("keydown",se),()=>window.removeEventListener("keydown",se)),[se]);const z=w.find(m=>m.key===F.bucket);return o.jsxs("div",{className:"fixed inset-0 bg-black z-40 flex flex-col",children:[o.jsxs("div",{className:"flex items-center justify-between px-6 py-3 border-b border-gray-800 bg-gray-900/95 backdrop-blur",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-100",children:"Gallery View"}),o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("div",{className:"text-sm text-gray-400 text-right",children:[o.jsxs("div",{children:[A+1," / ",u.photos.length]}),I>0&&o.jsxs("div",{className:"text-xs text-blue-300",children:["(",I," unassigned)"]})]}),o.jsx("button",{onClick:d,className:"p-2 hover:bg-gray-800 rounded-lg transition-colors","aria-label":"Close gallery view",children:o.jsx(Wt,{className:"w-5 h-5"})})]})]}),o.jsxs("div",{className:"flex-1 flex items-center justify-center bg-gray-950 overflow-hidden relative",children:[H&&o.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-900/50 z-10",children:o.jsxs("div",{className:"text-center",children:[o.jsx(Qs,{className:"w-12 h-12 animate-spin text-blue-400 mx-auto mb-3"}),o.jsx("p",{className:"text-sm text-gray-400",children:"Loading image..."})]})}),re&&o.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-900/50 z-10",children:o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-sm text-red-400 mb-2",children:re}),o.jsxs("p",{className:"text-xs text-gray-500",children:["File: ",F.currentName]})]})}),O&&o.jsx("div",{className:"relative w-full h-full flex items-center justify-center p-4",children:F.mimeType?.startsWith("video/")?o.jsx("video",{src:O,className:"max-w-full max-h-full object-contain rounded-lg shadow-2xl",controls:!0,autoPlay:!0,muted:!0}):o.jsx("img",{src:O,alt:F.currentName,className:"max-w-full max-h-full object-contain rounded-lg shadow-2xl"})}),o.jsxs("div",{className:"absolute bottom-4 right-4 flex flex-col items-end gap-2",children:[z&&o.jsxs("div",{className:`${z.color} text-white px-4 py-2 rounded-lg shadow-xl flex items-center gap-2`,children:[o.jsx("span",{className:"text-xl font-bold",children:z.key}),o.jsxs("div",{className:"text-left",children:[o.jsx("div",{className:"text-sm font-semibold",children:z.label}),o.jsx("div",{className:"text-xs opacity-90",children:z.description})]})]}),F.day&&o.jsxs("div",{className:"bg-gray-900/90 backdrop-blur text-white px-4 py-2 rounded-lg shadow-xl",children:[o.jsx("div",{className:"text-xs text-gray-400",children:"Day"}),o.jsx("div",{className:"text-sm font-semibold",children:E[F.day]||`Day ${String(F.day).padStart(2,"0")}`})]}),F.favorite&&o.jsxs("div",{className:"bg-yellow-500 text-white px-3 py-2 rounded-lg shadow-xl flex items-center gap-2",children:[o.jsx(As,{className:"w-4 h-4 fill-current"}),o.jsx("span",{className:"text-sm font-semibold",children:"Favorite"})]})]}),o.jsxs("div",{className:"absolute top-4 left-4 bg-gray-900/80 backdrop-blur rounded-lg shadow-lg overflow-hidden flex flex-col",children:[o.jsxs("button",{onClick:()=>q(!Q),className:"flex items-center justify-between px-3 py-2 text-xs text-gray-300 hover:bg-gray-800 transition-colors border-b border-gray-700",children:[o.jsx("span",{className:"font-semibold",children:"Quick Actions"}),Q?o.jsx(ph,{className:"w-4 h-4"}):o.jsx(rd,{className:"w-4 h-4"})]}),Q&&o.jsxs("div",{className:"px-3 py-2 space-y-1",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-800 rounded text-[10px]",children:""}),o.jsx("span",{children:"Navigate"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-800 rounded text-[10px]",children:"A-E,M,X"}),o.jsx("span",{children:"Assign"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-800 rounded text-[10px]",children:"F"}),o.jsx("span",{children:"Favorite"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-800 rounded text-[10px]",children:"Esc"}),o.jsx("span",{children:"Exit"})]})]})]}),o.jsxs("div",{className:`absolute top-4 bottom-4 right-0 bg-gray-900/90 backdrop-blur rounded-l-lg shadow-2xl overflow-hidden flex transition-all duration-300 ${L?"w-72":"w-10"}`,children:[o.jsx("button",{onClick:()=>Z(!L),className:"flex-shrink-0 w-10 flex items-center justify-center text-gray-300 hover:bg-gray-800 transition-colors border-r border-gray-700",title:L?"Hide categories":"Show categories",children:o.jsxs("div",{className:"flex flex-col items-center gap-1",children:[L?o.jsx(ld,{className:"w-5 h-5"}):o.jsx(Fs,{className:"w-5 h-5"}),!L&&o.jsx("div",{className:"transform -rotate-90 text-[10px] font-semibold whitespace-nowrap mt-2",children:"MECE"})]})}),L&&o.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[o.jsxs("div",{className:"px-4 py-3 border-b border-gray-700",children:[o.jsx("h3",{className:"text-sm font-semibold text-gray-200",children:"MECE Categories"}),o.jsx("p",{className:"text-[10px] text-gray-400 mt-0.5",children:"Press key to assign bucket"})]}),o.jsx("div",{className:"flex-1 px-3 py-3 space-y-2.5 overflow-y-auto",children:w.map(m=>o.jsxs("div",{className:`${m.color} text-white px-3 py-2.5 rounded-lg text-xs shadow-md hover:shadow-lg transition-shadow cursor-pointer`,onClick:()=>{const $=F.bucket===m.key?"":m.key;p(F.id,$)},children:[o.jsxs("div",{className:"font-bold text-sm flex items-center justify-between",children:[o.jsxs("span",{children:[m.key," - ",m.label]}),F.bucket===m.key&&o.jsx("span",{className:"text-xs bg-white/20 px-2 py-0.5 rounded",children:"Active"})]}),o.jsx("div",{className:"opacity-90 text-[11px] mt-1",children:m.description})]},m.key))})]})]})]}),o.jsx(Up,{photos:u.photos,currentPhotoId:F.id,onSelectPhoto:ue})]})};function Hp(i){let a=i;for(;a;){if(a.dir)return a.dir==="rtl";a=a.parentElement}return!1}function Vp(i,a){const[u,d]=C.useState(a==="rtl");return C.useLayoutEffect(()=>{i&&(a||d(Hp(i)))},[a,i]),u}const Ks=typeof window<"u"?C.useLayoutEffect:C.useEffect;function td(i){if(i!==void 0)switch(typeof i){case"number":return i;case"string":{if(i.endsWith("px"))return parseFloat(i);break}}}function Wp({box:i,defaultHeight:a,defaultWidth:u,disabled:d,element:f,mode:h,style:p}){const{styleHeight:y,styleWidth:x}=C.useMemo(()=>({styleHeight:td(p?.height),styleWidth:td(p?.width)}),[p?.height,p?.width]),[k,w]=C.useState({height:a,width:u}),E=d||h==="only-height"&&y!==void 0||h==="only-width"&&x!==void 0||y!==void 0&&x!==void 0;return Ks(()=>{if(f===null||E)return;const D=new ResizeObserver(A=>{for(const U of A){const{contentRect:O,target:B}=U;f===B&&w(H=>H.height===O.height&&H.width===O.width?H:{height:O.height,width:O.width})}});return D.observe(f,{box:i}),()=>{D?.unobserve(f)}},[i,E,f,y,x]),C.useMemo(()=>({height:y??k.height,width:x??k.width}),[k,y,x])}function Kp(i){const a=C.useRef(()=>{throw new Error("Cannot call during render.")});return Ks(()=>{a.current=i},[i]),C.useCallback(u=>a.current?.(u),[a])}let xr=null;function Qp(i=!1){if(xr===null||i){const a=document.createElement("div"),u=a.style;u.width="50px",u.height="50px",u.overflow="scroll",u.direction="rtl";const d=document.createElement("div"),f=d.style;return f.width="100px",f.height="100px",a.appendChild(d),document.body.appendChild(a),a.scrollLeft>0?xr="positive-descending":(a.scrollLeft=1,a.scrollLeft===0?xr="negative":xr="positive-ascending"),document.body.removeChild(a),xr}return xr}function Ki({containerElement:i,direction:a,isRtl:u,scrollOffset:d}){if(a==="horizontal"&&u)switch(Qp()){case"negative":return-d;case"positive-descending":{if(i){const{clientWidth:f,scrollLeft:h,scrollWidth:p}=i;return p-f-h}break}}return d}function bn(i,a="Assertion error"){if(!i)throw console.error(a),Error(a)}function ml(i,a){if(i===a)return!0;if(!!i!=!!a||(bn(i!==void 0),bn(a!==void 0),Object.keys(i).length!==Object.keys(a).length))return!1;for(const u in i)if(!Object.is(a[u],i[u]))return!1;return!0}function hd({cachedBounds:i,itemCount:a,itemSize:u}){if(a===0)return 0;if(typeof u=="number")return a*u;{const d=i.get(i.size===0?0:i.size-1);bn(d!==void 0,"Unexpected bounds cache miss");const f=(d.scrollOffset+d.size)/i.size;return a*f}}function Gp({align:i,cachedBounds:a,index:u,itemCount:d,itemSize:f,containerScrollOffset:h,containerSize:p}){if(u<0||u>=d)throw RangeError(`Invalid index specified: ${u}`,{cause:`Index ${u} is not within the range of 0 - ${d-1}`});const y=hd({cachedBounds:a,itemCount:d,itemSize:f}),x=a.get(u),k=Math.max(0,Math.min(y-p,x.scrollOffset)),w=Math.max(0,x.scrollOffset-p+x.size);switch(i==="smart"&&(h>=w&&h<=k?i="auto":i="center"),i){case"start":return k;case"end":return w;case"center":return x.scrollOffset<=p/2?0:x.scrollOffset+x.size/2>=y-p/2?y-p:x.scrollOffset+x.size/2-p/2;default:return h>=w&&h<=k?h:h<w?w:k}}function Qi({cachedBounds:i,containerScrollOffset:a,containerSize:u,itemCount:d,overscanCount:f}){const h=d-1;let p=0,y=-1,x=0,k=-1,w=0;for(;w<h;){const E=i.get(w);if(E.scrollOffset+E.size>a)break;w++}for(p=w,x=Math.max(0,p-f);w<h;){const E=i.get(w);if(E.scrollOffset+E.size>=a+u)break;w++}return y=Math.min(h,w),k=Math.min(d-1,y+f),p<0&&(p=0,y=-1,x=0,k=-1),{startIndexVisible:p,stopIndexVisible:y,startIndexOverscan:x,stopIndexOverscan:k}}function Yp({itemCount:i,itemProps:a,itemSize:u}){const d=new Map;return{get(f){for(bn(f<i,`Invalid index ${f}`);d.size-1<f;){const p=d.size;let y;switch(typeof u){case"function":{y=u(p,a);break}case"number":{y=u;break}}if(p===0)d.set(p,{size:y,scrollOffset:0});else{const x=d.get(p-1);bn(x!==void 0,`Unexpected bounds cache miss for index ${f}`),d.set(p,{scrollOffset:x.scrollOffset+x.size,size:y})}}const h=d.get(f);return bn(h!==void 0,`Unexpected bounds cache miss for index ${f}`),h},set(f,h){d.set(f,h)},get size(){return d.size}}}function Jp({itemCount:i,itemProps:a,itemSize:u}){return C.useMemo(()=>Yp({itemCount:i,itemProps:a,itemSize:u}),[i,a,u])}function Xp({containerSize:i,itemSize:a}){let u;return typeof a==="string"?(bn(a.endsWith("%"),`Invalid item size: "${a}"; string values must be percentages (e.g. "100%")`),bn(i!==void 0,"Container size must be defined if a percentage item size is specified"),u=i*parseInt(a)/100):u=a,u}function nd({containerElement:i,containerStyle:a,defaultContainerSize:u=0,direction:d,isRtl:f=!1,itemCount:h,itemProps:p,itemSize:y,onResize:x,overscanCount:k}){const{height:w=u,width:E=u}=Wp({defaultHeight:d==="vertical"?u:void 0,defaultWidth:d==="horizontal"?u:void 0,element:i,mode:d==="vertical"?"only-height":"only-width",style:a}),D=C.useRef({height:0,width:0}),A=d==="vertical"?w:E,U=Xp({containerSize:A,itemSize:y});C.useLayoutEffect(()=>{if(typeof x=="function"){const F=D.current;(F.height!==w||F.width!==E)&&(x({height:w,width:E},{...F}),F.height=w,F.width=E)}},[w,x,E]);const O=Jp({itemCount:h,itemProps:p,itemSize:U}),B=C.useCallback(F=>O.get(F),[O]),[H,V]=C.useState(()=>Qi({cachedBounds:O,containerScrollOffset:0,containerSize:A,itemCount:h,overscanCount:k})),{startIndexVisible:re,startIndexOverscan:T,stopIndexVisible:Q,stopIndexOverscan:q}={startIndexVisible:Math.min(h-1,H.startIndexVisible),startIndexOverscan:Math.min(h-1,H.startIndexOverscan),stopIndexVisible:Math.min(h-1,H.stopIndexVisible),stopIndexOverscan:Math.min(h-1,H.stopIndexOverscan)},L=C.useCallback(()=>hd({cachedBounds:O,itemCount:h,itemSize:U}),[O,h,U]),Z=C.useCallback(F=>{const ce=Ki({containerElement:i,direction:d,isRtl:f,scrollOffset:F});return Qi({cachedBounds:O,containerScrollOffset:ce,containerSize:A,itemCount:h,overscanCount:k})},[O,i,A,d,f,h,k]);Ks(()=>{const F=(d==="vertical"?i?.scrollTop:i?.scrollLeft)??0;V(Z(F))},[i,d,Z]),Ks(()=>{if(!i)return;const F=()=>{V(ce=>{const{scrollLeft:I,scrollTop:ae}=i,oe=Ki({containerElement:i,direction:d,isRtl:f,scrollOffset:d==="vertical"?ae:I}),ue=Qi({cachedBounds:O,containerScrollOffset:oe,containerSize:A,itemCount:h,overscanCount:k});return ml(ue,ce)?ce:ue})};return i.addEventListener("scroll",F),()=>{i.removeEventListener("scroll",F)}},[O,i,A,d,h,k]);const J=Kp(({align:F="auto",containerScrollOffset:ce,index:I})=>{let ae=Gp({align:F,cachedBounds:O,containerScrollOffset:ce,containerSize:A,index:I,itemCount:h,itemSize:U});if(i){if(ae=Ki({containerElement:i,direction:d,isRtl:f,scrollOffset:ae}),typeof i.scrollTo!="function"){const oe=Z(ae);ml(H,oe)||V(oe)}return ae}});return{getCellBounds:B,getEstimatedSize:L,scrollToIndex:J,startIndexOverscan:T,startIndexVisible:re,stopIndexOverscan:q,stopIndexVisible:Q}}function qp(i){return C.useMemo(()=>i,Object.values(i))}function Zp(i,a){const{ariaAttributes:u,style:d,...f}=i,{ariaAttributes:h,style:p,...y}=a;return ml(u,h)&&ml(d,p)&&ml(f,y)}function em({cellComponent:i,cellProps:a,children:u,className:d,columnCount:f,columnWidth:h,defaultHeight:p=0,defaultWidth:y=0,dir:x,gridRef:k,onCellsRendered:w,onResize:E,overscanCount:D=3,rowCount:A,rowHeight:U,style:O,tagName:B="div",...H}){const V=qp(a),re=C.useMemo(()=>C.memo(i,Zp),[i]),[T,Q]=C.useState(null),q=Vp(T,x),{getCellBounds:L,getEstimatedSize:Z,startIndexOverscan:J,startIndexVisible:F,scrollToIndex:ce,stopIndexOverscan:I,stopIndexVisible:ae}=nd({containerElement:T,containerStyle:O,defaultContainerSize:y,direction:"horizontal",isRtl:q,itemCount:f,itemProps:V,itemSize:h,onResize:E,overscanCount:D}),{getCellBounds:oe,getEstimatedSize:ue,startIndexOverscan:se,startIndexVisible:z,scrollToIndex:m,stopIndexOverscan:$,stopIndexVisible:S}=nd({containerElement:T,containerStyle:O,defaultContainerSize:p,direction:"vertical",itemCount:A,itemProps:V,itemSize:U,onResize:E,overscanCount:D});C.useImperativeHandle(k,()=>({get element(){return T},scrollToCell({behavior:W="auto",columnAlign:Y="auto",columnIndex:te,rowAlign:de="auto",rowIndex:Ne}){const ye=ce({align:Y,containerScrollOffset:T?.scrollLeft??0,index:te}),b=m({align:de,containerScrollOffset:T?.scrollTop??0,index:Ne});typeof T?.scrollTo=="function"&&T.scrollTo({behavior:W,left:ye,top:b})},scrollToColumn({align:W="auto",behavior:Y="auto",index:te}){const de=ce({align:W,containerScrollOffset:T?.scrollLeft??0,index:te});typeof T?.scrollTo=="function"&&T.scrollTo({behavior:Y,left:de})},scrollToRow({align:W="auto",behavior:Y="auto",index:te}){const de=m({align:W,containerScrollOffset:T?.scrollTop??0,index:te});typeof T?.scrollTo=="function"&&T.scrollTo({behavior:Y,top:de})}}),[T,ce,m]),C.useEffect(()=>{J>=0&&I>=0&&se>=0&&$>=0&&w&&w({columnStartIndex:F,columnStopIndex:ae,rowStartIndex:z,rowStopIndex:S},{columnStartIndex:J,columnStopIndex:I,rowStartIndex:se,rowStopIndex:$})},[w,J,F,I,ae,se,z,$,S]);const g=C.useMemo(()=>{const W=[];if(f>0&&A>0)for(let Y=se;Y<=$;Y++){const te=oe(Y),de=[];for(let Ne=J;Ne<=I;Ne++){const ye=L(Ne);de.push(C.createElement(re,{...V,ariaAttributes:{"aria-colindex":Ne+1,role:"gridcell"},columnIndex:Ne,key:Ne,rowIndex:Y,style:{position:"absolute",left:q?void 0:0,right:q?0:void 0,transform:`translate(${q?-ye.scrollOffset:ye.scrollOffset}px, ${te.scrollOffset}px)`,height:te.size,width:ye.size}}))}W.push(o.jsx("div",{role:"row","aria-rowindex":Y+1,children:de},Y))}return W},[re,V,f,J,I,L,oe,q,A,se,$]),P=o.jsx("div",{"aria-hidden":!0,style:{height:ue(),width:Z(),zIndex:-1}});return C.createElement(B,{"aria-colcount":f,"aria-rowcount":A,role:"grid",...H,className:d,dir:x,ref:Q,style:{position:"relative",maxHeight:"100%",maxWidth:"100%",flexGrow:1,overflow:"auto",...O}},g,u,P)}const tm=5,nm=200,rm=12;function lm({photos:i,selectedPhotos:a,onSelectPhoto:u,onOpenViewer:d,height:f=800,width:h,columnCount:p=tm,cellSize:y=nm,gap:x=rm}){const k=h??p*y,w=C.useMemo(()=>Math.ceil(i.length/p),[i.length,p]),E=C.useCallback(({columnIndex:D,rowIndex:A,style:U})=>{const O=A*p+D;if(O>=i.length)return null;const B=i[O],H=a.has(B.id),V={...U,left:U.left+x,top:U.top+x,width:U.width-x,height:U.height-x};return o.jsx("div",{style:V,onClick:()=>u(B.id),onDoubleClick:()=>d(B.id),className:`cursor-pointer rounded-lg overflow-hidden ${H?"ring-2 ring-blue-500":""}`,children:B.thumbnail?o.jsx("img",{src:B.thumbnail,alt:B.currentName,className:"w-full h-full object-cover",loading:"lazy"}):o.jsx("div",{className:"w-full h-full bg-gray-900 flex items-center justify-center",children:o.jsx("span",{className:"text-xs text-gray-400",children:B.currentName})})})},[p,x,d,u,i,a]);return o.jsx(em,{columnCount:p,columnWidth:y,height:f,rowCount:w,rowHeight:y,width:k,children:E})}const sm=600,om=300;function im({loadingProject:i,currentView:a,selectedDay:u,selectedRootFolder:d,photos:f,rootGroups:h,filteredPhotos:p,selectedPhotos:y,galleryViewPhoto:x,dayLabels:k,buckets:w,onSelectPhoto:E,onOpenViewer:D,onCloseViewer:A,onNavigateViewer:U,onToggleFavorite:O,onAssignBucket:B,onAssignDay:H,onSaveToHistory:V,onShowToast:re,getSubfolderGroup:T,getDerivedSubfolderGroup:Q,isVideoPhoto:q,isMeceBucketLabel:L}){const Z=C.useRef({}),J=(z,m)=>{m.stopPropagation(),Z.current[z]?(clearTimeout(Z.current[z]),delete Z.current[z],D(z)):Z.current[z]=setTimeout(()=>{delete Z.current[z],E(z)},om)},F=(z,m,$)=>o.jsx("div",{className:"grid grid-cols-5 gap-3",children:z.map(S=>o.jsxs("div",{onClick:g=>J(S.id,g),"data-testid":`photo-${S.id}`,className:`relative group cursor-pointer rounded-lg overflow-hidden transition-all shadow-lg hover:shadow-xl ${S.bucket||S.archived?"opacity-70 saturate-75":"hover:scale-105"} ${y.has(S.id)?"ring-2 ring-blue-500":""}`,children:[S.thumbnail?S.mimeType?.startsWith("video/")?o.jsx("video",{src:S.thumbnail,className:"w-full aspect-square object-cover",muted:!0,preload:"metadata"}):o.jsx("img",{src:S.thumbnail,alt:S.currentName,className:"w-full aspect-square object-cover"}):o.jsx("div",{className:"w-full aspect-square bg-gray-900 flex items-center justify-center text-xs text-gray-400 px-2 text-center",children:S.currentName}),S.mimeType?.startsWith("video/")&&o.jsx("div",{className:"absolute top-2 left-2 bg-black/70 backdrop-blur-sm rounded-full p-1.5",children:o.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{d:"M6.3 2.84A1.5 1.5 0 004 4.11v11.78a1.5 1.5 0 002.3 1.27l9.344-5.891a1.5 1.5 0 000-2.538L6.3 2.841z"})})}),o.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/90 via-black/30 to-transparent opacity-0 group-hover:opacity-100 transition-opacity z-5",children:o.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-2",children:o.jsx("p",{className:"text-xs font-medium text-white truncate",children:S.currentName})})}),S.isPreOrganized&&o.jsx("div",{className:"absolute top-2 right-2 z-10",children:o.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold bg-blue-600 text-white shadow-lg",title:`Auto-assigned: Day ${S.detectedDay??""}, Bucket ${S.detectedBucket??""}`,children:"Organized"})}),S.bucket&&(()=>{const g=w.find(te=>te.key===S.bucket),P=g?.color||"bg-gray-500",Y={"bg-blue-500":"rgb(59, 130, 246)","bg-purple-500":"rgb(168, 85, 247)","bg-green-500":"rgb(34, 197, 94)","bg-orange-500":"rgb(249, 115, 22)","bg-yellow-500":"rgb(234, 179, 8)","bg-indigo-500":"rgb(99, 102, 241)","bg-gray-500":"rgb(107, 114, 128)"}[P];return o.jsx("div",{className:"absolute bottom-2 left-2 px-2 py-1 rounded text-xs font-bold text-white shadow-lg z-10",style:{backgroundColor:Y||"rgb(107, 114, 128)"},title:`Bucket: ${S.bucket}${g?` (${g.label})`:""}`,children:o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("span",{children:S.bucket}),S.favorite&&o.jsx(As,{className:"w-3 h-3 fill-current"})]})})})(),!S.bucket&&S.favorite&&o.jsx("div",{className:"absolute bottom-2 left-2 bg-yellow-500 text-white rounded-full p-1.5 shadow-lg z-10",children:o.jsx(As,{className:"w-3.5 h-3.5 fill-current"})})]},S.id))});if(i)return o.jsx("div",{className:"flex items-center justify-center h-96",children:o.jsxs("div",{className:"text-center",children:[o.jsx(Qs,{className:"w-12 h-12 mx-auto mb-4 animate-spin text-blue-400"}),o.jsx("p",{className:"text-gray-400",children:"Loading project..."})]})});if(a==="days"&&u===null)return o.jsx("div",{className:"flex items-center justify-center h-96 text-gray-500",children:o.jsxs("div",{className:"text-center",children:[o.jsx(hh,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),o.jsx("p",{children:"Select a day to view photos"})]})});if(a==="folders"&&d===null&&u===null)return o.jsx("div",{className:"flex items-center justify-center h-96 text-gray-500",children:o.jsxs("div",{className:"text-center",children:[o.jsx(Gi,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),o.jsx("p",{children:"Select a folder to view photos"})]})});const ce=a==="folders"&&d?(h.find(z=>z[0]===d)?.[1]||[]).filter(z=>!z.archived):null,I=ce!==null?ce:p,ae=aa(I,{groupBy:u!==null?"subfolder":null,separateVideos:!0,selectedDay:u,getSubfolderGroup:T,isVideo:q}),oe=ae.photos;ae.indexMap;const ue=u!==null?ae.groups??null:null;if(I.length===0)return o.jsx("div",{className:"flex items-center justify-center h-96 text-gray-500",children:o.jsxs("div",{className:"text-center",children:[o.jsx(Gi,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),o.jsx("p",{children:"No photos in this view"})]})});if(x){const z=oe.find(m=>m.id===x);if(z)return o.jsx(Bp,{photo:z,filteredPhotos:oe,orderingResult:ae,onClose:A,onNavigate:U,onToggleFavorite:m=>O(m),onAssignBucket:(m,$)=>{if(B(m,$),$){const g=$t(m,"next",ae,Y=>!Y.bucket&&!Y.archived);if(g){U(g.id);return}const P=$t(m,"next",ae);if(P){U(P.id);return}const W=$t(m,"prev",ae);if(W){U(W.id);return}A()}},onAssignDay:(m,$)=>H(m,$),selectedBucket:z.bucket||void 0,selectedDay:z.day,buckets:w,dayLabels:k,onShowToast:re})}return u!==null&&ue?o.jsx("div",{className:"space-y-8",children:ue.map(z=>{const m=z.photos,$=m.filter(q),S=m.filter(ye=>!q(ye)),g=$.length>0&&S.length>0,P=z.photos.filter(ye=>ye.day===u);P.some(ye=>ye.subfolderOverride!==void 0);const W=P.some(ye=>ye.subfolderOverride===null),Y=z.label==="Day Root",te=L(z.label),de=Y&&W,Ne=!Y&&!te;return o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h3",{className:"text-sm font-semibold text-gray-200",children:z.label}),o.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-400",children:[o.jsxs("span",{children:[z.photos.length," items"]}),de&&o.jsx("button",{className:"text-xs text-red-300 hover:text-red-200",title:"Revert photos back to subfolder",onClick:()=>{const ye=f.map(b=>b.day!==u?b:P.find(le=>le.id===b.id)?{...b,subfolderOverride:void 0}:b);V(ye),re("Photos reverted to subfolder.","info")},children:"Undo Ingest"}),Ne&&o.jsxs("div",{className:"flex items-center gap-2",children:[!W&&o.jsxs(o.Fragment,{children:[o.jsx("button",{className:"text-xs text-blue-300 hover:text-blue-200",title:"Move photos in this subfolder to the day root",onClick:()=>{const ye=f.map(le=>le.day!==u||Q(le,u)!==z.label?le:{...le,subfolderOverride:null});V(ye);const b=k[u]||`Day ${String(u).padStart(2,"0")}`;re(`Photos moved to ${b}.`,"info")},children:"Ingest to Day"}),o.jsx("button",{className:"text-xs text-gray-300 hover:text-gray-100",onClick:()=>{const ye=f.map(b=>{if(b.day!==u)return b;const le=Q(b,u);return le!==z.label?b:{...b,subfolderOverride:le}});V(ye)},children:"Keep Subfolder"})]}),W&&o.jsx("button",{className:"text-xs text-red-300 hover:text-red-200",title:"Revert photos back to subfolder",onClick:()=>{const ye=f.map(b=>b.day!==u?b:P.find(le=>le.id===b.id)?{...b,subfolderOverride:void 0}:b);V(ye),re("Photos reverted to subfolder.","info")},children:"Undo Ingest"})]})]})]}),g&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"mb-2 text-xs uppercase tracking-wider text-gray-500",children:"Photos"}),F(S),o.jsx("div",{className:"mt-6 mb-2 text-xs uppercase tracking-wider text-gray-500",children:"Videos"}),F($)]}),!g&&F(m)]},z.label)})}):u===null&&oe.length>=sm?o.jsx(lm,{photos:oe,selectedPhotos:y,onSelectPhoto:E,onOpenViewer:D}):F(oe)}function am({selectedPhotos:i,photos:a,days:u,buckets:d,onSaveToHistory:f,onPersistState:h,onSetDayLabels:p,onSetSelectedDay:y,onSetCurrentView:x,onSetSelectedPhotos:k,onRemoveDayAssignment:w,onAssignBucket:E,onToggleFavorite:D}){const[A,U]=C.useState(!1),[O,B]=C.useState("");if(C.useEffect(()=>{U(!1)},[i]),i.size===0)return null;const H=i.size===1?Array.from(i)[0]:null,V=H?a.find(re=>re.id===H):null;return o.jsx("aside",{className:"w-80 border-l border-gray-800 bg-gray-900 overflow-y-auto",children:o.jsxs("div",{className:"p-6",children:[o.jsx("div",{className:"mb-6",children:i.size===1&&V?o.jsxs(o.Fragment,{children:[V.mimeType?.startsWith("video/")?o.jsx("video",{src:V.thumbnail,className:"w-full rounded-lg",controls:!0}):o.jsx("img",{src:V.thumbnail,alt:"Selected",className:"w-full rounded-lg"}),o.jsx("div",{className:"mt-2 text-xs text-gray-400 font-mono break-all",children:A?o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{value:O,onChange:re=>B(re.target.value),className:"w-full px-2 py-1 rounded bg-gray-800 text-sm text-gray-100"}),o.jsx("button",{onClick:()=>{const re=a.map(T=>T.id===H?{...T,currentName:O}:T);f(re),U(!1)},className:"p-1 bg-green-600 rounded","aria-label":"Save name",children:o.jsx(Ji,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>U(!1),className:"p-1 bg-gray-800 rounded","aria-label":"Cancel edit name",children:o.jsx(Wt,{className:"w-4 h-4"})})]}):o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("div",{children:V.currentName}),o.jsx("button",{onClick:()=>{B(V.currentName||V.originalName||""),U(!0)},className:"p-1 ml-2","aria-label":"Edit name",children:o.jsx(Yi,{className:"w-4 h-4 text-gray-400"})})]})})]}):o.jsxs("div",{className:"text-sm text-gray-300",children:[i.size," selected"]})}),o.jsxs("div",{className:"space-y-4 mb-6",children:[o.jsx("h3",{className:"text-sm font-semibold text-gray-300 mb-3",children:"Assign Day"}),o.jsxs("div",{className:"flex gap-2 items-center",children:[o.jsxs("select",{"aria-label":"Assign to...",onChange:re=>{const T=re.target.value;if(!T)return;const Q=T==="new"?Math.max(0,...u.map(Z=>Z[0]))+1:Number(T),q=Array.from(i),L=a.map(Z=>q.includes(Z.id)?{...Z,day:Q}:Z);f(L),T==="new"&&(p(Z=>({...Z,[Q]:`Day ${String(Q).padStart(2,"0")}`})),h(L)),y(Q),x("days"),k(new Set)},className:"px-3 py-2 rounded bg-gray-800",defaultValue:"",children:[o.jsx("option",{value:"",children:"Assign to..."}),u.map(([re])=>o.jsx("option",{value:re,children:`Day ${String(re).padStart(2,"0")}`},re)),o.jsx("option",{value:"new",children:"Create new day"})]}),o.jsx("div",{className:"text-xs text-gray-400",children:"Assign selected photos to a day folder"})]}),o.jsx("button",{onClick:()=>{w(Array.from(i)),k(new Set)},className:"w-full px-3 py-2 bg-gray-700 hover:bg-gray-600 rounded text-sm font-medium transition-colors",children:"Remove Day Assignment"})]}),o.jsxs("div",{className:"space-y-2 mb-6",children:[o.jsx("h3",{className:"text-sm font-semibold text-gray-300 mb-3",children:"Assign Category"}),d.map(re=>o.jsxs("button",{onClick:()=>E(Array.from(i),re.key),className:`w-full text-left px-4 py-3 rounded-lg transition-all ${re.color} hover:brightness-110 text-white`,children:[o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{children:[o.jsx("span",{className:"font-bold text-lg",children:re.key}),o.jsx("span",{className:"ml-3 font-medium",children:re.label})]})}),o.jsx("p",{className:"text-xs mt-1 opacity-80",children:re.description})]},re.key))]}),o.jsx("div",{className:"space-y-3 pt-6 border-t border-gray-800",children:o.jsxs("button",{onClick:()=>D(Array.from(i)),className:`w-full px-4 py-2 rounded-lg flex items-center gap-2 transition-colors ${i.size===1&&V?.favorite?"bg-yellow-600 hover:bg-yellow-700":"bg-gray-800 hover:bg-gray-700"}`,children:[o.jsx(As,{className:`w-4 h-4 ${i.size===1&&V?.favorite?"fill-current":""}`}),"Toggle Favorite (F)"]})})]})})}function um({isOpen:i,buckets:a,onClose:u}){return i?o.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-6",children:o.jsx("div",{className:"bg-gray-900 rounded-lg max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsx("h2",{className:"text-xl font-bold",children:"Keyboard Shortcuts"}),o.jsx("button",{onClick:u,className:"p-2 hover:bg-gray-800 rounded",children:o.jsx(Wt,{className:"w-5 h-5"})})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-blue-400 mb-3",children:"MECE Categories"}),o.jsx("div",{className:"grid grid-cols-2 gap-2",children:a.map(d=>o.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[o.jsx("kbd",{className:`px-2 py-1 rounded ${d.color} text-white font-bold`,children:d.key==="F"?"M":d.key}),o.jsx("span",{children:d.label})]},d.key))}),o.jsx("p",{className:"text-xs text-gray-400 mt-3",children:"Keyboard shortcuts: AE, X, M (Mood/Food). F is reserved for Favorite."})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-blue-400 mb-3",children:"Navigation"}),o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:""}),o.jsx("span",{children:"Previous / Next photo"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"J / K"}),o.jsx("span",{children:"Next / Previous (grid)"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"Shift+J / Shift+K"}),o.jsx("span",{children:"Next / Previous unassigned"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"Enter"}),o.jsx("span",{children:"Fullscreen view"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"Esc"}),o.jsx("span",{children:"Close / Deselect"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"Space / N"}),o.jsx("span",{children:"Next unassigned (viewer)"})]})]})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-blue-400 mb-3",children:"Actions"}),o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"F"}),o.jsx("span",{children:"Toggle favorite"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"Shift+H"}),o.jsx("span",{children:"Toggle Skip Assigned"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"AE, M, X"}),o.jsx("span",{children:"Assign bucket (multi-select supported)"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"Z"}),o.jsx("span",{children:"Undo (keyboard)"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"Z"}),o.jsx("span",{children:"Redo (keyboard)"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"Ctrl+Shift+D"}),o.jsx("span",{children:"Toggle debug overlay"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"?"}),o.jsx("span",{children:"Show this help"})]})]})]})]})]})})}):null}function cm({isOpen:i,scriptText:a,copyStatus:u,detectedProjectPath:d,onClose:f,onCopyScript:h,onDownloadScript:p,onRegenerateScript:y}){const[x,k]=C.useState(d);C.useEffect(()=>{k(d)},[d]);const w=E=>{const D=E.target.value;k(D),y(D)};return i?o.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-6",children:o.jsxs("div",{className:"bg-gray-900 rounded-lg max-w-2xl w-full overflow-hidden border border-gray-800",children:[o.jsxs("div",{className:"px-5 py-4 border-b border-gray-800 flex items-center justify-between",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-100",children:"Export Script"}),o.jsx("button",{onClick:f,className:"p-2 hover:bg-gray-800 rounded","aria-label":"Close export script dialog",children:o.jsx(Wt,{className:"w-5 h-5"})})]}),o.jsxs("div",{className:"px-5 py-4 space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1.5",children:"Project Directory Path"}),o.jsx("input",{type:"text",value:x,onChange:w,placeholder:"/Users/you/Photos/Trip-to-Japan",className:"w-full px-3 py-2 rounded-lg border border-gray-700 bg-gray-950 text-gray-100 text-sm font-mono focus:outline-none focus:ring-2 focus:ring-blue-500"}),o.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Enter the full path to your photo project folder"})]}),o.jsxs("p",{className:"text-sm text-gray-400",children:["Download the script and run it:"," ",o.jsx("code",{className:"bg-gray-800 px-1.5 py-0.5 rounded text-xs",children:"bash narrative-export.sh"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("button",{onClick:p,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium flex items-center gap-2",children:[o.jsx(sa,{className:"w-4 h-4"}),"Download Script"]}),o.jsx("button",{onClick:h,className:"px-3 py-2 rounded-lg bg-gray-800 text-gray-100 hover:bg-gray-700 text-sm",children:"Copy to Clipboard"}),u==="copied"&&o.jsx("span",{className:"text-xs text-green-400",children:"Copied!"}),u==="failed"&&o.jsx("span",{className:"text-xs text-red-400",children:"Copy failed. Use download instead."})]}),o.jsx("textarea",{readOnly:!0,value:a,className:"w-full h-48 rounded-lg border border-gray-800 bg-gray-950 px-3 py-2 text-xs text-gray-100 font-mono"})]})]})}):null}function dm({isOpen:i,scriptText:a,onClose:u,onDownloadScript:d}){return i?o.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-6",children:o.jsxs("div",{className:"bg-gray-900 rounded-lg max-w-2xl w-full overflow-hidden border border-gray-800",children:[o.jsxs("div",{className:"px-5 py-4 border-b border-gray-800 flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Uc,{className:"w-5 h-5 text-yellow-500"}),o.jsx("h2",{className:"text-lg font-semibold text-gray-100",children:"Undo Last Export"})]}),o.jsx("button",{onClick:u,className:"p-2 hover:bg-gray-800 rounded","aria-label":"Close undo script dialog",children:o.jsx(Wt,{className:"w-5 h-5"})})]}),o.jsxs("div",{className:"px-5 py-4 space-y-3",children:[o.jsx("div",{className:"bg-yellow-900/20 border border-yellow-700/50 rounded-lg p-3",children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(Uc,{className:"w-4 h-4 text-yellow-500 mt-0.5 flex-shrink-0"}),o.jsxs("div",{className:"text-sm text-yellow-200",children:[o.jsx("p",{className:"font-medium mb-1",children:"Warning: This will delete exported files"}),o.jsx("p",{className:"text-yellow-300/80",children:"This script will remove all files created by your last export. Files are validated by size before deletion for safety."})]})]})}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1.5",children:"Undo Script"}),o.jsxs("p",{className:"text-sm text-gray-400 mb-2",children:["Download and run this script to undo your last export:"," ",o.jsx("code",{className:"bg-gray-800 px-1.5 py-0.5 rounded text-xs",children:"bash narrative-undo-export.sh"})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("button",{onClick:d,className:"px-4 py-2 rounded-lg bg-yellow-600 text-white hover:bg-yellow-700 text-sm font-medium flex items-center gap-2",children:[o.jsx(sa,{className:"w-4 h-4"}),"Download Undo Script"]}),o.jsx("button",{onClick:u,className:"px-3 py-2 rounded-lg bg-gray-800 text-gray-100 hover:bg-gray-700 text-sm",children:"Cancel"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1.5",children:"Script Preview"}),o.jsx("textarea",{readOnly:!0,value:a,className:"w-full h-48 rounded-lg border border-gray-800 bg-gray-950 px-3 py-2 text-xs text-gray-100 font-mono"})]})]})]})}):null}function fm({toast:i,onDismiss:a}){return i?o.jsx("div",{className:"fixed bottom-6 right-6 z-50",children:o.jsxs("div",{className:`flex items-center gap-3 px-4 py-2 rounded-lg text-sm shadow-lg ${i.tone==="error"?"bg-red-600 text-white":"bg-gray-800 text-gray-100"}`,role:"status","aria-live":"polite",children:[o.jsx("span",{children:i.message}),o.jsxs("div",{className:"flex items-center gap-2",children:[i.actionLabel&&o.jsx("button",{onClick:()=>{i.onAction?.(),a()},className:"px-2 py-0.5 rounded bg-white/10 text-xs text-white hover:bg-white/20",children:i.actionLabel}),o.jsx("button",{onClick:a,className:"p-1 rounded hover:bg-white/10","aria-label":"Dismiss toast",children:o.jsx(Wt,{className:"w-4 h-4"})})]})]})}):null}function hm({photoId:i,photos:a,onClose:u}){if(!i)return null;const d=a.find(f=>f.id===i);return d?o.jsxs("div",{className:"fixed inset-0 bg-black z-50 flex items-center justify-center",children:[o.jsx("button",{onClick:u,className:"absolute top-4 right-4 p-2 bg-black/50 hover:bg-black/70 rounded-full transition-colors",children:o.jsx(Wt,{className:"w-6 h-6"})}),d.mimeType?.startsWith("video/")?o.jsx("video",{src:d.thumbnail,controls:!0,className:"max-w-full max-h-full object-contain",autoPlay:!1}):o.jsx("img",{src:d.thumbnail,alt:"Fullscreen",className:"max-w-full max-h-full object-contain"}),o.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/90 to-transparent p-6",children:[o.jsx("p",{className:"text-center text-sm font-mono",children:d.currentName}),o.jsx("p",{className:"text-center text-xs text-gray-400 mt-2",children:"Press ESC to close  Arrow keys to navigate"})]})]}):null}function pm({enabled:i,photos:a,filteredPhotos:u,selectedPhotos:d,currentView:f}){const h=C.useRef(performance.now()),[p,y]=C.useState(0);return C.useEffect(()=>{const x=performance.now(),k=x-h.current;h.current=x,i&&y(k)},[i,a,u,d,f]),i?o.jsxs("div",{className:"fixed bottom-4 left-4 bg-black/90 text-white text-xs p-3 rounded-lg font-mono z-50",children:[o.jsx("div",{className:"font-bold mb-2",children:"Debug Info"}),o.jsxs("div",{children:["Total Photos: ",a]}),o.jsxs("div",{children:["Filtered: ",u]}),o.jsxs("div",{children:["Selected: ",d]}),o.jsxs("div",{children:["View: ",f]}),o.jsxs("div",{children:["Last Render: ",p.toFixed(2),"ms"]}),o.jsx("div",{className:"mt-2 text-gray-400",children:"Press Ctrl+Shift+D to toggle"})]}):null}const pl=[{key:"A",label:"Establishing",color:"bg-blue-500",description:"Wide shots, landscapes"},{key:"B",label:"People",color:"bg-purple-500",description:"Portraits, groups"},{key:"C",label:"Culture/Detail",color:"bg-green-500",description:"Local life, close-ups"},{key:"D",label:"Action/Moment",color:"bg-orange-500",description:"Events, activities"},{key:"E",label:"Transition",color:"bg-yellow-500",description:"Travel, movement"},{key:"M",label:"Mood/Food",color:"bg-indigo-500",description:"Food, mood"},{key:"X",label:"Archive",color:"bg-gray-500",description:"Unwanted shots"}],mm=new Set(pl.map(i=>i.key)),gm=i=>{const u=i.trim().split(/[\s_-]+/)[0]||"";return mm.has(u.toUpperCase())};function ym(){const i=C.useRef([]),[a,u]=C.useState(Bs.getDisplayVersion()),d=!1,[f,h]=C.useState(!1),[p,y]=C.useState(!1),{toast:x,showToast:k,clearToast:w}=vp(),{currentView:E,setCurrentView:D,sidebarCollapsed:A,setSidebarCollapsed:U,hideAssigned:O,setHideAssigned:B,showHelp:H,setShowHelp:V,galleryViewPhoto:re,setGalleryViewPhoto:T,fullscreenPhoto:Q,setFullscreenPhoto:q,selectedDay:L,setSelectedDay:Z,selectedRootFolder:J,setSelectedRootFolder:F,foldersViewStateRef:ce}=yp(),{photos:I,setPhotos:ae,projectName:oe,setProjectName:ue,projectRootPath:se,setProjectRootPath:z,projectFolderLabel:m,projectSettings:$,recentProjects:S,setRecentProjects:g,showOnboarding:P,setShowOnboarding:W,showWelcome:Y,setShowWelcome:te,projectError:de,setProjectError:Ne,permissionRetryProjectId:ye,projectNeedingReselection:b,setProjectNeedingReselection:le,loadingProject:ve,loadingProgress:ne,loadingMessage:me,dayLabels:je,setDayLabels:Pe,dayContainers:xe,loadProject:be,retryProjectPermission:_e,handleOnboardingComplete:Ge}=gp({debugEnabled:d,showToast:k,prevThumbnailsRef:i}),{setHistory:yt,setHistoryIndex:ot,persistState:Ke,saveToHistory:Ae,undo:gl,redo:yl}=hp({photos:I,setPhotos:ae,projectRootPath:se,projectName:oe,projectFolderLabel:m,projectSettings:$,dayLabels:je,prevThumbnailsRef:i}),{showExportScript:kr,exportScriptText:Sr,exportCopyStatus:Qn,openExportScriptModal:vl,closeExportScriptModal:_n,copyExportScript:Dn,downloadExportScript:qs,regenerateScript:xl,getDetectedProjectPath:wl,showUndoScript:Zs,undoScriptText:jr,openUndoScriptModal:Cr,closeUndoScriptModal:Er,downloadUndoScript:br,hasExportManifest:Pr}=Cp(I,je,$,se||void 0),{setCoverForPhotoId:Qt}=Tp({photos:I,projectRootPath:se,projectName:oe,projectFolderLabel:m,setRecentProjects:g,showToast:k});C.useEffect(()=>{(async()=>{try{const Oe=await Bs.getCurrentVersion();u(`v${Oe}`)}catch{}})()},[d]);const{days:Ft,visibleDays:Nl,normalizePath:kl,sortFolders:Sl,getDerivedSubfolderGroup:jl,getSubfolderGroup:Gn,rootGroups:Gt,displayRootGroups:Cl,filteredPhotos:Dt}=Op({photos:I,dayLabels:je,dayContainers:xe,projectSettings:$,debugEnabled:d,currentView:E,selectedDay:L,selectedRootFolder:J,hideAssigned:O}),Rn=C.useCallback(we=>{if(we.mimeType?.startsWith("video/"))return!0;const Oe=we.originalName.split(".").pop()?.toLowerCase()||"";return["mp4","mov","webm","avi","mkv"].includes(Oe)},[]),sn=$s.useMemo(()=>{const Oe=(E==="folders"&&J?(Gt.find(Ue=>Ue[0]===J)?.[1]||[]).filter(Ue=>!Ue.archived):null)??Dt;return aa(Oe,{groupBy:L!==null?"subfolder":null,separateVideos:!0,selectedDay:L,getSubfolderGroup:Gn,isVideo:Rn})},[E,J,Gt,Dt,L,Gn,Rn]),{editingDay:eo,editingDayName:On,setEditingDayName:Yn,startEditingDay:Jn,saveDayName:_r,cancelEditingDay:to}=Rp({photos:I,persistState:Ke,setDayLabels:Pe}),{selectedPhotos:Yt,setSelectedPhotos:Dr,focusedPhoto:Jt,setFocusedPhoto:El,setLastSelectedIndex:bl,lastSelectedIndexRef:no,resetSelection:Pl}=pp({filteredPhotos:Dt,coverSelectionMode:f,setCoverForPhotoId:Qt,setCoverSelectionMode:h}),{setCoverFromSelection:_l}=Ip({projectRootPath:se,selectedPhotos:Yt,showToast:k,setCoverForPhotoId:Qt}),{handleOnboardingComplete:Rr}=Mp({handleOnboardingCompleteInternal:Ge,setHistory:yt,setHistoryIndex:ot,resetSelection:Pl,setSelectedDay:Z,setSelectedRootFolder:F,setCurrentView:D}),Dl=C.useCallback(()=>{Z(null),F(null)},[Z,F]);zp({projectRootPath:se,photosLength:I.length,selectedRootFolder:J,selectedDay:L,currentView:E,days:Ft,rootGroups:Gt,setSelectedDay:Z,setSelectedRootFolder:F});const{assignBucket:Or,removeDayAssignment:ro,toggleFavorite:$e}=Lp({photos:I,saveToHistory:Ae,selectedDay:L});Dp({selectedPhotos:Yt,focusedPhoto:Jt,filteredPhotos:Dt,orderingResult:sn,fullscreenPhoto:Q,showHelp:H,showExportScript:kr,showWelcome:Y,showOnboarding:P,coverSelectionMode:f,hideAssigned:O,MECE_BUCKETS:pl,onAssignBucket:Or,onToggleFavorite:$e,onUndo:gl,onRedo:yl,onSetFocusedPhoto:El,onSetSelectedPhotos:Dr,onSetLastSelectedIndex:bl,onSetFullscreenPhoto:q,onSetShowHelp:V,onSetCoverSelectionMode:h,onSetHideAssigned:B,onToggleDebugOverlay:()=>y(we=>!we),onShowToast:k,lastSelectedIndexRef:no});const lo=$s.useMemo(()=>({total:I.length,sorted:I.filter(we=>we.bucket&&!we.archived).length,unsorted:I.filter(we=>!we.bucket&&!we.archived).length,archived:I.filter(we=>we.archived).length,favorites:I.filter(we=>we.favorite).length,root:I.filter(we=>we.day===null&&!we.archived).length}),[I]);return o.jsxs("div",{className:"h-screen flex flex-col bg-gray-950 text-gray-100",children:[o.jsx($p,{showWelcome:Y,projectName:oe,stats:lo,currentVersion:a,coverSelectionMode:f,selectedPhotosCount:Yt.size,projectRootPath:se,currentView:E,hideAssigned:O,recentProjects:S,projectError:de,permissionRetryProjectId:ye,loadingProject:ve,hasExportManifest:Pr(),onMainMenu:()=>{W(!1),Ne(null),te(!0),ze.remove(En)},onStartCoverSelection:()=>{h(!0),k("Select a photo to set as cover. Click a photo to set, or press Esc to cancel.","info")},onUseCoverSelection:async()=>{await _l(),h(!1)},onCancelCoverSelection:()=>{h(!1),k("Cover selection cancelled.")},onSelectRecentProject:we=>{be(we)},onOpenProject:()=>{W(!0)},onDeleteProject:async()=>{if(!(!se||!window.confirm(`Delete project '${oe}'? This will remove local state and stored folder access. This cannot be undone.`))){try{await fp(se)}catch{k("Failed to delete project.","error");return}try{const Oe=ze.get(kt),St=(Oe?JSON.parse(Oe):[]).filter(Rl=>Rl.projectId!==se);ze.set(kt,JSON.stringify(St)),g(St)}catch{}ze.remove(En),ae([]),z(null),ue("No Project"),te(!0),k("Project deleted.")}},onImportTrip:()=>{Ne(null),W(!0)},onExportScript:vl,onUndoExport:Cr,onShowHelp:()=>V(!0),onRetryPermission:_e,onChangeView:we=>D(we),onToggleHideAssigned:()=>B(we=>!we),onRememberFoldersViewState:()=>{ce.current={selectedRootFolder:J,selectedDay:L}},onRestoreFoldersViewState:()=>{F(ce.current.selectedRootFolder),Z(ce.current.selectedDay)},onClearDaySelection:()=>{Z(null)}}),o.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[o.jsx(Fp,{currentView:E,sidebarCollapsed:A,onCollapseSidebar:()=>U(!0),onExpandSidebar:()=>U(!1),visibleDays:Nl,selectedDay:L,selectedRootFolder:J,onSelectDay:Z,onSelectRootFolder:F,editingDay:eo,editingDayName:On,onChangeEditingDayName:Yn,onStartEditingDay:Jn,onSaveDayName:_r,onCancelEditingDay:to,onClearSelectedDay:Dl,days:Ft,dayLabels:je,dayContainers:xe,photos:I,normalizePath:kl,rootGroups:Gt,displayRootGroups:Cl,sortFolders:Sl,projectSettings:$,debugEnabled:d}),o.jsx("main",{className:"flex-1 overflow-y-auto",children:o.jsx("div",{className:"p-6",children:o.jsx(im,{loadingProject:ve,currentView:E,selectedDay:L,selectedRootFolder:J,photos:I,rootGroups:Gt,filteredPhotos:Dt,selectedPhotos:Yt,galleryViewPhoto:re,dayLabels:je,buckets:pl,onSelectPhoto:we=>Dr(new Set([we])),onOpenViewer:we=>T(we),onCloseViewer:()=>T(null),onNavigateViewer:we=>T(we),onToggleFavorite:we=>{ae(Oe=>Oe.map(Ue=>Ue.id===we?{...Ue,favorite:!Ue.favorite}:Ue)),Ke(I.map(Oe=>Oe.id===we?{...Oe,favorite:!Oe.favorite}:Oe))},onAssignBucket:(we,Oe)=>Or(we,Oe),onAssignDay:(we,Oe)=>{ae(Ue=>Ue.map(St=>St.id===we?{...St,day:Oe}:St)),Ke(I.map(Ue=>Ue.id===we?{...Ue,day:Oe}:Ue))},onSaveToHistory:Ae,onShowToast:k,getSubfolderGroup:Gn,getDerivedSubfolderGroup:jl,isVideoPhoto:Rn,isMeceBucketLabel:gm})})}),Yt.size>0&&!Q&&o.jsx(am,{selectedPhotos:Yt,photos:I,days:Ft,buckets:pl,onSaveToHistory:Ae,onPersistState:Ke,onSetDayLabels:Pe,onSetSelectedDay:Z,onSetCurrentView:D,onSetSelectedPhotos:Dr,onRemoveDayAssignment:ro,onAssignBucket:Or,onToggleFavorite:$e})]}),o.jsx(hm,{photoId:Q,photos:I,onClose:()=>q(null)}),o.jsx(cm,{isOpen:kr,scriptText:Sr,copyStatus:Qn,detectedProjectPath:wl(),onClose:_n,onCopyScript:Dn,onDownloadScript:qs,onRegenerateScript:xl}),o.jsx(dm,{isOpen:Zs,scriptText:jr,onClose:Er,onDownloadScript:br}),o.jsx(um,{isOpen:H,buckets:pl,onClose:()=>V(!1)}),o.jsx(fm,{toast:x,onDismiss:w}),o.jsx(pm,{enabled:p,photos:I.length,filteredPhotos:sn.photos.length,selectedPhotos:Yt.size,currentView:E}),Y&&o.jsx(Mh,{isOpen:Y,onClose:()=>{se&&(te(!1),ze.set(En,se))},onCreateComplete:Rr,onOpenProject:async we=>{Ne(null);const Oe=typeof globalThis<"u"&&(globalThis.vitest||globalThis.__APP_VERSION__==="0.0.0");if(!Oe&&!("showDirectoryPicker"in window)){Ne("This app requires the File System Access API, which is not available in this browser environment. Please use a compatible browser like Chrome or Edge.");return}if(Oe){be(we);return}try{if(!await Vs(we))try{const St=await window.showDirectoryPicker();await oa(we,St),be(we);return}catch(St){console.warn("Folder re-selection cancelled or failed:",St),le(we),W(!0);return}be(we)}catch(Ue){console.warn("Error checking stored handle on project open:",Ue),le(we),W(!0)}},recentProjects:S,canClose:!!se,errorMessage:de}),o.jsx(sd,{isOpen:P,onClose:()=>{W(!1),le(null)},onComplete:we=>Rr(we,b),recentProjects:S,onSelectRecent:we=>{Ne(null),le(null),W(!1),be(we)}}),o.jsx($h,{isOpen:ve,title:"Loading Project",message:me,progress:ne,showProgressBar:!0})]})}function vm(){return o.jsx(ym,{})}const pd=document.getElementById("root");if(!pd)throw new Error('Root element not found. Make sure index.html contains a div with id="root"');ch.createRoot(pd).render(o.jsx($s.StrictMode,{children:o.jsx(vm,{})}));export{th as g};
